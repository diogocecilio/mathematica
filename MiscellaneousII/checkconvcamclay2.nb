(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     86292,       2254]
NotebookOptionsPosition[     84210,       2186]
NotebookOutlinePosition[     84565,       2202]
CellTagsIndexPosition[     84522,       2199]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Young", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Poisson", "=", "0.25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda", "=", 
   FractionBox[
    RowBox[{"Poisson", "*", "Young"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "Poisson"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "Poisson"}]}], ")"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", 
   FractionBox["Young", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"1", "+", "Poisson"}], ")"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{
    RowBox[{"(", "Young", ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", "Poisson"}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kk", "=", 
   RowBox[{
    RowBox[{"(", "Young", ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"3", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "Poisson"}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sigma", "[", "Eelastico_", "]"}], ":=", 
    RowBox[{
     RowBox[{"lambda", " ", 
      RowBox[{"Tr", "[", "Eelastico", "]"}], 
      RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "+", 
     RowBox[{"2", " ", "mu", " ", "Eelastico"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I1", "[", "sigma_", "]"}], ":=", 
    RowBox[{"Tr", "[", "sigma", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I2", "[", "sigma_", "]"}], ":=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Tr", "[", "sigma", "]"}], "2"], "-", 
       RowBox[{"Tr", "[", 
        SuperscriptBox["sigma", "2"], "]"}]}], ")"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", "sigma_", "]"}], ":=", 
   RowBox[{"sigma", "-", 
    RowBox[{
     FractionBox["1", "3"], 
     RowBox[{"(", 
      RowBox[{"Tr", "[", "sigma", "]"}], " ", ")"}], 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2", "[", "sigma_", "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", "2"}], 
   RowBox[{"(", 
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"s", "[", "sigma", "]"}], ".", 
      RowBox[{"s", "[", "sigma", "]"}]}], "]"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"j2", "[", "sigma_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"(", 
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{"s", "[", "sigma", "]"}], ".", 
       RowBox[{"s", "[", "sigma", "]"}]}], "]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J3", "[", "sigma_", "]"}], ":=", 
   RowBox[{"Det", "[", "sigma", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DOT", "[", 
    RowBox[{"tensor_", ",", "tensor2_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "length", ",", "result", ",", "i", ",", "j", ",", "nrows", ",", 
       "ncols"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nrows", "=", 
       RowBox[{"Length", "[", "tensor", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ncols", "=", 
       RowBox[{"Length", "[", "tensor2", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"result", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "nrows"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", " ", "ncols"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"result", "+=", 
             RowBox[{
              RowBox[{"tensor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
              RowBox[{"tensor2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sig", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xx", ",", "xy", ",", "xz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xy", ",", "yy", ",", "yz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xz", ",", "yz", ",", "zz"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj2", "=", 
   RowBox[{"j2", "[", "sig", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj3", "=", 
   RowBox[{"Det", "[", "sig", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i1", "=", 
   RowBox[{"Tr", "[", "sig", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dj2", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", " ", 
        RowBox[{"jj2", ",", 
         RowBox[{"sig", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"dj3", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", " ", 
        RowBox[{"jj3", ",", 
         RowBox[{"sig", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"di1", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", " ", 
        RowBox[{"i1", ",", 
         RowBox[{"sig", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DJ1", "[", "sigma_", "]"}], ":=", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DJ2", "[", "sigma_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"sigma", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", 
          RowBox[{"sigma", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"sigma", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
       RowBox[{"2", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}]},
      {
       RowBox[{"2", "  ", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sigma", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
          RowBox[{"2", 
           RowBox[{"sigma", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "-", 
          RowBox[{"sigma", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}]},
      {
       RowBox[{"2", " ", "2", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], 
       RowBox[{
        FractionBox["1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"sigma", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", 
          RowBox[{"sigma", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"sigma", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DJ3", "[", "sigma_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"sigma", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "3"}], "]"}], "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"sigma", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"sigma", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
         RowBox[{"sigma", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5732213473693123`*^9, 3.573221429585952*^9}, {
   3.573222742873526*^9, 3.573222777348228*^9}, {3.573222818628551*^9, 
   3.573222951018405*^9}, {3.573222985716221*^9, 3.573222998606477*^9}, {
   3.573224005036459*^9, 3.5732240673076563`*^9}, {3.57322419071774*^9, 
   3.573224221781375*^9}, 3.573225179119582*^9, 3.5732254554383173`*^9, {
   3.573225488454116*^9, 3.57322553325471*^9}, {3.57322611796175*^9, 
   3.573226202513146*^9}, {3.57322662002284*^9, 3.5732268165009403`*^9}, {
   3.573226853684125*^9, 3.5732269257452707`*^9}, 3.573227453040831*^9, {
   3.573227485513571*^9, 3.573227527337986*^9}, {3.573227577964367*^9, 
   3.57322759216232*^9}, 3.573227652906287*^9, {3.573245563882311*^9, 
   3.573245568670858*^9}, {3.573245634611949*^9, 3.573245756120721*^9}, {
   3.5732865719918003`*^9, 3.5732866558835983`*^9}, 3.573286750629018*^9, {
   3.57329474274047*^9, 3.5732947438125315`*^9}, {3.573295385996262*^9, 
   3.573295411870742*^9}, 3.573295873613152*^9, {3.573404995406766*^9, 
   3.5734050148669233`*^9}, {3.57347980462569*^9, 3.573479953231927*^9}, {
   3.5734800126540937`*^9, 3.573480016634159*^9}, {3.573482847960754*^9, 
   3.573482859220624*^9}, {3.573482977566634*^9, 3.573483430960243*^9}, {
   3.573483465074047*^9, 3.5734834798167257`*^9}, {3.573483518962098*^9, 
   3.57348364569689*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "xx"}], "-", "yy", "-", "zz"}], ")"}]}], ",", 
     RowBox[{"2", " ", "xy"}], ",", 
     RowBox[{"2", " ", "xz"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", "xy"}], ",", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "xx"}], "+", 
        RowBox[{"2", " ", "yy"}], "-", "zz"}], ")"}]}], ",", 
     RowBox[{"2", " ", "yz"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", "xz"}], ",", 
     RowBox[{"2", " ", "yz"}], ",", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "xx"}], "-", "yy", "+", 
        RowBox[{"2", " ", "zz"}]}], ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5732213293981752`*^9, {3.5732214171081963`*^9, 3.5732214301544313`*^9}, 
   3.573222878393804*^9, 3.573223000678968*^9, 3.5732240118722677`*^9, 
   3.573224090659684*^9, {3.5732241959783688`*^9, 3.573224222400251*^9}, 
   3.5732252025937643`*^9, {3.573225509303767*^9, 3.57322553913748*^9}, 
   3.5732262165768337`*^9, 3.573226730198824*^9, 3.573226856424837*^9, {
   3.573226895897256*^9, 3.573226926243555*^9}, 3.5732274555467987`*^9, {
   3.573227612473345*^9, 3.573227619014839*^9}, 3.573227653352767*^9, 
   3.573227802144355*^9, 3.5732282495652647`*^9, 3.5732454606061907`*^9, 
   3.573245569317088*^9, 3.573245759843535*^9, 3.5732866653961425`*^9, 
   3.5732867530421553`*^9, 3.5732888492810535`*^9, 3.573289221062318*^9, 
   3.573293130874276*^9, 3.5732947455746317`*^9, 3.5732947831877832`*^9, 
   3.573295415789966*^9, 3.573295480427663*^9, 3.5732958790684643`*^9, 
   3.57329636538628*^9, 3.573306685591868*^9, 3.573405017717992*^9, 
   3.5734797915039186`*^9, {3.5734799350674667`*^9, 3.5734799539416428`*^9}, 
   3.573480017096574*^9, 3.573482859917389*^9, 3.573482985475243*^9, 
   3.5734830758473043`*^9, 3.5734832721472282`*^9, 3.573483649605138*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["yz", "2"]}], "+", 
      RowBox[{"yy", " ", "zz"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "xz", " ", "yz"}], "-", 
      RowBox[{"2", " ", "xy", " ", "zz"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "xz", " ", "yy"}], "+", 
      RowBox[{"2", " ", "xy", " ", "yz"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", "xz", " ", "yz"}], "-", 
      RowBox[{"2", " ", "xy", " ", "zz"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["xz", "2"]}], "+", 
      RowBox[{"xx", " ", "zz"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "xy", " ", "xz"}], "-", 
      RowBox[{"2", " ", "xx", " ", "yz"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "xz", " ", "yy"}], "+", 
      RowBox[{"2", " ", "xy", " ", "yz"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "xy", " ", "xz"}], "-", 
      RowBox[{"2", " ", "xx", " ", "yz"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["xy", "2"]}], "+", 
      RowBox[{"xx", " ", "yy"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5732213293981752`*^9, {3.5732214171081963`*^9, 3.5732214301544313`*^9}, 
   3.573222878393804*^9, 3.573223000678968*^9, 3.5732240118722677`*^9, 
   3.573224090659684*^9, {3.5732241959783688`*^9, 3.573224222400251*^9}, 
   3.5732252025937643`*^9, {3.573225509303767*^9, 3.57322553913748*^9}, 
   3.5732262165768337`*^9, 3.573226730198824*^9, 3.573226856424837*^9, {
   3.573226895897256*^9, 3.573226926243555*^9}, 3.5732274555467987`*^9, {
   3.573227612473345*^9, 3.573227619014839*^9}, 3.573227653352767*^9, 
   3.573227802144355*^9, 3.5732282495652647`*^9, 3.5732454606061907`*^9, 
   3.573245569317088*^9, 3.573245759843535*^9, 3.5732866653961425`*^9, 
   3.5732867530421553`*^9, 3.5732888492810535`*^9, 3.573289221062318*^9, 
   3.573293130874276*^9, 3.5732947455746317`*^9, 3.5732947831877832`*^9, 
   3.573295415789966*^9, 3.573295480427663*^9, 3.5732958790684643`*^9, 
   3.57329636538628*^9, 3.573306685591868*^9, 3.573405017717992*^9, 
   3.5734797915039186`*^9, {3.5734799350674667`*^9, 3.5734799539416428`*^9}, 
   3.573480017096574*^9, 3.573482859917389*^9, 3.573482985475243*^9, 
   3.5734830758473043`*^9, 3.5734832721472282`*^9, 3.5734836496079073`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5732213293981752`*^9, {3.5732214171081963`*^9, 3.5732214301544313`*^9}, 
   3.573222878393804*^9, 3.573223000678968*^9, 3.5732240118722677`*^9, 
   3.573224090659684*^9, {3.5732241959783688`*^9, 3.573224222400251*^9}, 
   3.5732252025937643`*^9, {3.573225509303767*^9, 3.57322553913748*^9}, 
   3.5732262165768337`*^9, 3.573226730198824*^9, 3.573226856424837*^9, {
   3.573226895897256*^9, 3.573226926243555*^9}, 3.5732274555467987`*^9, {
   3.573227612473345*^9, 3.573227619014839*^9}, 3.573227653352767*^9, 
   3.573227802144355*^9, 3.5732282495652647`*^9, 3.5732454606061907`*^9, 
   3.573245569317088*^9, 3.573245759843535*^9, 3.5732866653961425`*^9, 
   3.5732867530421553`*^9, 3.5732888492810535`*^9, 3.573289221062318*^9, 
   3.573293130874276*^9, 3.5732947455746317`*^9, 3.5732947831877832`*^9, 
   3.573295415789966*^9, 3.573295480427663*^9, 3.5732958790684643`*^9, 
   3.57329636538628*^9, 3.573306685591868*^9, 3.573405017717992*^9, 
   3.5734797915039186`*^9, {3.5734799350674667`*^9, 3.5734799539416428`*^9}, 
   3.573480017096574*^9, 3.573482859917389*^9, 3.573482985475243*^9, 
   3.5734830758473043`*^9, 3.5734832721472282`*^9, 3.57348364960951*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "[", "sig", "]"}]], "Input",
 CellChangeTimes->{{3.5734828624441223`*^9, 3.5734828649357853`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xx", "+", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "xx"}], "-", "yy", "-", "zz"}], ")"}]}]}], ",", "xy", 
     ",", "xz"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xy", ",", 
     RowBox[{"yy", "+", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "xx"}], "-", "yy", "-", "zz"}], ")"}]}]}], ",", "yz"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xz", ",", "yz", ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "xx"}], "-", "yy", "-", "zz"}], ")"}]}], "+", "zz"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5734828653389874`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PLFUN", "[", "epbar_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "df"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"epbar", "^", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"df", "=", 
       RowBox[{"2", " ", "epbar"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"f", ",", "df"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PLFUN", "[", "0.0001", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"t1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "3"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.573405019607471*^9, 3.573405041663377*^9}, {
  3.5734051341271467`*^9, 3.573405177588909*^9}, {3.573479966217856*^9, 
  3.573480026614958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkconv2", "[", "statevars_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "incval", ",", "numrows", ",", "range", ",", "i", ",", 
       "estimateresidual", ",", "res", ",", "diffnorm", ",", "k", ",", 
       "actualstate", ",", "tan", ",", "referenceresidual", ",", "pts", ",", 
       "j", ",", "incvalres", ",", "resstate"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diffnorm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "10", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"referenceresidual", "=", 
       RowBox[{
        RowBox[{"jaceres", "[", "statevars", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tan", "=", 
       RowBox[{
        RowBox[{"jaceres", "[", "statevars", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numrows", "=", 
       RowBox[{"Length", "[", "tan", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numrows", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"incval", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numrows", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"range", "=", "statevars"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", "numrows"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"incval", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
          RowBox[{
           RowBox[{"range", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", 
           RowBox[{"RandomReal", "[", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"estimateresidual", "=", 
       RowBox[{"tan", ".", "incval"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "10"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actualstate", "=", "statevars"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "numrows"}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"actualstate", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "+=", 
             RowBox[{
              RowBox[{"incval", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"i", "/", "10"}], ")"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"jaceres", "[", "actualstate", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", "-=", "referenceresidual"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"res", "-", 
           RowBox[{"estimateresidual", 
            RowBox[{"(", 
             RowBox[{"i", "/", "10"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"diffnorm", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Norm", "[", "res", "]"}]}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "2"}], ",", 
        RowBox[{"i", "<", "10"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sol", "=", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", " ", 
               RowBox[{"diffnorm", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], "-", " ", 
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", 
               RowBox[{"diffnorm", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], " ", "]"}]}], " ", 
            ")"}], "/", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", "i"}], "]"}], "-", 
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", 
               RowBox[{"i", "-", "1"}]}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "diffnorm", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.573293482145368*^9, 3.5732935479301305`*^9}, {
  3.573293605817442*^9, 3.5732936060894575`*^9}, {3.5732936532361536`*^9, 
  3.573293692055374*^9}, {3.5732941891278048`*^9, 3.573294211439081*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"jaceres", "[", "statevars_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "f", ",", "JAC"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"x", "^", "3"}]}], "-", 
          RowBox[{"3.", " ", "y"}]}], ",", 
         RowBox[{"3.", "x", " ", 
          RowBox[{"y", "/", "2"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"JAC", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}]}], "}"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"statevars", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"statevars", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"f", ",", "JAC"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"state", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"jaceres", "[", "state", "]"}], "\[IndentingNewLine]", 
 RowBox[{"checkconv", "[", "state", "]"}]}], "Input",
 CellChangeTimes->{{3.573294417985895*^9, 3.5732944302695975`*^9}, {
   3.5732947593964224`*^9, 3.57329475970144*^9}, 3.573485153656239*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.5732937122205276`*^9, 3.573293717600835*^9}, 
   3.5732942194235377`*^9, {3.5732944311826496`*^9, 3.5732944491206756`*^9}, 
   3.573294586977561*^9, {3.5732947542581286`*^9, 3.5732947854579134`*^9}, 
   3.573295420522237*^9, 3.573295484665906*^9, 3.573295882939686*^9, 
   3.573306688867136*^9, 3.573485154886456*^9, 3.573486757866714*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.`"}], ",", "3.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6.`", ",", 
       RowBox[{"-", "3.`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.`", ",", "1.5`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5732937122205276`*^9, 3.573293717600835*^9}, 
   3.5732942194235377`*^9, {3.5732944311826496`*^9, 3.5732944491206756`*^9}, 
   3.573294586977561*^9, {3.5732947542581286`*^9, 3.5732947854579134`*^9}, 
   3.573295420522237*^9, 3.573295484665906*^9, 3.573295882939686*^9, 
   3.573306688867136*^9, 3.573485154886456*^9, 3.5734867578697844`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"referenceresidual = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.`"}], ",", "3.`"}], "}"}]}],
  SequenceForm["referenceresidual = ", {-4., 3.}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.573294760069461*^9, 3.573294785463914*^9}, 
   3.5732954205282373`*^9, 3.573295484671906*^9, 3.573295882944686*^9, 
   3.573306688870631*^9, 3.5734851548897333`*^9, 3.573486757871812*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"tan = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6.`", ",", 
       RowBox[{"-", "3.`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.`", ",", "1.5`"}], "}"}]}], "}"}]}],
  SequenceForm["tan = ", {{6., -3.}, {3., 1.5}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.573294760069461*^9, 3.573294785463914*^9}, 
   3.5732954205282373`*^9, 3.573295484671906*^9, 3.573295882944686*^9, 
   3.573306688870631*^9, 3.5734851548897333`*^9, 3.5734867578736687`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"range = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}],
  SequenceForm["range = ", {1, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.573294760069461*^9, 3.573294785463914*^9}, 
   3.5732954205282373`*^9, 3.573295484671906*^9, 3.573295882944686*^9, 
   3.573306688870631*^9, 3.5734851548897333`*^9, 3.573486757875947*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"range = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "19"], ",", 
     FractionBox["2", "19"]}], "}"}]}],
  SequenceForm["range = ", {
    Rational[1, 19], 
    Rational[2, 19]}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.573294760069461*^9, 3.573294785463914*^9}, 
   3.5732954205282373`*^9, 3.573295484671906*^9, 3.573295882944686*^9, 
   3.573306688870631*^9, 3.5734851548897333`*^9, 3.5734867578777246`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}], ".", 
  RowBox[{"{", 
   RowBox[{"2", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5734872106423073`*^9, 3.573487214108522*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.5732937122205276`*^9, 3.573293717600835*^9}, 
   3.5732942194235377`*^9, {3.5732944311826496`*^9, 3.5732944491206756`*^9}, 
   3.573294586977561*^9, {3.5732947542581286`*^9, 3.5732947854579134`*^9}, 
   3.573295420522237*^9, 3.573295484665906*^9, 3.573295882939686*^9, 
   3.573306688867136*^9, 3.573485154886456*^9, 3.573486757903838*^9, 
   3.573487214483842*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"jaceres", "[", "statevars_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "gamma", ",", "epbar", ",", "epsen1", ",", "even1", ",", "eden1", ",", 
        "S", ",", "qtrial", ",", "H", ",", "phi", ",", "a", ",", "i", ",", 
        "d", ",", "resnor", ",", "phitiu", ",", "ddgamma", ",", "vecres", ",",
         "tol", ",", "sigma", ",", "p", ",", "pt", ",", "b", ",", "M", ",", 
        "\[CapitalDelta]\[Gamma]", ",", "\[Beta]", ",", "qn1", ",", "pn1", 
        ",", "ptrial", ",", "alfan1", ",", "alfan", ",", "epsp", ",", "pbar", 
        ",", "JAC", ",", "sol", ",", "res", ",", "f", ",", 
        "\[CapitalDelta]\[Alpha]", ",", "norm", ",", "epsAtualizadoEpsTrial", 
        ",", "epsatualizado", ",", "epspN", ",", "ND", ",", "NV", ",", "epn1",
         ",", "lasts", ",", "lastp", ",", "lasteps", ",", "epspn1", ",", 
        "etrial", ",", "Strial", ",", "epselastic", ",", "epsplastic", ",", 
        "epstrial", ",", "diff", ",", "epspN2", ",", "diff2", ",", "counter", 
        ",", "epspD", ",", "epspV", ",", "Q", ",", "P"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"etrial", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "3", "}"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"diff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "3", "}"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"epsplastic", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "3", "}"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"epspD", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "3", "}"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"epspV", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"H", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
        RowBox[{"etrial", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
        RowBox[{"etrial", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], "=", 
        RowBox[{"etrial", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"etrial", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.001"}], ",", "0.001", ",", "0.001"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"0.001", ",", 
              RowBox[{"-", "0.002"}], ",", "0.001"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.001", ",", "0.001", ",", 
              RowBox[{"-", "0.0025"}]}], "}"}]}], "}"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"qtrial", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "/", "2"}], ")"}], " ", 
          RowBox[{"j2", "[", "sigma", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "H"}], "}"}], "=", 
        RowBox[{"PLFUN", "[", 
         RowBox[{"statevars", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pt", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", "0.8"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Beta]", "=", "0.9"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ptrial", ">", 
          RowBox[{"pt", "-", "a"}]}], ",", 
         RowBox[{
          RowBox[{"b", "=", "1"}], ";"}], ",", 
         RowBox[{
          RowBox[{"b", "=", "\[Beta]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qn1", "=", "qtrial"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pn1", "=", "ptrial"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pbar", "=", 
        RowBox[{"(", 
         RowBox[{"pn1", "-", "pt", "+", "a"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"phi", "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"1", " "}], 
           SuperscriptBox["b", "2"]], 
          SuperscriptBox["pbar", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox["qn1", "M"], ")"}], "^", "2"}], "-", 
         SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"alfan1", "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"alfan", "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]\[Gamma]", "=", 
        RowBox[{"statevars", "[", 
         RowBox[{"[", "9", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"qn1", "=", 
        RowBox[{
         FractionBox[
          SuperscriptBox["M", "2"], 
          RowBox[{
           SuperscriptBox["M", "2"], "+", 
           RowBox[{"6", " ", "G", " ", "\[CapitalDelta]\[Gamma]"}]}]], 
         "qtrial"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pn1", "=", 
        RowBox[{"ptrial", "+", 
         RowBox[{"Kk", " ", 
          RowBox[{"(", 
           RowBox[{"alfan1", "-", "alfan"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pbar", "=", 
        RowBox[{"(", 
         RowBox[{"pn1", "-", "pt", "+", "a"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "H"}], "}"}], "=", 
        RowBox[{"PLFUN", "[", "alfan1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"JAC", "=", 
        RowBox[{"(", GridBox[{
           {
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"-", "12"}], " ", "G"}], 
              RowBox[{
               SuperscriptBox["M", "2"], "+", 
               RowBox[{"6", " ", "G", " ", "\[CapitalDelta]\[Gamma]"}]}]], 
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox["qn1", "M"], ")"}], "2"]}], 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"2", "pbar", " "}], 
               SuperscriptBox["b", "2"]], 
              RowBox[{"(", 
               RowBox[{"Kk", "+", "H"}], ")"}]}], "-", 
             RowBox[{"2", " ", "a", " ", "H"}]}]},
           {
            FractionBox[
             RowBox[{"2", "pbar", " "}], 
             SuperscriptBox["b", "2"]], 
            RowBox[{"1", "+", 
             RowBox[{
              FractionBox[
               RowBox[{"2", "\[CapitalDelta]\[Gamma]"}], 
               SuperscriptBox["b", "2"]], 
              RowBox[{"(", 
               RowBox[{"Kk", "+", "H"}], ")"}]}]}]}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"1", " "}], 
             SuperscriptBox["b", "2"]], 
            SuperscriptBox["pbar", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             FractionBox["qn1", "M"], ")"}], "^", "2"}], "-", 
           SuperscriptBox["a", "2"]}], ",", 
          RowBox[{"alfan1", "-", "alfan", "+", 
           RowBox[{"\[CapitalDelta]\[Gamma]", 
            FractionBox["2", 
             SuperscriptBox["b", "2"]], "pbar"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"res", ",", "JAC"}], "}"}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.57329453976086*^9, 3.573294547233288*^9}, {
   3.5732946517392645`*^9, 3.5732946759806514`*^9}, {3.5732947170870028`*^9, 
   3.573294717729039*^9}, {3.5732947966715546`*^9, 3.573294942736909*^9}, {
   3.5732951153367815`*^9, 3.57329512528435*^9}, {3.5732951682318068`*^9, 
   3.5732951703769293`*^9}, {3.5732952390018544`*^9, 3.573295272264757*^9}, {
   3.5732954408724008`*^9, 3.5732954673789167`*^9}, {3.573295529044444*^9, 
   3.5732955406611085`*^9}, {3.573297238428215*^9, 3.573297262834611*^9}, {
   3.57329820028823*^9, 3.5732982088957224`*^9}, {3.5732982819449005`*^9, 
   3.573298282755947*^9}, 3.57330674773799*^9}],

Cell[BoxData["Inner"], "Input",
 CellChangeTimes->{{3.573404873959293*^9, 3.573404883147398*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkconv2", "[", "statevars_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "incval2", ",", "incval", ",", "numrows", ",", "range", ",", "i", ",", 
       "estimateresidual", ",", "estimateresidual2", ",", "res", ",", 
       "diffnorm", ",", "k", ",", "actualstate", ",", "tan", ",", "tan2", ",",
        "referenceresidual", ",", "pts", ",", "j", ",", "incvalres", ",", 
       "resstate", ",", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diffnorm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "10", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tan2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "6", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"referenceresidual", "=", 
       RowBox[{
        RowBox[{"jaceres", "[", "statevars", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<referenceresidual = \>\"", ",", "referenceresidual"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tan", "=", 
       RowBox[{
        RowBox[{"jaceres", "[", "statevars", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<tan = \>\"", ",", "tan"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numrows", "=", 
       RowBox[{"Length", "[", "statevars", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"incval", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "statevars", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", "=", "statevars"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<range = \>\"", ",", "range"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"range", "/", "19"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<range = \>\"", ",", "range"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "numrows"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"incval", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
          RowBox[{
           RowBox[{"range", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", 
           RowBox[{"RandomReal", "[", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"incval2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "3", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"incval", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"incval", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", 
       RowBox[{"incval", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"incval", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}], "=", 
       RowBox[{"incval", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", 
       RowBox[{"incval", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"incval2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tan2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"tan", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tan2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"tan", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tan2", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"tan", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tan2", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "=", 
       RowBox[{"tan", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tan2", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "=", 
       RowBox[{"tan", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tan2", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "=", 
       RowBox[{"tan", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Print", "[", 
       RowBox[{"\"\<incval2= \>\"", ",", "incval2"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"estimateresidual", "=", 
       RowBox[{"tan2", ".", "incval"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<estimateresidual= \>\"", ",", "estimateresidual"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"estimateresidual", "=", 
         RowBox[{
          RowBox[{"DOT", "[", 
           RowBox[{"tan", ",", "incval2"}], "]"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<estimateresidual= \>\"", ",", "estimateresidual"}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "10"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actualstate", "=", "statevars"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "numrows"}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"actualstate", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "+=", 
             RowBox[{
              RowBox[{"incval", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"i", "/", "10"}], ")"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"jaceres", "[", "actualstate", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<res = \>\"", ",", "res"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "-=", "referenceresidual"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"res", "-", 
           RowBox[{"estimateresidual", 
            RowBox[{"(", 
             RowBox[{"i", "/", "10"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"diffnorm", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Norm", "[", "res", "]"}]}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "2"}], ",", 
        RowBox[{"i", "<", "10"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sol", "=", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", " ", 
               RowBox[{"diffnorm", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], "-", " ", 
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", 
               RowBox[{"diffnorm", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], " ", "]"}]}], " ", 
            ")"}], "/", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", "i"}], "]"}], "-", 
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", 
               RowBox[{"i", "-", "1"}]}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "diffnorm", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.57340361819317*^9, 3.573403646346047*^9}, {
   3.5734037727261477`*^9, 3.573403778502301*^9}, {3.573403816734968*^9, 
   3.573403835948992*^9}, 3.573403874403627*^9, {3.5734044097765837`*^9, 
   3.573404422392778*^9}, {3.573404510480659*^9, 3.5734045425504217`*^9}, {
   3.573404583654285*^9, 3.57340458460574*^9}, {3.5734046392375793`*^9, 
   3.573404735462376*^9}, {3.573404817642269*^9, 3.573404819333867*^9}, {
   3.5734051918123913`*^9, 3.5734052032195873`*^9}, {3.573405234523553*^9, 
   3.5734052531146593`*^9}, 3.5734053044093227`*^9, {3.573480187372828*^9, 
   3.573480197932116*^9}, {3.5734802568748198`*^9, 3.5734802574665833`*^9}, {
   3.573480306595141*^9, 3.573480331929224*^9}, {3.5734816075019693`*^9, 
   3.5734816089343147`*^9}, {3.573481642188923*^9, 3.5734816448446007`*^9}, {
   3.573481967139839*^9, 3.573482225654941*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"jaceres", "[", "statevars_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "f", ",", "JAC"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"x", "^", "3"}]}], "-", 
            RowBox[{"3.", " ", "y"}]}], ",", 
           RowBox[{"3.", "x", " ", 
            RowBox[{"y", "/", "2"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"JAC", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}], ",", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}], ",", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}]}], "}"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"x", "=", 
         RowBox[{"statevars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{"statevars", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"f", ",", "JAC"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"state", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"jaceres", "[", "state", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.573483938321315*^9, {3.573483987675301*^9, 3.573483987974147*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.573483940045211*^9, 3.573483989378406*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.`"}], ",", "3.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6.`", ",", 
       RowBox[{"-", "3.`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.`", ",", "1.5`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.573483940045211*^9, 3.573483989380434*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"checkconv", "[", "statevars_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "incval2", ",", "incval", ",", "numrows", ",", "range", ",", "i", ",", 
       "estimateresidual", ",", "estimateresidual2", ",", "res", ",", 
       "diffnorm", ",", "k", ",", "actualstate", ",", "tan", ",", "tan2", ",",
        "referenceresidual", ",", "pts", ",", "j", ",", "incvalres", ",", 
       "resstate", ",", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diffnorm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "10", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"referenceresidual", "=", 
       RowBox[{
        RowBox[{"jaceres", "[", "statevars", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<referenceresidual = \>\"", ",", "referenceresidual"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tan", "=", 
       RowBox[{
        RowBox[{"jaceres", "[", "statevars", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<tan = \>\"", ",", "tan"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numrows", "=", 
       RowBox[{"Length", "[", "statevars", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"incval", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "statevars", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"2", 
           RowBox[{"Length", "[", "tan", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "range", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"range", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"statevars", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", "19"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tan2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"2", 
           RowBox[{"Length", "[", "tan", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"range", "/", "19"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<range = \>\"", ",", "range"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "numrows"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"incval", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
          RowBox[{
           RowBox[{"range", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", 
           RowBox[{"RandomReal", "[", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "tan", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "j"}], ",", 
           RowBox[{"i", "\[LessEqual]", " ", 
            RowBox[{"Length", "[", "tan", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"tan2", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "=", 
             RowBox[{"tan", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<tan[[j,i]] = \>\"", ",", 
                RowBox[{"tan", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<i = \>\"", ",", "i"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"k", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"estimateresidual", "=", 
       RowBox[{"tan2", ".", "incval"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<estimateresidual= \>\"", ",", "estimateresidual"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"estimateresidual", "=", 
         RowBox[{
          RowBox[{"DOT", "[", 
           RowBox[{"tan", ",", "incval2"}], "]"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<estimateresidual= \>\"", ",", "estimateresidual"}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<tan2 = \>\"", ",", "tan2"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", "10"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"actualstate", "=", "statevars"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "numrows"}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"actualstate", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "+=", 
             RowBox[{
              RowBox[{"incval", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"i", "/", "10"}], ")"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"jaceres", "[", "actualstate", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", "-=", "referenceresidual"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"res", "-", 
           RowBox[{"estimateresidual", 
            RowBox[{"(", 
             RowBox[{"i", "/", "10"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"diffnorm", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Norm", "[", "res", "]"}]}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "2"}], ",", 
        RowBox[{"i", "<", "10"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sol", "=", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", " ", 
               RowBox[{"diffnorm", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], "-", " ", 
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", 
               RowBox[{"diffnorm", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], " ", "]"}]}], " ", 
            ")"}], "/", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", "i"}], "]"}], "-", 
             RowBox[{"Log", "[", 
              RowBox[{"10.", ",", 
               RowBox[{"i", "-", "1"}]}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "sol", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "diffnorm", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jaceres", "[", "statevars_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "etrial", ",", "res", ",", "JAC", ",", "sigma", ",", "p", ",", "dJ2"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sigma", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "3", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"statevars", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"statevars", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}], "=", 
       RowBox[{"statevars", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"statevars", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}], "=", 
       RowBox[{"statevars", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", 
       RowBox[{"statevars", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"sigma", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Det", "[", "sigma", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"JAC", "=", 
       RowBox[{"DJ3", "[", "sigma", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"j2", "[", "sigma", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"JAC", "=", 
       RowBox[{"DJ2", "[", "sigma", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"res", ",", "JAC"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"etrial", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.001"}], ",", "0.0001", ",", "0.0001"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0001", ",", 
       RowBox[{"-", "0.002"}], ",", "0.0001"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0001", ",", "0.0001", ",", 
       RowBox[{"-", "0.0025"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma", "=", 
   RowBox[{
    RowBox[{"lambda", " ", 
     RowBox[{"Tr", "[", "etrial", "]"}], 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "+", 
    RowBox[{"2", " ", "mu", " ", "etrial"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"statevars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.17"}], ",", 
     RowBox[{"-", "0.7"}], ",", 
     RowBox[{"-", "0.5"}], ",", 
     RowBox[{"-", "0.13"}], ",", 
     RowBox[{"-", "0.3"}], ",", 
     RowBox[{"-", "0.11"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"jaceres", "[", "statevars", "]"}], "\[IndentingNewLine]", 
 RowBox[{"checkconv", "[", "statevars", "]"}]}], "Input",
 CellChangeTimes->{{3.573484007660791*^9, 3.573484095170532*^9}, {
  3.573484180360179*^9, 3.5734842276879597`*^9}, {3.573484276502881*^9, 
  3.5734843061347637`*^9}, {3.573484342070239*^9, 3.57348448309414*^9}, {
  3.573484628114338*^9, 3.573484705962879*^9}, {3.573484862779615*^9, 
  3.573484917694385*^9}, {3.573484959627202*^9, 3.573484964930265*^9}, {
  3.57348500657161*^9, 3.573485055244039*^9}, {3.573485122089136*^9, 
  3.573485123975972*^9}, {3.573485539840255*^9, 3.573485540903668*^9}, {
  3.573485575358214*^9, 3.573485593534848*^9}, {3.5734864291961823`*^9, 
  3.573486444026144*^9}, {3.573486591010112*^9, 3.5734866436479588`*^9}, {
  3.573486699653862*^9, 3.573486739382512*^9}, {3.573486835531988*^9, 
  3.573486857954669*^9}, {3.573486957506605*^9, 3.5734870308170347`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8309333333333333`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.03333333333333334`"}], ",", 
       RowBox[{"-", "1.4`"}], ",", 
       RowBox[{"-", "1.`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.4`"}], ",", "0.006666666666666668`", ",", 
       RowBox[{"-", "0.6`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.`"}], ",", 
       RowBox[{"-", "0.6`"}], ",", "0.02666666666666668`"}], "}"}]}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.573483888919956*^9, 3.5734845637910547`*^9, {3.573484681264763*^9, 
   3.573484706603039*^9}, 3.573484789818536*^9, {3.5734848826916122`*^9, 
   3.573484919049232*^9}, 3.573485073214179*^9, 3.573485125444497*^9, {
   3.573485595250605*^9, 3.573485608980638*^9}, {3.5734864306399317`*^9, 
   3.573486444509102*^9}, 3.573486649156245*^9, {3.5734867082159767`*^9, 
   3.5734867403947363`*^9}, 3.573486858411748*^9, 3.5734870363654633`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"referenceresidual = \"\>", "\[InvisibleSpace]", 
   "0.8309333333333333`"}],
  SequenceForm["referenceresidual = ", 0.8309333333333333],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.573487036369315*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"tan = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.03333333333333334`"}], ",", 
       RowBox[{"-", "1.4`"}], ",", 
       RowBox[{"-", "1.`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.4`"}], ",", "0.006666666666666668`", ",", 
       RowBox[{"-", "0.6`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.`"}], ",", 
       RowBox[{"-", "0.6`"}], ",", "0.02666666666666668`"}], "}"}]}], "}"}]}],
  
  SequenceForm[
  "tan = ", {{-0.03333333333333334, -1.4, -1.}, {-1.4, 
   0.006666666666666668, -0.6}, {-2., -0.6, 0.02666666666666668}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.57348703637123*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"range = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00047091412742382264`"}], ",", 
     RowBox[{"-", "0.001939058171745152`"}], ",", 
     RowBox[{"-", "0.0013850415512465372`"}], ",", 
     RowBox[{"-", "0.0003601108033240997`"}], ",", 
     RowBox[{"-", "0.0008310249307479223`"}], ",", 
     RowBox[{"-", "0.0003047091412742382`"}]}], "}"}]}],
  SequenceForm[
  "range = ", {-0.00047091412742382264`, -0.001939058171745152, \
-0.0013850415512465372`, -0.0003601108033240997, -0.0008310249307479223, \
-0.0003047091412742382}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.573487036373576*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"tan2 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.03333333333333334`"}], ",", 
     RowBox[{"-", "1.4`"}], ",", 
     RowBox[{"-", "1.`"}], ",", "0.006666666666666668`", ",", 
     RowBox[{"-", "0.6`"}], ",", "0.02666666666666668`"}], "}"}]}],
  SequenceForm[
  "tan2 = ", {-0.03333333333333334, -1.4, -1., 0.006666666666666668, -0.6, 
   0.02666666666666668}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.573487036374881*^9}],

Cell[BoxData["1.9999999959028703`"], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.5734870363761*^9}],

Cell[BoxData["1.9999999965601736`"], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.573487036377166*^9}],

Cell[BoxData["2.00000000254202`"], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.5734870363782053`*^9}],

Cell[BoxData["2.0000000011234844`"], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.573487036379274*^9}],

Cell[BoxData["1.9999999998715285`"], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.5734870363803263`*^9}],

Cell[BoxData["1.9999999998201767`"], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.5734870363813257`*^9}],

Cell[BoxData["2.0000000002704916`"], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.5734870363822727`*^9}],

Cell[BoxData["1.9999999996798374`"], "Print",
 CellChangeTimes->{
  3.573483888922152*^9, 3.573484563794405*^9, {3.573484681268581*^9, 
   3.57348470660635*^9}, 3.573484789821751*^9, {3.573484882695505*^9, 
   3.573484919052656*^9}, 3.573485073215989*^9, 3.5734851254474573`*^9, {
   3.5734855952525463`*^9, 3.573485608982212*^9}, {3.573486430641803*^9, 
   3.573486444511051*^9}, 3.573486649159419*^9, {3.573486708218966*^9, 
   3.573486740396277*^9}, 3.573486858415374*^9, 3.573487036383212*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.7516276580343262`*^-8", ",", "1.1006510600879756`*^-7", ",", 
   "2.476464881743948`*^-7", ",", "4.402604237431062`*^-7", ",", 
   "6.879069122710593`*^-7", ",", "9.905859536471235`*^-7", ",", 
   "1.348297547982321`*^-6", ",", "1.7610416953874573`*^-6", ",", 
   "2.2288183956407047`*^-6", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.573483888919956*^9, 3.5734845637910547`*^9, {3.573484681264763*^9, 
   3.573484706603039*^9}, 3.573484789818536*^9, {3.5734848826916122`*^9, 
   3.573484919049232*^9}, 3.573485073214179*^9, 3.573485125444497*^9, {
   3.573485595250605*^9, 3.573485608980638*^9}, {3.5734864306399317`*^9, 
   3.573486444509102*^9}, 3.573486649156245*^9, {3.5734867082159767`*^9, 
   3.5734867403947363`*^9}, 3.573486858411748*^9, 3.573487036384182*^9}]
}, Open  ]]
},
WindowSize->{1680, 916},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 6, \
2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 15363, 452, 766, "Input"],
Cell[15945, 476, 2105, 48, 47, "Output"],
Cell[18053, 526, 2444, 57, 33, "Output"],
Cell[20500, 585, 1450, 25, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21987, 615, 126, 2, 27, "Input"],
Cell[22116, 619, 851, 30, 47, "Output"]
}, Open  ]],
Cell[22982, 652, 691, 19, 133, "Input"],
Cell[23676, 673, 918, 27, 73, "Input"],
Cell[24597, 702, 5273, 127, 433, "Input"],
Cell[CellGroupData[{
Cell[29895, 833, 2213, 59, 178, "Input"],
Cell[32111, 894, 435, 7, 27, "Output"],
Cell[32549, 903, 698, 17, 27, "Output"],
Cell[CellGroupData[{
Cell[33272, 924, 468, 10, 20, "Print"],
Cell[33743, 936, 568, 14, 20, "Print"],
Cell[34314, 952, 416, 9, 20, "Print"],
Cell[34733, 963, 506, 13, 40, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35288, 982, 211, 6, 27, "Input"],
Cell[35502, 990, 416, 6, 27, "Output"]
}, Open  ]],
Cell[35933, 999, 10440, 256, 777, "Input"],
Cell[46376, 1257, 97, 1, 27, "Input"],
Cell[46476, 1260, 11163, 279, 823, "Input"],
Cell[CellGroupData[{
Cell[57664, 1543, 2275, 62, 178, "Input"],
Cell[59942, 1607, 137, 3, 27, "Output"],
Cell[60082, 1612, 398, 13, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60517, 1630, 13870, 345, 1153, "Input"],
Cell[74390, 1977, 1038, 25, 27, "Output"],
Cell[CellGroupData[{
Cell[75453, 2006, 667, 12, 20, "Print"],
Cell[76123, 2020, 1196, 29, 20, "Print"],
Cell[77322, 2051, 1097, 22, 20, "Print"],
Cell[78422, 2075, 929, 19, 20, "Print"],
Cell[79354, 2096, 495, 7, 20, "Print"],
Cell[79852, 2105, 497, 7, 20, "Print"],
Cell[80352, 2114, 497, 7, 20, "Print"],
Cell[80852, 2123, 497, 7, 20, "Print"],
Cell[81352, 2132, 499, 7, 20, "Print"],
Cell[81854, 2141, 499, 7, 20, "Print"],
Cell[82356, 2150, 499, 7, 20, "Print"],
Cell[82858, 2159, 497, 7, 20, "Print"]
}, Open  ]],
Cell[83370, 2169, 824, 14, 33, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
