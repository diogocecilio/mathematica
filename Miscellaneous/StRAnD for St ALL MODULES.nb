(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    411746,      10243]
NotebookOptionsPosition[    405423,      10031]
NotebookOutlinePosition[    405774,      10046]
CellTagsIndexPosition[    405731,      10043]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["0. GENERAL PROBLEM MODULES", "Title"],

Cell[CellGroupData[{

Cell["MATHEMATICA MODULES", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "\"\<PlotLegends`\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "\"\<ErrorBarPlots`\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "\"\<VectorAnalysis`\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<Histograms`\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.39781462271875*^9, 3.39781462325*^9}, {
  3.39781468021875*^9, 3.397814690578125*^9}, {3.39781552921875*^9, 
  3.397815529546875*^9}, {3.39938816415625*^9, 3.399388201390625*^9}, {
  3.39938825071875*^9, 3.399388255265625*^9}},
 CellLabel->"In[1]:="],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "obspkg"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(\\\"PlotLegends`\\\"\\)\[NoBreak] is now \
obsolete. The legacy version being loaded may conflict with current \
Mathematica functionality. See the Compatibility Guide for updating \
information.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.557647963407507*^9, 3.557759292937004*^9, 
  3.557820774721161*^9, 3.5583644580339203`*^9, 3.558890082538005*^9, 
  3.5602446245218153`*^9, 3.6235762163899765`*^9, 3.623576621621682*^9, 
  3.6235772704797077`*^9, 3.623589568665394*^9, 3.6235900939602437`*^9, 
  3.623594580208005*^9, 3.6422624570349703`*^9, 3.642265772747309*^9, 
  3.6433808053153825`*^9, 3.643384086123435*^9, 3.643391940361804*^9},
 CellLabel->"During evaluation of In[1]:="],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "obspkg"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(\\\"VectorAnalysis`\\\"\\)\[NoBreak] is now \
obsolete. The legacy version being loaded may conflict with current \
Mathematica functionality. See the Compatibility Guide for updating \
information.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.557647963407507*^9, 3.557759292937004*^9, 
  3.557820774721161*^9, 3.5583644580339203`*^9, 3.558890082538005*^9, 
  3.5602446245218153`*^9, 3.6235762163899765`*^9, 3.623576621621682*^9, 
  3.6235772704797077`*^9, 3.623589568665394*^9, 3.6235900939602437`*^9, 
  3.623594580208005*^9, 3.6422624570349703`*^9, 3.642265772747309*^9, 
  3.6433808053153825`*^9, 3.643384086123435*^9, 3.6433919405898266`*^9},
 CellLabel->"During evaluation of In[1]:="],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "obspkg"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(\\\"Histograms`\\\"\\)\[NoBreak] is now obsolete. \
The legacy version being loaded may conflict with current Mathematica \
functionality. See the Compatibility Guide for updating information.\"\>"}]], \
"Message", "MSG",
 CellChangeTimes->{3.557647963407507*^9, 3.557759292937004*^9, 
  3.557820774721161*^9, 3.5583644580339203`*^9, 3.558890082538005*^9, 
  3.5602446245218153`*^9, 3.6235762163899765`*^9, 3.623576621621682*^9, 
  3.6235772704797077`*^9, 3.623589568665394*^9, 3.6235900939602437`*^9, 
  3.623594580208005*^9, 3.6422624570349703`*^9, 3.642265772747309*^9, 
  3.6433808053153825`*^9, 3.643384086123435*^9, 3.6433919407988477`*^9},
 CellLabel->"During evaluation of In[1]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "\"\<PlotLegends`\>\""}]], "Input",
 CellChangeTimes->{{3.403964136703125*^9, 3.403964142734375*^9}, 
   3.40397567565625*^9},
 CellLabel->"In[5]:="],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "obspkg"}], "MessageName"], ":", 
  " ", "\<\"\[NoBreak]\\!\\(\\\"PlotLegends`\\\"\\)\[NoBreak] is now \
obsolete. The legacy version being loaded may conflict with current \
Mathematica functionality. See the Compatibility Guide for updating \
information.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.623576217360016*^9, 3.6235766223316965`*^9, 
  3.6235772711797285`*^9, 3.6235895693654146`*^9, 3.6235900946702647`*^9, 
  3.623594580976082*^9, 3.6422624577549987`*^9, 3.6422657734873314`*^9, 
  3.6433808064244933`*^9, 3.643384086543477*^9, 3.643391941146882*^9},
 CellLabel->"During evaluation of In[5]:="]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"ReturnPeriod", ",", "Log10ReturnPeriod", ",", "rv", ",", "x"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReturnPeriod", "[", 
      RowBox[{"rv_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"StCDF", "[", 
         RowBox[{"rv", ",", "x"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Log10ReturnPeriod", "[", 
      RowBox[{"rv_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"StCDF", "[", 
           RowBox[{"rv", ",", "x"}], "]"}]}], ")"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.430817145069375*^9, 3.43081714867875*^9}},
 CellLabel->"In[6]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["RANDOM VARIABLE OBJECT", "Section",
 CellChangeTimes->{3.397816087015625*^9, 3.39783054215625*^9}],

Cell[CellGroupData[{

Cell["\<\
Conte\[UAcute]do de um objeto vari\[AAcute]vel aleat\[OAcute]ria e palavras \
chave a utilizar com as fun\[CCedilla]\[OTilde]es RVGET(.) e RVPUT(.) s\
\[ATilde]o:\
\>", "Subsection",
 CellChangeTimes->{3.397816087015625*^9, 3.39783054215625*^9}],

Cell[CellGroupData[{

Cell["\<\
\"NAME\" - Nome da vari\[AAcute]vel aleat\[OAcute]ria (qq combina\[CCedilla]\
\[ATilde]o de caracteres);
\"TYPE\" - C\[OAcute]digo do tipo de distribui\[CCedilla]\[ATilde]o conforme \
op\[CCedilla]\[OTilde]es abaixo;
\"MEAN\" - M\[EAcute]dia (*OBS.);
\"SDEV\" - Desvio-padr\[ATilde]o (*OBS.);
\"PDF\" -   aproxima\[CCedilla]\[ATilde]o num\[EAcute]rica de uma fun\
\[CCedilla]\[ATilde]o de densidades (N\[CapitalATilde]O \[CapitalEAcute] \
NECESS\[CapitalAAcute]RIO PARA O VOSSO USO);
\"CDF\" -   aproxima\[CCedilla]\[ATilde]o num\[EAcute]rica de uma fun\
\[CCedilla]\[ATilde]o de distribui\[CCedilla]\[ATilde]o cumulativa (N\
\[CapitalATilde]O \[CapitalEAcute] NECESS\[CapitalAAcute]RIO PARA O VOSSO USO);
\"PAR1\" - primeiro par\[AHat]metro da fun\[CCedilla]\[ATilde]o de distribui\
\[CCedilla]\[ATilde]o de probabilidades (*OBS.);
\"PAR2\" - segundo par\[AHat]metro da fun\[CCedilla]\[ATilde]o de distribui\
\[CCedilla]\[ATilde]o de probabilidades (*OBS.);
\"VMIN\" - valor m\[IAcute]nimo utiliz\[AAcute]vel da vari\[AAcute]vel aleat\
\[OAcute]ria (determinado pelas fun\[CCedilla]\[OTilde]es CALCMOM(.) e \
CALCPAR(.) )
\"PMIN\" - valor m\[IAcute]nimo para plotagem da vari\[AAcute]vel aleat\
\[OAcute]ria (determinado pelas fun\[CCedilla]\[OTilde]es CALCMOM(.) e \
CALCPAR(.) )
\"PMAX\" - valor m\[AAcute]ximo para plotagem da vari\[AAcute]vel aleat\
\[OAcute]ria (determinado pelas fun\[CCedilla]\[OTilde]es CALCMOM(.) e \
CALCPAR(.) )
\"VMAX\" - valor m\[AAcute]ximo utiliz\[AAcute]vel da vari\[AAcute]vel aleat\
\[OAcute]ria (determinado pelas fun\[CCedilla]\[OTilde]es CALCMOM(.) e \
CALCPAR(.) )
\"MF\" - nem me lembro - (N\[CapitalATilde]O UTILIZAR)

*OBS.: Deve-se informar a m\[EAcute]dia e o desvio padr\[ATilde]o OU os dois \
par\[AHat]metros da distribui\[CCedilla]\[ATilde]o. Depois, utiliza-se a fun\
\[CCedilla]\[ATilde]o apropriada ( CALCMOM(.) ou CALCPAR(.) ) para determinar \
as grandezas n\[ATilde]o informadas.  Para a fun\[CCedilla]\[ATilde]o de \
Weibull (3 par\[AHat]metros), deve-se informar ainda o terceiro \
par\[AHat]metro, que corresponde ao m\[IAcute]nimo (VMIN) ou ao \
m\[AAcute]ximo (VMAX) da distribui\[CCedilla]\[ATilde]o (seja de \
m\[IAcute]nimos ou de m\[AAcute]ximos).\
\>", "Subsubsection",
 CellChangeTimes->{
  3.397816087015625*^9, 3.39783054215625*^9, {3.464015338182475*^9, 
   3.4640153834757485`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "RVCREATE", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RVCREATE", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Return", "[", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "13", "}"}]}], "]"}], "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "RVPUT", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RVPUT", "[", 
    RowBox[{"rv_", ",", "input_", ",", "put_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nrvi", ",", "nput", ",", "rvt"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"nrvi", ",", "nput", ",", "rvt"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nrvi", " ", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "rv", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nput", " ", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "put", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nput", "\[NotEqual]", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "input", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Conflicting vector sizes, RVPUT!\>\"", "]"}], 
          ";", " ", 
          RowBox[{"Return", "[", "0", "]"}]}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nrvi", "\[NotEqual]", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "input", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Conflicting vector sizes, RVPUT!\>\"", "]"}], 
          ";", " ", 
          RowBox[{"Return", "[", "0", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rvt", " ", "=", " ", 
        RowBox[{"Transpose", "[", "rv", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", " ", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", " ", 
             "\"\<NAME\>\""}], ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", " ", "1", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<TYPE\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "  ", "2", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<MEAN\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "  ", "3", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<SDEV\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "  ", "4", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "  ", 
             "\"\<PDF\>\""}], ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "  ", "5", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "  ", 
             "\"\<CDF\>\""}], ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "  ", "6", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<PAR1\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "  ", "7", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<PAR2\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "  ", "8", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<VMIN\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "  ", "9", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<PMIN\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "10", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<PMAX\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "11", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", "\t", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<VMAX\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "12", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"put", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "     ", 
             "\"\<MF\>\""}], ",", 
            RowBox[{
             RowBox[{"rvt", "[", 
              RowBox[{"[", "13", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nput"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nrvi", ">", "1"}], ",", 
         RowBox[{"rvt", " ", "=", " ", 
          RowBox[{"Transpose", "[", "rvt", "]"}]}], ",", 
         RowBox[{"rvt", " ", "=", " ", 
          RowBox[{"Flatten", "[", "rvt", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "rvt", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.39781608703125*^9, 3.39783054215625*^9, {3.400600189078125*^9, 
   3.40060019115625*^9}, {3.400600225*^9, 3.400600242125*^9}, {
   3.400836031453125*^9, 3.400836049515625*^9}},
 CellLabel->"In[9]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RVGET", "[", 
     RowBox[{"rv_", ",", "get_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nrvi", ",", "nget", ",", "rvt", ",", "out"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"nrvi", ",", "nget", ",", "rvt", ",", "out"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nrvi", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "rv", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nget", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "get", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"rvt", " ", "=", " ", 
         RowBox[{"Transpose", "[", "rv", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"out", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nget", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<NAME\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "1", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<TYPE\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "2", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<MEAN\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "3", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<SDEV\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "4", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "  ", 
              "\"\<PDF\>\""}], ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "5", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "  ", 
              "\"\<CDF\>\""}], ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "6", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<PAR1\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "7", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<PAR2\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "8", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<VMIN\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "  ", "9", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<PMIN\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "10", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<PMAX\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "11", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<VMAX\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", "12", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "    ", 
              "\"\<MF\>\""}], ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"rvt", "[", 
               RowBox[{"[", " ", "13", "]"}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nget"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nget", "\[Equal]", "1"}], ",", 
          RowBox[{"out", " ", "=", " ", 
           RowBox[{"Flatten", "[", "out", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "out", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.39781608703125*^9, 3.397830542171875*^9, {3.40060025546875*^9, 
   3.400600271078125*^9}, {3.400836056734375*^9, 3.400836067984375*^9}},
 CellLabel->"In[13]:="]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["LIMIT STATE FUNCTION MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"vy", ",", "fy", ",", "vx", ",", "fx", ",", "yleg"}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetLimitStateVectors", "[", "NRV_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vx", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<X``\>\"", ",", "i"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fx", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<X``_\>\"", ",", "i"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"vy", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<Y``\>\"", ",", "i"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fy", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<Y``_\>\"", ",", "i"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"yleg", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<Y``\>\"", ",", "i"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xleg", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<X``\>\"", ",", "i"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dpyleg", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[\(Y``\), \(*\)]\)\>\"", ",", "i"}], 
              "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dpxleg", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[\(X``\), \(*\)]\)\>\"", ",", "i"}], 
              "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildRVParameterVectors", "[", "RV_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NAME", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<NAME\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TYPE", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MEAN", "=", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SDEV", "=", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<SDEV\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PAR1", "=", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<PAR1\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PAR2", "=", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<PAR2\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PMIN", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<PMIN\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PMAX", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<PMAX\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"XMIN", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"XMAX", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"RV", ",", 
          RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4640162313436584`*^9, 3.464016235859024*^9}},
 CellLabel->"In[14]:="]
}, {2}]],

Cell[CellGroupData[{

Cell["MATHS MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "OWNIntegrate", ",", "INTEGRAND", ",", "xmin", ",", "xmax", ",", 
     "ndivi"}], "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OWNIntegrate", "[", 
    RowBox[{"INTEGRAND_", ",", 
     RowBox[{"{", 
      RowBox[{"xmin_", ",", "xmax_"}], "}"}], ",", "ndivi_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dx", ",", "xi", ",", "fi", ",", "int", ",", "ndiv"}], "}"}], 
     ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"dx", ",", "xi", ",", "fi", ",", "int", ",", "ndiv"}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"int", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", "\[Equal]", "1"}], ",", 
            RowBox[{"ndiv", " ", "=", " ", "ndivi"}], ",", 
            RowBox[{"ndiv", " ", "=", " ", 
             RowBox[{"2", " ", "ndivi"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dx", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"xmax", " ", "-", " ", "xmin"}], "]"}], "/", "ndiv"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"xi", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"xmin", "+", 
              RowBox[{"dx", "/", "2"}], "+", 
              RowBox[{"i", " ", "dx"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"ndiv", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"fi", " ", "=", " ", 
           RowBox[{"Table", "[", " ", 
            RowBox[{
             RowBox[{"INTEGRAND", "[", 
              RowBox[{"xi", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "ndiv"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"int", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"fi", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "ndiv"}], "}"}]}], "]"}], "*", 
            "dx"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"100", "*", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"int", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"int", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "/", 
            RowBox[{"int", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ">", "0.1"}], ",", 
         RowBox[{
         "Print", "[", "\"\<ACHTUNG, INTEGRAL ERROR > 0.1%\>\"", "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"int", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.39842179125*^9, 3.39842181125*^9}},
 CellLabel->"In[17]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. RANDOM VARIABLE MODULES", "Title",
 CellChangeTimes->{3.397816087015625*^9, 3.39783054215625*^9}],

Cell[CellGroupData[{

Cell["CONTINUOUS DISTRIBUTION MODULES", "Section",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542171875*^9}],

Cell[CellGroupData[{

Cell["C\[OAcute]digos de distribui\[CCedilla]\[ATilde]o:", "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542171875*^9}],

Cell[CellGroupData[{

Cell["\<\
DETERM \t- Determin\[IAcute]stica, substitui uma variavel aleat\[OAcute]ria \
por seu valor m\[EAcute]dio, deve ser contada como vari\[AAcute]vel aleat\
\[OAcute]ria (N\[CapitalATilde]O FOI TESTADA NO PRESENTE PROGRAMA);
UNIFORM\t - Uniforme
NORMAL\t - Gaussiana
LOGNORMAL\t- Lognormal
EXPO\t\t- exponencial
RAYLEIGH\t- rayleigh
LOGISTIC\t - log\[IAcute]stica (n\[ATilde]o sei se est\[AAcute] funcionando);
GAMMA        \t- Gamma
GUMBEL MIN\t- Gumbel para minimos;
GUMBEL MAX\t- Gumbel para m\[AAcute]ximos;
FRECHET MIN\t-  Etc.
FRECHET MAX
WEIBULL MIN
WEIBULL MAX\
\>", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542171875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CONTDIST", "=", "\"\<OWN\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SDLIMINF", "=", "8.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SDLIMSUP", "=", "8.0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CDFLIM", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "15"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CDFLIMPLOT", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "2.5"}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UUF", " ", "=", " ", 
   SuperscriptBox["10", 
    RowBox[{"-", "99"}]]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.39781608703125*^9, 3.397830542171875*^9, {3.40060027946875*^9, 
   3.4006003105*^9}, {3.400857853234375*^9, 3.40085785459375*^9}, {
   3.400865572265625*^9, 3.40086557265625*^9}},
 CellLabel->"In[19]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard Gaussian distributions", "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542171875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"x", ",", "fi", ",", "FI", ",", "fi2D"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fi", "[", "x_", "]"}], "=", 
    RowBox[{"N", "[", 
     RowBox[{
      FractionBox["1", 
       SqrtBox[
        RowBox[{"2", "Pi"}]]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["x", "2"], "2"]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fi2D", "[", 
     RowBox[{"x_", ",", "y_", ",", "ro_"}], "]"}], " ", "=", " ", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "\[Pi]", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ro", "2"]}]]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["ro", "2"]}], ")"}]}]]}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "-", 
         RowBox[{"2", " ", "ro", " ", "x", " ", "y"}], " ", "+", 
         SuperscriptBox["y", "2"]}], ")"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fiND", "[", 
     RowBox[{"y_", ",", "Cy_", ",", "n_"}], "]"}], " ", "=", " ", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "Pi"}], ")"}], 
       RowBox[{
        RowBox[{"-", "n"}], "/", "2"}]], 
      SqrtBox[
       RowBox[{"Det", "[", "Cy", "]"}]]], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], 
       RowBox[{"y", ".", 
        RowBox[{"Inverse", "[", "Cy", "]"}], ".", "y"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"FIE", ",", "INVFIE", ",", "x"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FIE", "[", "x_", "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{"x", 
        SqrtBox["2"]}], "2"], "]"}], "2"], "+", "0.5"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"INVFIE", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{"Sqrt", "[", "2", "]"}], "*", 
    RowBox[{"InverseErf", "[", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"2", "x"}], "-", "1"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.39781608703125*^9, 3.397830542171875*^9, {3.39784028696875*^9, 
   3.397840295109375*^9}, {3.400405023671875*^9, 3.400405031328125*^9}, {
   3.400409288796875*^9, 3.40040930103125*^9}},
 CellLabel->"In[25]:="],

Cell[CellGroupData[{

Cell["FUNCAO DE PROBABILIDADE ACUMULADA GAUSSIANA PADRAO ", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542171875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FI", "[", "Z_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ZERO", ",", "ONE", ",", "HALF", ",", "UUF", ",", "P0", ",", "P1", ",", 
       "P2", ",", "P3", ",", "P4", ",", "P5", ",", "P6"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "ZERO", ",", "ONE", ",", "HALF", ",", "UUF", ",", "P0", ",", "P1", 
         ",", "P2", ",", "P3", ",", "P4", ",", "P5", ",", "P6"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ZERO", " ", "=", " ", "0.0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ONE", " ", "=", " ", "1.0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"HALF", " ", "=", " ", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"UUF", " ", "=", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "17"}]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", " ", 
         RowBox[{
         "P0", ",", "P1", ",", "P2", ",", "P3", ",", "P4", ",", "P5", ",", 
          "P6"}], "}"}], " ", "=", " ", 
        RowBox[{"{", "  ", 
         RowBox[{
         "0.2316419000", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t  ", 
          "0.3193815300", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
          RowBox[{"-", "0.3565637820"}], ",", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t\t  ", "1.7814779370", ",", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t\t", 
          RowBox[{"-", "1.8212559780"}], ",", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t\t  ", "1.3302744290", ",", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t\t  ", "0.3989422804"}], "}"}]}], ";", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"AL", "=", 
        RowBox[{"-", 
         RowBox[{"Log", "[", "UUF", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Z2", "=", 
        RowBox[{"Abs", "[", "Z", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Y", "=", 
        FractionBox["ONE", 
         RowBox[{"ONE", "+", 
          RowBox[{"P0", "*", "Z2"}]}]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Y", "=", 
        RowBox[{"Y", "*", 
         RowBox[{"(", 
          RowBox[{"P1", "+", 
           RowBox[{"Y", "*", 
            RowBox[{"(", 
             RowBox[{"P2", "+", 
              RowBox[{"Y", "*", 
               RowBox[{"(", 
                RowBox[{"P3", "+", 
                 RowBox[{"Y", "*", 
                  RowBox[{"(", 
                   RowBox[{"P4", "+", 
                    RowBox[{"Y", "*", "P5"}]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Z2", "=", 
        RowBox[{"Z2", "*", "Z2", "*", "HALF"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Z2", ">", "AL"}], ",", " ", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"P", "=", "0"}], ";"}], "\[IndentingNewLine]", "\t", ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"P", "=", 
           RowBox[{"P6", "*", "Y", "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", "Z2"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Z", ">", "ZERO"}], ",", " ", 
         RowBox[{"P", "=", 
          RowBox[{"ONE", "-", "P"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"P", ",", "ONE"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"P", ",", "ZERO"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", " ", "[", "P", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542171875*^9},
 CellLabel->"In[32]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
 INVERSA DA FUNCAO DE PROBABILIDADE ACUMULADA GAUSSIANA PADRAO \
\>", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542171875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "INVFI", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"INVFI", "[", "P_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ZERO", " ", "=", " ", "0.0"}], ",", " ", 
       RowBox[{"ONE", " ", "=", " ", "1.0"}], ",", " ", 
       RowBox[{"HALF", " ", "=", " ", "0.5"}], ",", " ", 
       RowBox[{"UUF", " ", "=", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "17"}]]}], ",", "Z", ",", "Y", ",", "AL", ",", "PS", 
       ",", "VP", ",", "VQ"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VP", " ", "=", " ", 
        RowBox[{"{", "          ", 
         RowBox[{
          RowBox[{"-", "0.3222324310880"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"-", "1.0000000000000"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"-", "0.3422422088547"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{
           RowBox[{"-", "0.2042312102450"}], "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "1"}]]}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"-", "0.4536422101480"}], "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4"}]]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"VQ", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.9934846260600", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "1"}]]}], ",", "\[IndentingNewLine]", "\t", 
          "0.5885815704950", ",", "\[IndentingNewLine]", "\t", 
          "0.5311034623660", ",", "\[IndentingNewLine]", "\t", 
          "0.1035377528500", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"0.3856070063400", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "2"}]]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Al", " ", "=", " ", 
         RowBox[{"Sqrt", "[", "UUF", "]"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"AL", "=", "UUF"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Z", "=", "ZERO"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PS", "=", "P"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"PS", ">", "HALF"}], "   ", ",", " ", 
         RowBox[{"PS", "=", 
          RowBox[{"ONE", "-", "PS"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"PS", "<", "AL"}], "        ", ",", " ", 
         RowBox[{"PS", "=", "AL"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"PS", "==", "HALF"}], ",", " ", 
         RowBox[{"Return", "[", "ZERO", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Y", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Log", "[", 
          FractionBox["ONE", 
           RowBox[{"PS", "*", "PS"}]], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Z", "=", 
        RowBox[{"Y", "+", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Y", "*", 
                    RowBox[{"VP", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "+", 
                    RowBox[{"VP", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "*", "Y"}], "+", 
                  RowBox[{"VP", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", "Y"}], "+", 
               RowBox[{"VP", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", "Y"}], "+", 
            RowBox[{"VP", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Y", "*", 
                    RowBox[{"VQ", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "+", 
                    RowBox[{"VQ", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "*", "Y"}], "+", 
                  RowBox[{"VQ", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", "Y"}], "+", 
               RowBox[{"VQ", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", "Y"}], "+", 
            RowBox[{"VQ", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"P", "<", "HALF"}], ",", " ", 
         RowBox[{"Z", "=", 
          RowBox[{"-", "Z"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Z", "]"}], ";"}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.39781608703125*^9, 3.397830542171875*^9, {3.406997678390625*^9, 
   3.406997726140625*^9}},
 CellLabel->"In[33]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Probability density functions - fx = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"PDF", "(", "x", ")"}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.3978305421875*^9}],

Cell[CellGroupData[{

Cell["\<\
EVALUATES THE DISTRIBUTION FUNCTION;
  
  INPUT: \t x = value of x where to evaluate the PDF f(x); 
  \t\trv = random variable;               
  OUTPUT: \tvalue fx                          
\
\>", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.3978305421875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"StPDF", ",", "rvi", ",", "x"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StPDF", "[", 
    RowBox[{"rvi_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "UUF", ",", "ty", ",", "p1", ",", "p2", ",", "p3", ",", "p4", ",", 
       "f"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"ty", ",", "p1", ",", "p2", ",", "p3", ",", "p4", ",", "f"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"UUF", " ", "=", 
        SuperscriptBox["10", 
         RowBox[{"-", "99"}]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"UUF", "\[LessEqual]", " ", "Fx", "\[LessEqual]", " ", 
              RowBox[{"1", "-", "UUF"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Return", "[", "0.0", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rvi", "\[Equal]", "fi"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"fi", "[", "x", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ty", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<PAR1\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<PAR2\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p3", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p4", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "\[Equal]", " ", "\"\<NUMER\>\""}], ",", 
         RowBox[{
          RowBox[{"f", "=", 
           RowBox[{
            RowBox[{"RVGET", "[", 
             RowBox[{
              RowBox[{"{", "rvi", "}"}], ",", 
              RowBox[{"{", "   ", "\"\<PDF\>\"", "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
          RowBox[{"Return", "[", 
           RowBox[{"f", "[", "x", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<DETERM\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "\[GreaterEqual]", " ", 
             RowBox[{"1.05", " ", "p1"}]}], ",", "0.0", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"x", "\[LessEqual]", " ", 
               RowBox[{"0.95", " ", "p1"}]}], ",", "0.0", ",", "10"}], 
             "]"}]}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<UNIFORM\>\""}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "\[GreaterEqual]", " ", "p2"}], ",", "0.0", ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", "\[LessEqual]", " ", "p1"}], ",", "0.0", ",", 
               "\[IndentingNewLine]", "\t\t\t", 
               FractionBox["1", 
                RowBox[{"p2", "-", "p1"}]]}], "]"}]}], "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<NORMAL\>\""}], ",", 
         RowBox[{"Return", "[", 
          FractionBox[
           RowBox[{"fi", "[", 
            FractionBox[
             RowBox[{"x", "-", "p1"}], "p2"], "]"}], "p2"], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<LOGNORMAL\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "\[LessEqual]", " ", "0.0"}], ",", "0.0", ",", 
            FractionBox[
             RowBox[{"fi", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"Log", "[", "x", "]"}], "-", "p1"}], "p2"], "]"}], 
             RowBox[{"p2", " ", "x"}]]}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<EXPO\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "\[LessEqual]", " ", "p3"}], ",", "0.0", ",", 
            RowBox[{
             RowBox[{"p1", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "p1"}], " ", 
                RowBox[{"(", 
                 RowBox[{"x", "-", "p3"}], ")"}]}], "]"}]}], "//", "N"}]}], 
           "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<RAYLEIGH\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "\[LessEqual]", " ", "p3"}], ",", "0.0", ",", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"x", "-", "p3"}], 
               SuperscriptBox["p1", "2"]], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"x", "-", "p3"}], "p1"], ")"}], "2"]}], "]"}]}], "//",
              "N"}]}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<LOGISTIC\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Exp", "[", 
             RowBox[{
              FractionBox["Pi", 
               SqrtBox["3"]], 
              FractionBox[
               RowBox[{"(", 
                RowBox[{"x", "-", "p1"}], ")"}], "p2"]}], "]"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 FractionBox["Pi", 
                  SqrtBox["3"]], 
                 FractionBox[
                  RowBox[{"(", 
                   RowBox[{"x", "-", "p1"}], ")"}], "p2"]}], "]"}]}], ")"}], 
             "2"]], "//", "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<GAMMA\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "\[LessEqual]", " ", "p3"}], ",", "0.0", ",", 
            RowBox[{
             FractionBox[
              RowBox[{"p1", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p1", " ", "x"}], ")"}], 
                RowBox[{"p2", "-", "1"}]], 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "p1"}], " ", "x"}], "]"}]}], 
              RowBox[{"Gamma", "[", "p2", "]"}]], "//", "N"}]}], "]"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<GUMBEL MAX\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"p2", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "p2"}], 
              RowBox[{"(", 
               RowBox[{"x", "-", "p1"}], ")"}]}], "]"}], " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "p2"}], 
                RowBox[{"(", 
                 RowBox[{"x", "-", "p1"}], ")"}]}], "]"}]}], "]"}]}], "//", 
           "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<GUMBEL MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"p2", " ", 
            RowBox[{"Exp", "[", "   ", 
             RowBox[{"p2", 
              RowBox[{"(", 
               RowBox[{"x", "-", "p1"}], ")"}]}], "]"}], " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"Exp", "[", "   ", 
               RowBox[{"p2", 
                RowBox[{"(", 
                 RowBox[{"x", "-", "p1"}], ")"}]}], "]"}]}], "]"}]}], "//", 
           "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<FRECHET MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             FractionBox["p2", "p1"], 
             SuperscriptBox[
              RowBox[{"(", 
               FractionBox["x", "p1"], ")"}], 
              RowBox[{"p2", "+", "1"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 FractionBox["x", "p1"], "]"}], "p2"]}], "]"}]}], "]"}], "//",
            "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<FRECHET MAX\>\""}], ",", 
         RowBox[{"Return", "[", "          ", 
          RowBox[{
           RowBox[{
            FractionBox["p2", "p1"], 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["p1", "x"], ")"}], 
             RowBox[{"p2", "+", "1"}]], 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                FractionBox["p1", "x"], "]"}], "p2"]}], "]"}]}], "//", "N"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<WEIBULL MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "\[LessEqual]", "  ", "p3"}], ",", "0.0", ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["p2", 
                RowBox[{"p3", "-", "p1"}]]}], 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"p3", "-", "x"}], 
                 RowBox[{"p3", "-", "p1"}]], ")"}], 
               RowBox[{"p2", "-", "1"}]], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"p3", "-", "x"}], 
                   RowBox[{"p3", "-", "p1"}]], ")"}], "p2"]}], "]"}]}]}], 
            "]"}], "//", "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<WEIBULL MAX\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "\[GreaterEqual]", " ", "p4"}], ",", "0.0", ",", 
             "    ", 
             RowBox[{
              FractionBox["p2", 
               RowBox[{"p4", "-", "p1"}]], 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"p4", "-", "x"}], 
                 RowBox[{"p4", "-", "p1"}]], ")"}], 
               RowBox[{"p2", "-", "1"}]], 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"p4", "-", "x"}], 
                   RowBox[{"p4", "-", "p1"}]], ")"}], "p2"]}], "]"}]}]}], 
            "]"}], "//", "N"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.39781561796875*^9, 3.39781563146875*^9}, {
   3.397815998421875*^9, 3.39781599909375*^9}, 3.39781608703125*^9, 
   3.3978305421875*^9, {3.39792641146875*^9, 3.397926433234375*^9}, {
   3.422009923859375*^9, 3.4220099349375*^9}},
 CellLabel->"In[35]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Cumulative Probability Distribution functions - Fx = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"CDF", "(", "x", ")"}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.3978305421875*^9}],

Cell[CellGroupData[{

Cell["\<\
INPUT:  \t\tx = value of x where to evaluate the CDF F(x); 
\t\trv = random variable;               
OUTPUT:\t value Fx\
\>", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.3978305421875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"StCDF", ",", "rvi", ",", "x"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StCDF", "[", 
    RowBox[{"rvi_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"UUF", ",", "ty", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], 
      "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"ty", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"UUF", " ", "=", 
        SuperscriptBox["10", 
         RowBox[{"-", "99"}]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rvi", "\[Equal]", "fi"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"FI", "[", "x", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ty", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<PAR1\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<PAR2\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p3", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p4", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "\[Equal]", " ", "\"\<NUMER\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RVGET", "[", 
             RowBox[{
              RowBox[{"{", "rvi", "}"}], ",", 
              RowBox[{"{", "   ", "\"\<CDF\>\"", "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<DETERM\>\""}], ",", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "\[GreaterEqual]", " ", "p1"}], ",", "1.0", ",", 
             "0"}], "]"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<UNIFORM\>\""}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "\[GreaterEqual]", " ", "p2"}], ",", "1.0", ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", "\[LessEqual]", " ", "p1"}], ",", "0.0", ",", 
               "\[IndentingNewLine]", "\t\t\t", 
               FractionBox[
                RowBox[{"x", "-", "p1"}], 
                RowBox[{"p2", "-", "p1"}]]}], "]"}]}], "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<NORMAL\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"FI", "[", 
           FractionBox[
            RowBox[{"x", "-", "p1"}], "p2"], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<LOGNORMAL\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "<", "UUF"}], ",", "0.0", ",", 
            RowBox[{"FI", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"Log", "[", "x", "]"}], "-", "p1"}], "p2"], "]"}]}], 
           "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<EXPO\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "<", "p3"}], ",", "0.0", ",", 
            RowBox[{
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "p1"}], " ", 
                RowBox[{"(", 
                 RowBox[{"x", " ", "-", " ", "p3"}], ")"}]}], "]"}]}], "//", 
             "N"}]}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<RAYLEIGH\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "<", "p3"}], ",", "0.0", ",", " ", 
            RowBox[{
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"x", "-", "p3"}], "p1"], ")"}], "2"]}], "]"}]}], "//",
              "N"}]}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<LOGISTIC\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"1", "+", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["Pi", 
                 SqrtBox["3"]]}], 
               FractionBox[
                RowBox[{"(", 
                 RowBox[{"x", "-", "p1"}], ")"}], "p2"]}], "]"}]}]], "//", 
           "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<GAMMA\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "<", "p3"}], ",", "0.0", ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"p2", ",", "0", ",", 
                RowBox[{"p1", " ", "x"}]}], "]"}], 
              RowBox[{"Gamma", "[", "p2", "]"}]], "//", "N"}]}], "]"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<GUMBEL MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"Exp", "[", "   ", 
               RowBox[{"p2", 
                RowBox[{"(", 
                 RowBox[{"x", "-", "p1"}], ")"}]}], "]"}]}], "]"}]}], "//", 
           "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<GUMBEL MAX\>\""}], ",", 
         RowBox[{"Return", "[", "       ", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "p2"}], 
               RowBox[{"(", 
                RowBox[{"x", "-", "p1"}], ")"}]}], "]"}]}], "]"}], "//", 
           "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<FRECHET MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                RowBox[{"(", 
                 FractionBox["x", "p1"], ")"}], "]"}], "p2"]}], "]"}]}], "//",
            "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<FRECHET MAX\>\""}], ",", 
         RowBox[{"Return", "[", "        ", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{"(", 
                FractionBox["p1", "x"], ")"}], "]"}], "p2"]}], "]"}], "//", 
           "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<WEIBULL MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "\[LessEqual]", "  ", "p3"}], ",", "0.0", ",", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"p3", "-", "x"}], 
                   RowBox[{"p3", "-", "p1"}]], ")"}], "p2"]}], "]"}]}]}], 
            "]"}], "//", "N"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ty", "==", "\"\<WEIBULL MAX\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "\[GreaterEqual]", " ", "p4"}], ",", "1.0", ",", 
             "        ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"p4", "-", "x"}], 
                  RowBox[{"p4", "-", "p1"}]], ")"}], "p2"]}], "]"}]}], "]"}], 
           "//", "N"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.397815640015625*^9, 3.397815643796875*^9}, {
   3.397816059125*^9, 3.39781608703125*^9}, 3.397830542203125*^9},
 CellLabel->"In[37]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Inverse of cumulative probability distribution functions - x = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"CDF", "(", "Fx", ")"}], 
    RowBox[{"-", "1"}]], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542203125*^9}],

Cell[CellGroupData[{

Cell["\<\
INPUT:  \t\tFx = F(x) = value of the CDF at x; 
\t\trv = random variable;               
OUTPUT: \tvalue x\
\>", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542203125*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "INVCDF", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"INVCDF", "[", 
    RowBox[{"rvi_", ",", "Fx_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "UUF", ",", "PI", ",", "ty", ",", "p1", ",", "p2", ",", "p3", ",", 
       "p4"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "UUF", ",", "PI", ",", "ty", ",", "p1", ",", "p2", ",", "p3", ",", 
         "p4"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"UUF", " ", "=", 
        SuperscriptBox["10", 
         RowBox[{"-", "99"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PI", " ", "=", " ", "3.14159265359"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"UUF", "\[LessEqual]", " ", "Fx", "\[LessEqual]", " ", 
            RowBox[{"1", "-", "UUF"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Return", "[", "0.0", "]"}], ";"}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"type", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<PAR1\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<PAR2\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p3", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p4", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvi", "}"}], ",", 
           RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[Equal]", " ", "\"\<NUMER\>\""}], ",", 
         RowBox[{
          RowBox[{"f", "=", 
           RowBox[{
            RowBox[{"RVGET", "[", 
             RowBox[{
              RowBox[{"{", "rvi", "}"}], ",", 
              RowBox[{"{", "   ", "\"\<PAR1\>\"", "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
          RowBox[{"Return", "[", 
           RowBox[{"f", "[", "x", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<DETERM\>\""}], ",", 
         RowBox[{"Return", "[", "p1", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<UNIFORM\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p2", "-", "p1"}], ")"}], "*", "Fx"}], "+", "p1"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<NORMAL\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"INVFI", "[", "Fx", "]"}], " ", "p2"}], "+", "p1"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<LOGNORMAL\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"INVFI", "[", "Fx", "]"}], " ", "p2"}], "+", "p1"}], 
           "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<EXPO\>\""}], ",", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"p3", "-", 
            FractionBox[
             RowBox[{"Log", "[", 
              RowBox[{"1", "-", "Fx"}], "]"}], "p1"]}], "]"}], "//", "N"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<RAYLEIGH\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"p3", "+", 
           RowBox[{"p1", "*", 
            SqrtBox[
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{"Log", "[", 
               RowBox[{"1", "-", "Fx"}], "]"}]}]]}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<LOGISTIC\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{
               FractionBox["1", "Fx"], "-", "1"}], "]"}]}], " ", 
            SqrtBox["3"], 
            FractionBox["p2", "Pi"]}], " ", "+", "p1"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<GAMMA\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"p3", "+", 
           RowBox[{
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StCDF", "[", 
                RowBox[{"rvi", ",", "x"}], "]"}], "\[Equal]", "Fx"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"RVGET", "[", 
                  RowBox[{
                   RowBox[{"{", "rvi", "}"}], ",", 
                   RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "}"}]}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<GUMBEL MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"1", "-", "Fx"}], "]"}]}], "]"}], "p2"], "+", "p1"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<GUMBEL MAX\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"Log", "[", 
              RowBox[{"-", 
               RowBox[{"Log", "[", "Fx", "]"}]}], "]"}], "p2"]}], "+", "p1"}],
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<FRECHET MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"p1", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"Log", "[", 
               RowBox[{"1", "-", "Fx"}], "]"}]}], ")"}], 
            FractionBox["1", "p2"]]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<FRECHET MAX\>\""}], ",", 
         RowBox[{"Return", "[", 
          FractionBox["p1", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"Log", "[", "Fx", "]"}]}], ")"}], 
            FractionBox["1", "p2"]]], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<WEIBULL MIN\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"p3", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p1", "-", "p3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", 
               RowBox[{"Log", "[", 
                RowBox[{"1", "-", "Fx"}], "]"}]}], ")"}], "^", 
             RowBox[{"(", 
              FractionBox["1", "p2"], ")"}]}]}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<WEIBULL MAX\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"p4", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p1", "-", "p4"}], ")"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", 
               RowBox[{"Log", "[", "Fx", "]"}]}], ")"}], "^", 
             RowBox[{"(", 
              FractionBox["1", "p2"], ")"}]}]}]}], "]"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.39781606909375*^9, 3.39781608703125*^9}, 
   3.397830542203125*^9, {3.44706762267521*^9, 3.4470676349101334`*^9}},
 CellLabel->"In[39]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluation of distribution parameters given moments", "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542203125*^9},
 CellLabel->"In[21]:="],

Cell[CellGroupData[{

Cell["\<\
INPUT:  \t\tvin = random variable with mean and dev               
OUTPUT: \trandom variable with p1, p2 and limits               \
\>", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.397830542203125*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "CALCPAR", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CALCPAR", "[", "vin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mean", ",", "sdev", ",", "type", ",", "p1", ",", "p2", ",", "p3", ",", 
       "p4", ",", "px", ",", "vout", ",", "x"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "mean", ",", "sdev", ",", "type", ",", "p1", ",", "p2", ",", "p3", 
         ",", "p4", ",", "px", ",", "vout", ",", "x"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "vin", "]"}], "\[NotEqual]", " ", 
          RowBox[{"Dimensions", "[", "RVCREATE", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Conflicting Vector sizes in CALCPAR()!\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "0.0", "]"}], ";"}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"type", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mean", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sdev", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<SDEV\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "     ", 
       RowBox[{"p3", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "     ", 
       RowBox[{"p4", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "type", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\"\<DETERM\>\"", ",", 
         RowBox[{
          RowBox[{"p1", "=", "mean"}], ";", 
          RowBox[{"p2", "=", "0.0"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\"\<UNIFORM\>\"", ",", 
         RowBox[{
          RowBox[{"p1", "=", 
           RowBox[{
            RowBox[{"mean", "-", 
             RowBox[{
              SqrtBox["3"], "sdev"}]}], "//", "N"}]}], ";", 
          RowBox[{"p2", "=", 
           RowBox[{
            RowBox[{"mean", "+", 
             RowBox[{
              SqrtBox["3"], "sdev"}]}], "//", "N"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\"\<NORMAL\>\"", 
         ",", 
         RowBox[{
          RowBox[{"p1", "=", "mean"}], ";", 
          RowBox[{"p2", "=", "sdev"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\"\<LOGNORMAL\>\"", ",", 
         RowBox[{
          RowBox[{"p2", "=", 
           SqrtBox[
            RowBox[{"Log", "[", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["sdev", "mean"], ")"}], "2"]}], "]"}]]}], ";", 
          RowBox[{"p1", "=", 
           RowBox[{
            RowBox[{"Log", "[", "mean", " ", "]"}], "-", 
            RowBox[{"0.5", " ", 
             SuperscriptBox["p2", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", "\"\<EXPO\>\"", ",", 
         RowBox[{
          RowBox[{"p1", "=", 
           RowBox[{"1", "/", "sdev"}]}], ";", 
          RowBox[{"p2", " ", "=", " ", "0"}], ";", 
          RowBox[{"p3", " ", "=", " ", 
           RowBox[{"mean", "-", "sdev"}]}], ";"}], "\[IndentingNewLine]", ",",
          "\[IndentingNewLine]", "\"\<RAYLEIGH\>\"", ",", 
         RowBox[{
          RowBox[{"p1", "=", 
           RowBox[{
            FractionBox["sdev", 
             SqrtBox[
              RowBox[{"2", "-", 
               RowBox[{"Pi", "/", "2"}]}]]], "//", "N"}]}], ";", 
          RowBox[{"p2", "=", "0"}], ";", 
          RowBox[{"(*", 
           RowBox[{"p3", "=", 
            RowBox[{
             RowBox[{"mean", "-", 
              RowBox[{"p1", " ", 
               SqrtBox[
                RowBox[{"Pi", "/", "2"}]]}]}], "//", "N"}]}], " ", "*)"}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<LOGISTIC\>\"", ",", 
         RowBox[{
          RowBox[{"p1", " ", "=", " ", "mean"}], ";", 
          RowBox[{"p2", " ", "=", " ", "sdev"}], ";"}], "\[IndentingNewLine]",
          ",", "\[IndentingNewLine]", "\"\<GAMMA\>\"", ",", 
         RowBox[{
          RowBox[{"p1", "=", 
           RowBox[{
            FractionBox["mean", 
             SuperscriptBox["sdev", "2"]], "//", "N"}]}], ";", 
          RowBox[{"p2", "=", 
           RowBox[{
            FractionBox[
             SuperscriptBox["mean", "2"], 
             SuperscriptBox["sdev", "2"]], "//", "N"}]}], ";", 
          RowBox[{"p3", "=", "0"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\"\<GUMBEL MIN\>\"", " ", ",", 
         RowBox[{
          RowBox[{"p2", " ", "=", " ", 
           RowBox[{
            FractionBox["Pi", 
             RowBox[{
              SqrtBox["6"], "sdev"}]], "//", "N"}]}], ";", 
          RowBox[{"p1", " ", "=", " ", 
           RowBox[{
            RowBox[{"mean", "+", 
             FractionBox["EulerGamma", "p2"]}], "//", "N"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<GUMBEL MAX\>\"", ",", 
         RowBox[{
          RowBox[{"p2", " ", "=", " ", 
           RowBox[{
            FractionBox["Pi", 
             RowBox[{
              SqrtBox["6"], "sdev"}]], "//", "N"}]}], ";", 
          RowBox[{"p1", " ", "=", " ", 
           RowBox[{
            RowBox[{"mean", "-", 
             FractionBox["EulerGamma", "p2"]}], "//", "N"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<FRECHET MIN\>\"", " ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p2", "=", 
           RowBox[{
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   FractionBox["sdev", "mean"], ")"}], "2"]}], ")"}], " ", 
               "\[Equal]", 
               FractionBox[
                RowBox[{"Gamma", "[", 
                 RowBox[{"1", "-", 
                  FractionBox["2", "x"]}], "]"}], 
                SuperscriptBox[
                 RowBox[{"Gamma", "[", 
                  RowBox[{"1", "-", 
                   FractionBox["1", "x"]}], "]"}], "2"]]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "5", ",", "20"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p1", " ", "=", " ", 
           RowBox[{
            FractionBox["mean", 
             RowBox[{"Gamma", "[", 
              RowBox[{"1", "+", 
               FractionBox["1", "p2"]}], "]"}]], "//", "N"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", " ", "\"\<FRECHET MAX\>\"", " ", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p2", "=", 
           RowBox[{
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   FractionBox["sdev", "mean"], ")"}], "2"]}], ")"}], " ", 
               "\[Equal]", 
               FractionBox[
                RowBox[{"Gamma", "[", 
                 RowBox[{"1", "-", 
                  FractionBox["2", "x"]}], "]"}], 
                SuperscriptBox[
                 RowBox[{"Gamma", "[", 
                  RowBox[{"1", "-", 
                   FractionBox["1", "x"]}], "]"}], "2"]]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "3", ",", "5"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p1", " ", "=", " ", 
           RowBox[{
            FractionBox["mean", 
             RowBox[{"Gamma", "[", 
              RowBox[{"1", "-", 
               FractionBox["1", "p2"]}], "]"}]], "//", "N"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\"\<WEIBULL MIN\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p2", "=", 
           RowBox[{
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   FractionBox["sdev", 
                    RowBox[{"mean", "-", "p3"}]], ")"}], "2"]}], ")"}], " ", 
               "\[Equal]", 
               FractionBox[
                RowBox[{"Gamma", "[", 
                 RowBox[{"1", "+", 
                  FractionBox["2", "x"]}], "]"}], 
                SuperscriptBox[
                 RowBox[{"Gamma", "[", 
                  RowBox[{"1", "+", 
                   FractionBox["1", "x"]}], "]"}], "2"]]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "3", ",", "5"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p1", " ", "=", " ", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"mean", "-", "p3"}], 
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "+", 
                FractionBox["1", "p2"]}], "]"}]], "+", "p3"}], "//", "N"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<WEIBULL MAX\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p2", "=", 
           RowBox[{
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   FractionBox["sdev", 
                    RowBox[{"p4", "-", "mean"}]], ")"}], "2"]}], ")"}], " ", 
               "\[Equal]", 
               FractionBox[
                RowBox[{"Gamma", "[", 
                 RowBox[{"1", "+", 
                  FractionBox["2", "x"]}], "]"}], 
                SuperscriptBox[
                 RowBox[{"Gamma", "[", 
                  RowBox[{"1", "+", 
                   FractionBox["1", "x"]}], "]"}], "2"]]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "3", ",", "5"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p1", " ", "=", " ", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"mean", "-", "p4"}], 
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "+", 
                FractionBox["1", "p2"]}], "]"}]], "+", "p4"}], "//", "N"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "_", ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Bad Random Variable CODE!\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vout", "=", 
        RowBox[{"RVPUT", "[", 
         RowBox[{
          RowBox[{"{", "vin", "}"}], ",", 
          RowBox[{"{", "        ", 
           RowBox[{
            RowBox[{"{", "p1", "}"}], ",", "      ", 
            RowBox[{"{", "p2", "}"}], ",", "      ", 
            RowBox[{"{", "p3", "}"}], ",", "      ", 
            RowBox[{"{", "p4", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
           "\"\<PAR1\>\"", ",", "\"\<PAR2\>\"", ",", "\"\<VMIN\>\"", ",", 
            "\"\<VMAX\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vout", " ", "=", " ", 
        RowBox[{"CALCLIMITS", "[", "vout", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vout", " ", "=", " ", 
        RowBox[{"CALCPLOTLIMITS", "[", "vout", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"N", "[", "vout", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.39781608703125*^9, 3.39783054221875*^9, {3.400600333375*^9, 
   3.40060033728125*^9}, {3.403629491703125*^9, 3.403629494296875*^9}, {
   3.403629566796875*^9, 3.40362990665625*^9}, {3.40700229040625*^9, 
   3.407002290984375*^9}, 3.407004349546875*^9, 3.5007166636347494`*^9},
 CellLabel->"In[41]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluation of distribution lower and upper limits ", "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.39783054221875*^9},
 CellLabel->"In[21]:="],

Cell[CellGroupData[{

Cell["\<\
INPUT:  \t\tvin = random variable with mean, sdev, p1 and p2 
OUTPUT: \trandom variable with  limits               \
\>", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.39783054221875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "CALCLIMITS", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CALCLIMITS", "[", "vin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "iCDFLIM", ",", "mean", ",", "sdev", ",", "type", ",", "p1", ",", "p2", 
       ",", "p3", ",", "p4", ",", "px", ",", "vout"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "iCDFLIM", ",", "mean", ",", "sdev", ",", "type", ",", "p1", ",", 
         "p2", ",", "p3", ",", "p4", ",", "px", ",", "vout"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "vin", "]"}], "\[NotEqual]", " ", 
          RowBox[{"Dimensions", "[", "RVCREATE", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Conflicting Vector sizes in CALCLIMITS()!\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "0.0", "]"}], ";"}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"iCDFLIM", " ", "=", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "15"}]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"type", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mean", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sdev", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<SDEV\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "     ", 
       RowBox[{"p1", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<PAR1\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "    ", 
       RowBox[{"p2", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<PAR2\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "    ", 
       RowBox[{"p3", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "    ", 
       RowBox[{"p4", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "vin", "}"}], ",", 
           RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<NUMER\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", "iCDFLIM"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<DETERM\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", 
           RowBox[{"0.95", " ", "p1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"1.05", " ", "p1"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "==", "\"\<UNIFORM\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", "p1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"p4", "=", "p2"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[Equal]", "\"\<NORMAL\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", 
           RowBox[{"mean", "-", 
            RowBox[{"SDLIMINF", " ", "sdev"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"mean", "+", 
            RowBox[{"SDLIMSUP", " ", "sdev"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[Equal]", "\"\<LOGNORMAL\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", "iCDFLIM"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "  ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[Equal]", "\"\<EXPO\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", " ", "=", " ", 
           RowBox[{"mean", "-", "sdev"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[Equal]", "\"\<RAYLEIGH\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"p3", "=", 
            RowBox[{
             RowBox[{"mean", "-", 
              RowBox[{"p1", " ", 
               SqrtBox[
                RowBox[{"Pi", "/", "2"}]]}]}], "//", "N"}]}], ";"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", " ", "\[Equal]", " ", "\"\<LOGISTIC\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", "       ", "iCDFLIM"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[Equal]", "\"\<GAMMA\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"type", "\[Equal]", " ", "\"\<GUMBEL MIN\>\""}], " ", "||", 
          RowBox[{"type", "\[Equal]", " ", "\"\<GUMBEL MAX\>\""}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", "       ", "iCDFLIM"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"type", "\[Equal]", " ", "\"\<FRECHET MIN\>\""}], " ", "||",
           " ", 
          RowBox[{"type", "\[Equal]", " ", "\"\<FRECHET MAX\>\""}]}], " ", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", "       ", "iCDFLIM"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[Equal]", " ", "\"\<WEIBULL MIN\>\""}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p4", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", 
             RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[Equal]", " ", "\"\<WEIBULL MAX\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p3", "=", 
           RowBox[{"INVCDF", "[", 
            RowBox[{"vin", ",", "iCDFLIM"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vout", "=", 
        RowBox[{"RVPUT", "[", 
         RowBox[{
          RowBox[{"{", "vin", "}"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"{", "p3", "}"}], ",", 
            RowBox[{"{", "p4", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<VMIN\>\"", ",", "\"\<VMAX\>\""}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"N", "[", "vout", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.39781608703125*^9, 3.39783054221875*^9, {3.397919370078125*^9, 
   3.397919375109375*^9}, {3.400408940703125*^9, 3.40040894584375*^9}, {
   3.400408985046875*^9, 3.4004090135625*^9}, {3.4004091405*^9, 
   3.40040916540625*^9}, {3.400409359046875*^9, 3.400409375140625*^9}, {
   3.400410334359375*^9, 3.400410395953125*^9}, {3.40041044853125*^9, 
   3.400410653375*^9}, 3.4004117474375*^9, {3.4004120395*^9, 
   3.4004120423125*^9}, {3.400413788578125*^9, 3.40041378909375*^9}, {
   3.4036286215625*^9, 3.40362863071875*^9}, {3.4036287608125*^9, 
   3.403628761078125*^9}, {3.403885615109375*^9, 3.403885642671875*^9}, {
   3.407004770125*^9, 3.407004770359375*^9}, {3.407004866453125*^9, 
   3.40700486659375*^9}, {3.40700489840625*^9, 3.4070048988125*^9}, {
   3.407004930859375*^9, 3.40700493140625*^9}, {3.40700496253125*^9, 
   3.407004987171875*^9}, 3.422003917515625*^9, {3.4470677245703993`*^9, 
   3.447067740211725*^9}},
 CellLabel->"In[43]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "CALCPLOTLIMITS", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CALCPLOTLIMITS", "[", "vin_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "iCDFLIM", ",", "mean", ",", "sdev", ",", "type", ",", "x1", ",", 
         "x2", ",", "p3", ",", "p4", ",", "px", ",", "vout"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{
          "iCDFLIM", ",", "mean", ",", "sdev", ",", "type", ",", "x1", ",", 
           "x2", ",", "p3", ",", "p4", ",", "px", ",", "vout"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "vin", "]"}], "\[NotEqual]", " ", 
            RowBox[{"Dimensions", "[", "RVCREATE", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<Conflicting Vector sizes in CALCLIMITS()!\>\"",
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "0.0", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"iCDFLIM", " ", "=", " ", "CDFLIMPLOT"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"type", "=", 
          RowBox[{
           RowBox[{"RVGET", "[", 
            RowBox[{
             RowBox[{"{", "vin", "}"}], ",", 
             RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "    ", 
         RowBox[{"p3", "=", 
          RowBox[{
           RowBox[{"RVGET", "[", 
            RowBox[{
             RowBox[{"{", "vin", "}"}], ",", 
             RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "    ", 
         RowBox[{"p4", "=", 
          RowBox[{
           RowBox[{"RVGET", "[", 
            RowBox[{
             RowBox[{"{", "vin", "}"}], ",", 
             RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "type", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\"\<DETERM\>\"", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"x1", "=", 
             RowBox[{"0.5", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p4", "+", "p3"}], ")"}], "/", "2"}]}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"x2", "=", 
             RowBox[{"1.5", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p4", "+", "p3"}], ")"}], "/", "2"}]}]}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           "\"\<UNIFORM\>\"", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"x1", "=", 
             RowBox[{"p3", "-", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"p4", "-", "p3"}], "]"}], "/", "2"}]}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"x2", "=", 
             RowBox[{"p4", "+", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"p4", "-", "p3"}], "]"}], "/", "2"}]}]}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "_", ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"x1", "=", 
             RowBox[{"INVCDF", "[", 
              RowBox[{"vin", ",", "       ", "iCDFLIM"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"x2", "=", 
             RowBox[{"INVCDF", "[", 
              RowBox[{"vin", ",", 
               RowBox[{"1", "-", "iCDFLIM"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"vout", "=", 
          RowBox[{"RVPUT", "[", 
           RowBox[{
            RowBox[{"{", "vin", "}"}], ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"{", "x1", "}"}], ",", 
              RowBox[{"{", "x2", "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<PMIN\>\"", ",", "\"\<PMAX\>\""}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"N", "[", "vout", "]"}], "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.39781608703125*^9, 3.39783054221875*^9, {3.397919370078125*^9, 
   3.397919375109375*^9}, {3.400408940703125*^9, 3.40040894584375*^9}, {
   3.400408985046875*^9, 3.4004090135625*^9}, {3.4004091405*^9, 
   3.40040916540625*^9}, {3.400409359046875*^9, 3.400409375140625*^9}, {
   3.400410334359375*^9, 3.400410395953125*^9}, {3.40041044853125*^9, 
   3.400410653375*^9}, {3.400410690328125*^9, 3.400410704296875*^9}, {
   3.400410742609375*^9, 3.40041078978125*^9}, {3.400410824921875*^9, 
   3.400410874703125*^9}, {3.4004109335*^9, 3.40041100925*^9}, {
   3.400411184578125*^9, 3.400411207625*^9}, {3.400411436484375*^9, 
   3.4004116896875*^9}, {3.400600386375*^9, 3.400600389015625*^9}},
 CellLabel->"In[45]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "FINDPDFINTERVAL", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FINDPDFINTERVAL", "[", 
      RowBox[{"rvi_", ",", 
       RowBox[{"{", 
        RowBox[{"rmin_", ",", "rmax_"}], "}"}], ",", "toler_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
        "delta", ",", "xmean", ",", "fmean", ",", "dr", ",", "imax", ",", 
         "imin"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{
          "delta", ",", "xmean", ",", "fmean", ",", "dr", ",", "imax", ",", 
           "imin"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"delta", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"(", 
            RowBox[{"rmax", "-", "rmin"}], ")"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"xmean", " ", "=", " ", 
          RowBox[{
           RowBox[{"RVGET", "[", 
            RowBox[{
             RowBox[{"{", "rvi", "}"}], ",", 
             RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fmean", " ", "=", " ", 
          RowBox[{"StPDF", "[", 
           RowBox[{"rvi", ",", "xmean"}], "]"}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"dr", " ", "=", " ", 
          RowBox[{"delta", "/", "1000"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"imax", " ", "=", " ", "xmean"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StPDF", "[", 
               RowBox[{"rvi", ",", "imax"}], "]"}], ">", " ", 
              RowBox[{"fmean", " ", "toler"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"imax", "<", "rmax"}], ")"}]}], ",", 
           RowBox[{"imax", " ", "=", " ", 
            RowBox[{"imax", " ", "+", " ", "dr"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"imin", " ", "=", " ", "xmean"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StPDF", "[", 
               RowBox[{"rvi", ",", "imin"}], "]"}], ">", " ", 
              RowBox[{"fmean", " ", "toler"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"imin", ">", "rmin"}], ")"}]}], ",", 
           RowBox[{"imin", " ", "=", " ", 
            RowBox[{"imin", " ", "-", " ", "dr"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"imin", ",", "rmin"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"imax", ",", "rmax"}], "]"}]}], "}"}], "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "FINDCDFINTERVAL", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FINDCDFINTERVAL", "[", 
      RowBox[{"rvi_", ",", 
       RowBox[{"{", 
        RowBox[{"rmin_", ",", "rmax_"}], "}"}], ",", "toler_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
        "delta", ",", "xmean", ",", "fmean", ",", "dr", ",", "imax", ",", 
         "imin"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{
          "delta", ",", "xmean", ",", "fmean", ",", "dr", ",", "imax", ",", 
           "imin"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"delta", " ", "=", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"(", 
            RowBox[{"rmax", "-", "rmin"}], ")"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"xmean", " ", "=", " ", 
          RowBox[{
           RowBox[{"RVGET", "[", 
            RowBox[{
             RowBox[{"{", "rvi", "}"}], ",", 
             RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fmean", " ", "=", " ", 
          RowBox[{"StPDF", "[", 
           RowBox[{"rvi", ",", "xmean"}], "]"}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"dr", " ", "=", " ", 
          RowBox[{"delta", "/", "1000"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"imax", " ", "=", " ", "xmean"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StCDF", "[", 
               RowBox[{"rvi", ",", "imax"}], "]"}], "<", 
              RowBox[{"1", "-", "toler"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"imax", "<", "rmax"}], ")"}]}], ",", 
           RowBox[{"imax", " ", "=", " ", 
            RowBox[{"imax", " ", "+", " ", "dr"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"imin", " ", "=", " ", "xmean"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StCDF", "[", 
               RowBox[{"rvi", ",", "imin"}], "]"}], ">", " ", "toler"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"imin", ">", "rmin"}], ")"}]}], ",", 
           RowBox[{"imin", " ", "=", " ", 
            RowBox[{"imin", " ", "-", " ", "dr"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"imin", ",", "rmin"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"imax", ",", "rmax"}], "]"}]}], "}"}], "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.397815903828125*^9, 3.3978159060625*^9}, {
   3.397816031828125*^9, 3.397816032484375*^9}, 3.39781608703125*^9, 
   3.39783054221875*^9, 3.40041170790625*^9},
 CellLabel->"In[47]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Evaluation of distribution moments given distribution parameters\
\>", "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.39783054221875*^9},
 CellLabel->"In[21]:="],

Cell[CellGroupData[{

Cell["\<\
INPUT:  \t\tvin = random variable with  p1 and p2 and limits                
OUTPUT: \trandom variable with mean, sdev           \
\>", "Subsubsection",
 CellChangeTimes->{3.39781608703125*^9, 3.39783054221875*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "CALCMOM", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CALCMOM", "[", "rvin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rv", ",", "rvout", ",", "f", ",", "x", ",", "mean", ",", "sdev", ",", 
       "mean2", ",", "sdev2", ",", "x1", ",", "x2", ",", "type", ",", "p1", 
       ",", "p2", ",", "p3", ",", "p4"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "rv", ",", "rvout", ",", "f", ",", "x", ",", "mean", ",", "sdev", ",",
          "mean2", ",", "sdev2", ",", "x1", ",", "x2", ",", "type", ",", "p1",
          ",", "p2", ",", "p3", ",", "p4"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"type", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvin", "}"}], ",", 
           RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvin", "}"}], ",", 
           RowBox[{"{", "\"\<PAR1\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvin", "}"}], ",", 
           RowBox[{"{", "\"\<PAR2\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvin", "}"}], ",", 
           RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p4", "=", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rvin", "}"}], ",", 
           RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "type", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\"\<DETERM\>\"", ",", 
         RowBox[{
          RowBox[{"mean", "=", "p1"}], ";", 
          RowBox[{"sdev", "=", "0.0"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\"\<UNIFORM\>\"", ",", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p1", "+", "p2"}], ")"}], "/", "2"}], "//", "N"}]}], 
          ";", 
          RowBox[{"sdev", " ", "=", " ", 
           FractionBox[
            RowBox[{"Abs", "[", 
             RowBox[{"p2", "-", "p1"}], "]"}], 
            RowBox[{"Sqrt", "[", "12", "]"}]]}], ";"}], "\[IndentingNewLine]",
          ",", "\[IndentingNewLine]", "\"\<NORMAL\>\"", ",", 
         RowBox[{
          RowBox[{"mean", "=", "p1"}], ";", 
          RowBox[{"sdev", " ", "=", " ", "p2"}], ";"}], "\[IndentingNewLine]",
          ",", "\[IndentingNewLine]", "\"\<LOGNORMAL\>\"", ",", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"p1", "+", 
             RowBox[{"0.5", " ", 
              SuperscriptBox["p2", "2"]}]}], "]"}]}], ";", " ", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{"mean", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               SuperscriptBox["p2", "2"], "]"}], "-", "1"}], "]"}]}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\"\<EXPO\>\"", 
         ",", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{
            RowBox[{"1", "/", "p1"}], "+", "p3"}]}], ";", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{"1", "/", "p1"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\"\<RAYLEIGH\>\"", ",", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{
            RowBox[{"p1", " ", 
             SqrtBox[
              RowBox[{"Pi", "/", "2"}]]}], "+", "p3"}]}], ";", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{"p1", " ", 
            SqrtBox[
             RowBox[{"2", "-", 
              RowBox[{"Pi", "/", "2"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", "\"\<LOGISTIC\>\"", ",", 
         RowBox[{
          RowBox[{"mean", "=", "p1"}], ";", 
          RowBox[{"sdev", "=", "p2"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\"\<GAMMA\>\"", ",", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{"p2", "/", "p1"}]}], ";", " ", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{
            RowBox[{"Sqrt", "[", "p2", "]"}], "/", "p1"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<GUMBEL MIN\>\"", " ", ",", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{
            RowBox[{"p1", "-", 
             FractionBox["EulerGamma", "p2"]}], "//", "N"}]}], ";", " ", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{
            FractionBox["Pi", 
             RowBox[{
              SqrtBox["6"], "p2"}]], "//", "N"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<GUMBEL MAX\>\"", " ", ",", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{
            RowBox[{"p1", "+", 
             FractionBox["EulerGamma", "p2"]}], "//", "N"}]}], ";", " ", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{
            FractionBox["Pi", 
             RowBox[{
              SqrtBox["6"], "p2"}]], "//", "N"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<FRECHET MIN\>\"", " ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{"p1", " ", 
            RowBox[{"Gamma", "[", 
             RowBox[{"1", "-", 
              FractionBox["1", "p2"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{"p1", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "-", 
                FractionBox["2", "p2"]}], "]"}], "-", 
              SuperscriptBox[
               RowBox[{"Gamma", "[", 
                RowBox[{"1", "-", 
                 FractionBox["1", "p2"]}], "]"}], "2"]}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<FRECHET MAX\>\"", " ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{"p1", " ", 
            RowBox[{"Gamma", "[", 
             RowBox[{"1", "-", 
              FractionBox["1", "p2"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{"p1", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "-", 
                FractionBox["2", "p2"]}], "]"}], "-", 
              SuperscriptBox[
               RowBox[{"Gamma", "[", 
                RowBox[{"1", "-", 
                 FractionBox["1", "p2"]}], "]"}], "2"]}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<WEIBULL MIN\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{"p3", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p1", "-", "p3"}], ")"}], " ", 
             RowBox[{"Gamma", "[", 
              RowBox[{"1", "+", 
               FractionBox["1", "p2"]}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p1", "-", "p3"}], ")"}], " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "+", 
                FractionBox["2", "p2"]}], "]"}], "-", 
              SuperscriptBox[
               RowBox[{"Gamma", "[", 
                RowBox[{"1", "+", 
                 FractionBox["1", "p2"]}], "]"}], "2"]}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\"\<WEIBULL MAX\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mean", " ", "=", " ", 
           RowBox[{"p4", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p4", "-", "p1"}], ")"}], " ", 
             RowBox[{"Gamma", "[", 
              RowBox[{"1", "+", 
               FractionBox["1", "p2"]}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sdev", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p4", "-", "p1"}], ")"}], " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "+", 
                FractionBox["2", "p2"]}], "]"}], "-", 
              SuperscriptBox[
               RowBox[{"Gamma", "[", 
                RowBox[{"1", "+", 
                 FractionBox["1", "p2"]}], "]"}], "2"]}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "_", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Bad distribution code, CALCMOM!\>\"", " ", "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", 
        RowBox[{"f", ",", "x"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rv", "=", 
        RowBox[{"RVPUT", "[", 
         RowBox[{
          RowBox[{"{", "rvin", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "mean", "}"}], ",", 
            RowBox[{"{", "sdev", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<MEAN\>\"", ",", "\"\<SDEV\>\""}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rv", " ", "=", " ", 
        RowBox[{"CALCLIMITS", "[", "rv", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rvout", " ", "=", " ", 
        RowBox[{"CALCPLOTLIMITS", "[", "rv", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"x1", " ", "=", "  ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rv", "}"}], ",", 
           RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x2", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rv", "}"}], ",", 
           RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", "x_", "]"}], " ", "=", " ", 
        RowBox[{"x", "*", 
         RowBox[{"StPDF", "[", 
          RowBox[{"rv", ",", "x"}], "]"}]}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"mean2", " ", "=", " ", 
        RowBox[{"OWNIntegrate", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "x2"}], " ", "}"}], ",", 
          SuperscriptBox["10", "4"]}], "]"}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", 
        RowBox[{"f", ",", "x"}], "]"}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", "x_", "]"}], " ", "=", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "mean2"}], ")"}], "2"], "*", 
         RowBox[{"StPDF", "[", 
          RowBox[{"rv", ",", "x"}], "]"}]}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"sdev2", " ", "=", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"OWNIntegrate", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2"}], " ", "}"}], ",", 
           SuperscriptBox["10", "4"]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"0.99", "\[LessEqual]", " ", 
            RowBox[{"mean2", "/", "mean"}], "\[LessEqual]", " ", "1.01"}], 
           ")"}]}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Problem in moment evaluation, \>\"", ",", "mean2", ",", 
           "\"\< / \>\"", ",", "mean", ",", "\"\< = \>\"", ",", 
           RowBox[{"mean2", "/", "mean"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"0.99", "\[LessEqual]", " ", 
            RowBox[{"sdev2", "/", "sdev"}], "\[LessEqual]", " ", "1.01"}], 
           ")"}]}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Problem in moment evaluation, \>\"", ",", "sdev2", ",", 
           "\"\< / \>\"", ",", "sdev", ",", "\"\< = \>\"", ",", 
           RowBox[{"sdev2", "/", "sdev"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "rvout", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.397815906859375*^9, 3.39781590771875*^9}, 
   3.39781608703125*^9, 3.39783054221875*^9, {3.4035322885625*^9, 
   3.403532300875*^9}, {3.403532373515625*^9, 3.403532386859375*^9}, {
   3.40363001065625*^9, 3.403630104375*^9}, {3.403630139734375*^9, 
   3.403630268515625*^9}, {3.403630327171875*^9, 3.403630466078125*^9}, {
   3.40363053178125*^9, 3.403630601734375*^9}, {3.40363077184375*^9, 
   3.40363079371875*^9}, {3.403630828703125*^9, 3.40363091040625*^9}, 
   3.4036309919375*^9, {3.403631037921875*^9, 3.40363114684375*^9}, {
   3.40363118025*^9, 3.403631227125*^9}, {3.403631280671875*^9, 
   3.403631312515625*^9}, {3.4036313530625*^9, 3.403631462390625*^9}, {
   3.403631518234375*^9, 3.4036315590625*^9}, {3.40388523625*^9, 
   3.403885297671875*^9}, {3.403885405671875*^9, 3.403885410140625*^9}, 
   3.403885814875*^9, 3.403885874515625*^9, {3.403885925265625*^9, 
   3.403885932796875*^9}, {3.40388609578125*^9, 3.40388615496875*^9}, {
   3.403886409109375*^9, 3.40388662671875*^9}, {3.403887029125*^9, 
   3.403887041734375*^9}, {3.40388719159375*^9, 3.403887443640625*^9}, {
   3.403887488*^9, 3.403887489625*^9}, {3.403887528359375*^9, 
   3.403887535375*^9}, {3.403889046859375*^9, 3.403889116140625*^9}, 
   3.422012258359375*^9},
 CellLabel->"In[51]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical alternatives to PDF and CDF", "Subsection",
 CellChangeTimes->{3.39781608703125*^9, 3.39783054221875*^9},
 CellLabel->"In[21]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LOGJOINTPDF", "[", 
     RowBox[{"rvset_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nrv", ",", "px", ",", "pdf"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"nrv", ",", "px", ",", "pdf"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nrv", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "rvset", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"px", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"StPDF", "[", 
            RowBox[{
             RowBox[{"rvset", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nrv"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pdf", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pdf", " ", "=", " ", 
            RowBox[{"pdf", "+", 
             RowBox[{"Log", "[", 
              RowBox[{"Max", "[", 
               RowBox[{"UUF", ",", 
                RowBox[{"px", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nrv"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "pdf", "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{3.397815974203125*^9, 3.397816087046875*^9, 
  3.397830542234375*^9},
 CellLabel->"In[53]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"STANDARDGAUSSIANSAMPLES", ",", "nsamplesi", ",", "nrv"}], "]"}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"STANDARDGAUSSIANSAMPLES", "[", 
      RowBox[{"nsamplesi_", ",", "nrv_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u1", ",", "u2", ",", "sgsample", ",", "nsamples"}], "}"}], 
       ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{"u1", ",", "u2", ",", "sgsample", ",", "nsamples"}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"nsamples", " ", "=", " ", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"nsamplesi", "/", "2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"u1", "=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nsamples", ",", "nrv"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u2", "=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nsamples", ",", "nrv"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"sgsample", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"2", "*", "nsamples"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"sgsample", "[", 
              RowBox[{"[", "i", "                         ", "]"}], "]"}], 
             " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], "*", 
                  RowBox[{"Log", "[", 
                   RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], 
                "*", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", "*", "Pi", "*", 
                  RowBox[{"u2", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "nrv"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"sgsample", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "nsamples"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], "*", 
                  RowBox[{"Log", "[", 
                   RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], 
                "*", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", "*", "Pi", "*", 
                  RowBox[{"u2", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "nrv"}], "}"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nsamplesi", ">", 
            RowBox[{"2", "*", "nsamples"}]}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"u1", "=", 
             RowBox[{"RandomReal", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "nrv"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"u2", "=", 
             RowBox[{"RandomReal", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "nrv"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sgsample", " ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"sgsample", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"-", "2"}], "*", 
                    RowBox[{"Log", "[", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], 
                  "*", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", "*", "Pi", "*", 
                    RowBox[{"u2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "j"}], "]"}], "]"}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "nrv"}], "}"}]}], "]"}]}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nrv", "\[Equal]", "1"}], " ", ",", 
           RowBox[{"sgsample", " ", "=", " ", 
            RowBox[{"Flatten", "[", "sgsample", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "sgsample", "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}],
    "\n"}]}]], "Input",
 CellChangeTimes->{{3.3993864095*^9, 3.39938641484375*^9}, {
   3.399387045078125*^9, 3.399387058328125*^9}, {3.399388825765625*^9, 
   3.3993890543125*^9}, {3.39938922665625*^9, 3.399389277125*^9}, {
   3.39938931246875*^9, 3.399389313390625*^9}, {3.399389346765625*^9, 
   3.399389347859375*^9}, {3.399390032203125*^9, 3.399390075796875*^9}, {
   3.400431122296875*^9, 3.40043112353125*^9}, {3.400431235796875*^9, 
   3.40043130903125*^9}, {3.400431401046875*^9, 3.40043142246875*^9}, {
   3.400431482296875*^9, 3.4004314915*^9}, 3.40043154059375*^9, {
   3.40043159078125*^9, 3.400431597359375*^9}, {3.4004316814375*^9, 
   3.40043175278125*^9}, {3.40043178815625*^9, 3.400431795859375*^9}, {
   3.400431833359375*^9, 3.400431861265625*^9}, {3.400431979828125*^9, 
   3.40043199746875*^9}, {3.40043203346875*^9, 3.40043205121875*^9}, {
   3.40043209153125*^9, 3.40043210421875*^9}, {3.40043219959375*^9, 
   3.400432211328125*^9}, {3.40050979146875*^9, 3.4005098163125*^9}, {
   3.400510006984375*^9, 3.400510049375*^9}, {3.400510080578125*^9, 
   3.4005100923125*^9}, 3.400510160578125*^9, {3.400510333109375*^9, 
   3.400510387359375*^9}, {3.400510467796875*^9, 3.400510540515625*^9}, {
   3.400510587625*^9, 3.400510678890625*^9}, {3.4005107104375*^9, 
   3.40051076328125*^9}, 3.400510807828125*^9, {3.4005108654375*^9, 
   3.4005109044375*^9}, {3.400510939625*^9, 3.400511143359375*^9}, {
   3.40051117734375*^9, 3.40051124259375*^9}},
 CellLabel->"In[54]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"RVSAMPLE", ",", "RV", ",", "nsamples"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RVSAMPLE", "[", 
      RowBox[{"RV_", ",", "nsamples_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "type", ",", "p1", ",", "p2", ",", "u", ",", "rvsample", ",", "j"}], 
        "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{
          "type", ",", "p1", ",", "p2", ",", "u", ",", "rvsample", ",", "j"}],
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"type", " ", "=", " ", 
          RowBox[{
           RowBox[{"RVGET", "[", 
            RowBox[{
             RowBox[{"{", "RV", "}"}], ",", 
             RowBox[{"{", " ", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"type", "\[Equal]", "\"\<NORMAL\>\""}], " ", "||", " ", 
            RowBox[{"type", "==", "\"\<LOGNORMAL\>\""}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"p1", " ", "=", " ", 
             RowBox[{
              RowBox[{"RVGET", "[", 
               RowBox[{
                RowBox[{"{", "RV", "}"}], ",", 
                RowBox[{"{", " ", "\"\<PAR1\>\"", "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"p2", " ", "=", " ", 
             RowBox[{
              RowBox[{"RVGET", "[", 
               RowBox[{
                RowBox[{"{", "RV", "}"}], ",", 
                RowBox[{"{", " ", "\"\<PAR2\>\"", "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"rvsample", " ", "=", " ", 
             RowBox[{"STANDARDGAUSSIANSAMPLES", "[", 
              RowBox[{"nsamples", ",", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"rvsample", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rvsample", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "*", "p2"}], "+", "p1"}]}],
                ";"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "nsamples"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"type", "\[Equal]", " ", "\"\<LOGNORMAL\>\""}], ",", 
              RowBox[{"rvsample", "=", 
               RowBox[{"Exp", "[", "rvsample", "]"}]}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rvsample", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "nsamples", "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"u", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RandomReal", "[", "]"}], ",", 
               RowBox[{"{", "nsamples", "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"rvsample", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "=", 
                RowBox[{"INVCDF", "[", 
                 RowBox[{"RV", ",", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "nsamples"}], "}"}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "rvsample", "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQzcDwbfmF4JeODAzKeyB06TEI7XwWQm+6AqYbZt6H
8KMfQ2iFZxDxuf+g+oQvQsSVIbS0FoR2N4bQgRC6gXUihO6G0Ax7P0Nopi8Q
8W2/IPxTULpB4hKYvqgOphumakP4E3UhfH4jCH+PJYQfbA/hq7hA+IWhEPps
JES8MQnCnwGllz8+FwqiV0Pp037nwbRbAIQOv/8VRDO4PADRADe/h0g=
  "],
 CellLabel->"In[56]:="]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. TWO DIMENSIONAL PLOT MODULES", "Title"],

Cell[CellGroupData[{

Cell["JOINT PDF PLOT MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SetTwoDimensionalPlotVector", ",", "x1", ",", "x2", ",", "VXN"}],
     "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetTwoDimensionalPlotVector", "[", 
     RowBox[{"x1_", ",", "x2_"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "RVPLOT", "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", "RVPLOT", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x1", "<", "x2"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"RVPLOT", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"x1", ",", "x2"}], "}"}]}], ";"}], "\[IndentingNewLine]",
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"RVPLOT", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"x2", ",", "x1"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<Increasing order required for plotting, invertion \
underway!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"D2NAME", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NAME", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"NAME", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D2MEAN", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MEAN", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"MEAN", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D2SDEV", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SDEV", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"SDEV", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"D2PMIN", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PMIN", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"PMIN", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D2PMAX", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PMAX", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"PMAX", "[", 
            RowBox[{"[", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"D2NAMEY", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Y\), \(1\)]\)\>\"", ",", 
            "\"\<\!\(\*SubscriptBox[\(Y\), \(2\)]\)\>\""}], "}"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "RVPLOT", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"D2NAMEY", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<`` (transf.)\>\"", ",", 
           RowBox[{"D2NAME", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t\t\t    ", 
        RowBox[{"ToString", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<`` (transf.)\>\"", ",", 
           RowBox[{"D2NAME", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetTransformationPoint", "[", 
     RowBox[{"rv_", ",", "transfpt_"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Jyz", ",", "Jzy"}], "}"}], " ", "=", " ", 
          RowBox[{"JacobYZ", "[", "RX", "]"}]}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Jxz", ",", "Jzx"}], "}"}], " ", "=", " ", 
         RowBox[{"JacobXZ", "[", 
          RowBox[{"rv", ",", "transfpt"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Jyx", " ", "=", " ", 
         RowBox[{"Jyz", ".", "Jzx"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Jxy", " ", "=", " ", 
         RowBox[{"Jxz", ".", "Jzy"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "transfpt", "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VXN", "[", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "VX", ",", "i"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"VX", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "NRV", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", 
              RowBox[{"RVPLOT", "[", 
               RowBox[{"[", "pos", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pos", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"VX", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "x1"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pos", "\[Equal]", "2"}], ",", 
                RowBox[{
                 RowBox[{"VX", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "x2"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"pos", " ", "=", " ", "2"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"VX", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
               RowBox[{"TransformationPoint", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "VX", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VYN", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y1_", ",", "y2_"}], "}"}], ",", "lsn_"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "VY", ",", "i"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"VY", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "NRV", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", 
              RowBox[{"RVPLOT", "[", 
               RowBox[{"[", "pos", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pos", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"VY", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "y1"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pos", "\[Equal]", "2"}], ",", 
                RowBox[{
                 RowBox[{"VY", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "y2"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"pos", " ", "=", " ", "2"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"VY", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
               RowBox[{"DPY", "[", 
                RowBox[{"[", 
                 RowBox[{"lsn", ",", "i"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "VY", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SetXDistributionPlotRange", ",", "sdlim"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetXDistributionPlotRange", "[", "sdlim_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "XDPR"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"k", ",", "XDPR"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sdlim", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"XDPR", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"D2PMIN", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"D2PMAX", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"XDPR", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"D2MEAN", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "-", " ", 
                 RowBox[{"sdlim", " ", 
                  RowBox[{"D2SDEV", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", "\t\t    ", 
                RowBox[{
                 RowBox[{"D2MEAN", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "+", " ", 
                 RowBox[{"sdlim", " ", 
                  RowBox[{"D2SDEV", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "XDPR", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SetYDistributionPlotRange", ",", "sdlim"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetYDistributionPlotRange", "[", "sdlim_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "YDPR"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"k", ",", "YDPR"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"YDPR", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "sdlim"}], ",", "sdlim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "YDPR", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.397836041296875*^9, 3.397836065515625*^9}, {
   3.40033631825*^9, 3.400336321421875*^9}, {3.4003363664375*^9, 
   3.40033645603125*^9}, {3.400336496328125*^9, 3.400336501140625*^9}, {
   3.400352802375*^9, 3.40035290653125*^9}, {3.40048759015625*^9, 
   3.400487600375*^9}, 3.400487892796875*^9, {3.40051177015625*^9, 
   3.400511809453125*^9}, {3.40051213403125*^9, 3.400512181*^9}, {
   3.400512211453125*^9, 3.40051222890625*^9}, {3.40051225909375*^9, 
   3.400512267015625*^9}, {3.400512337796875*^9, 3.400512368765625*^9}, {
   3.40051248378125*^9, 3.400512485375*^9}, {3.400512567703125*^9, 
   3.400512637578125*^9}, {3.400512701796875*^9, 3.4005127296875*^9}, {
   3.40051277665625*^9, 3.400512866359375*^9}, {3.4005129005*^9, 
   3.4005129006875*^9}, {3.400522554515625*^9, 3.4005225730625*^9}, {
   3.4005226125625*^9, 3.40052261353125*^9}, {3.40052268515625*^9, 
   3.400522760375*^9}, {3.400600678484375*^9, 3.400600691390625*^9}, {
   3.400600876421875*^9, 3.400600888*^9}, {3.40060099003125*^9, 
   3.40060111625*^9}, {3.400601156875*^9, 3.400601354421875*^9}, {
   3.4006014184375*^9, 3.400601461203125*^9}, 3.400601571359375*^9, {
   3.400602356375*^9, 3.400602359703125*^9}, {3.40060276290625*^9, 
   3.400602944609375*^9}, {3.400602975*^9, 3.400603011859375*^9}, {
   3.400603102796875*^9, 3.40060315565625*^9}, {3.400603616703125*^9, 
   3.4006036725625*^9}},
 CellLabel->"In[58]:="],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"fx1x2", ",", "x1", ",", "x2"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fx1x2", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fx", ",", "z1", ",", "z2", ",", "f1", ",", "f2"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"fx", ",", "z1", ",", "z2", ",", "f1", ",", "f2"}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RX", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"RVPLOT", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "\[Equal]", 
          "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fx", " ", "=", " ", 
           RowBox[{
            RowBox[{"StPDF", "[", 
             RowBox[{
              RowBox[{"RVX", "[", 
               RowBox[{"[", 
                RowBox[{"RVPLOT", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", "x1"}], 
             "]"}], "*", 
            RowBox[{"StPDF", "[", 
             RowBox[{
              RowBox[{"RVX", "[", 
               RowBox[{"[", 
                RowBox[{"RVPLOT", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "x2"}], 
             "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
           "GAUSSIAN", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fx", " ", "=", " ", 
              RowBox[{"fi2D", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"x1", "-", 
                  RowBox[{"D2MEAN", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], 
                 RowBox[{"D2SDEV", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]], ",", 
                FractionBox[
                 RowBox[{"x2", "-", 
                  RowBox[{"D2MEAN", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], 
                 RowBox[{"D2SDEV", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]], ",", 
                RowBox[{"RX", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
              ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"z1", " ", "=", " ", 
              RowBox[{"INVFIE", "[", 
               RowBox[{"StCDF", "[", 
                RowBox[{
                 RowBox[{"RVX", "[", 
                  RowBox[{"[", 
                   RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", "x1"}],
                 "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"z2", " ", "=", " ", 
              RowBox[{"INVFIE", "[", 
               RowBox[{"StCDF", "[", 
                RowBox[{
                 RowBox[{"RVX", "[", 
                  RowBox[{"[", 
                   RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "x2"}],
                 "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"f1", " ", "=", " ", 
              RowBox[{"StPDF", "[", 
               RowBox[{
                RowBox[{"RVX", "[", 
                 RowBox[{"[", 
                  RowBox[{"RVPLOT", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", "x1"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"f2", " ", "=", " ", 
              RowBox[{"StPDF", "[", 
               RowBox[{
                RowBox[{"RVX", "[", 
                 RowBox[{"[", 
                  RowBox[{"RVPLOT", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "x2"}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"fx", "=", 
              RowBox[{
               RowBox[{"fi2D", "[", 
                RowBox[{"z1", ",", "z2", ",", 
                 RowBox[{"RX", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
               "*", 
               FractionBox[
                RowBox[{"f1", "*", "f2"}], 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"fi", "[", "z1", "]"}], "*", 
                   RowBox[{"fi", "[", "z2", "]"}]}], ",", "UUF"}], "]"}]]}]}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "fx", "]"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.400404347921875*^9, 3.400404619203125*^9}, 
   3.40040465875*^9, {3.400404692640625*^9, 3.40040476490625*^9}, {
   3.400405067125*^9, 3.400405087828125*^9}, 3.4004878889375*^9, {
   3.400495563828125*^9, 3.400495625375*^9}, {3.403533205296875*^9, 
   3.40353327284375*^9}},
 CellLabel->"In[67]:="],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "JPDFCONTPLOT", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JPDFCONTPLOT", "[", "np_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"min", ",", "modecoord"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{
         "fx1x2contplot1", ",", "fx1x2contplot2", ",", "FX1X2MODE", ",", 
          "min", ",", "modecoord"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"GAUSSIAN", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"modecoord", " ", "=", " ", "D2MEAN"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"FX1X2MODE", " ", "=", " ", 
            RowBox[{"fx1x2", "[", "D2MEAN", "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"min", " ", "=", " ", 
            RowBox[{"FindMaximum", "[", 
             RowBox[{
              RowBox[{"fx1x2", "[", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"D2MEAN", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"XDPR", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"XDPR", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"D2MEAN", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"XDPR", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"XDPR", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PrecisionGoal", "\[Rule]", "5"}], ",", 
              RowBox[{"AccuracyGoal", "\[Rule]", "5"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"FX1X2MODE", "=", " ", 
            RowBox[{"min", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"modecoord", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"min", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"min", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"mxlegplot", " ", "=", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"StyleForm", "[", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(X\)]\)\>\"", ",", " ", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", "D2MEAN", 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mxdotplot", " ", "=", " ", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "  ", 
           RowBox[{
            RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
            RowBox[{"Point", "[", "D2MEAN", "]"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"modedotplot", " ", "=", " ", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "  ", 
           RowBox[{
            RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
            RowBox[{"Point", "[", "modecoord", "]"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"fx1x2contplot1", "=", 
         RowBox[{"ContourPlot", "[", 
          RowBox[{
           RowBox[{"fx1x2", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"XDPR", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"XDPR", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"XDPR", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"XDPR", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "np"}], ",", 
           RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
           RowBox[{"Contours", "\[Rule]", 
            RowBox[{"FX1X2MODE", "*", "levelcurves"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"fx1x2contplot2", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{
          "fx1x2contplot1", ",", "mxlegplot", ",", "mxdotplot", ",", 
           "modedotplot", ",", "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", " ", "XDPR"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"StyleForm", "[", 
               RowBox[{
                RowBox[{"D2NAME", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"StyleForm", "[", 
               RowBox[{
                RowBox[{"D2NAME", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", " ", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "fx1x2contplot2", "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.397835924875*^9, {3.397837688640625*^9, 3.39783769046875*^9}, 
   3.400336954390625*^9, {3.400336994171875*^9, 3.400336997828125*^9}, {
   3.400337032390625*^9, 3.400337104953125*^9}, {3.4003371861875*^9, 
   3.400337186640625*^9}, 3.400337248421875*^9, {3.400337356828125*^9, 
   3.40033736059375*^9}, {3.40033742490625*^9, 3.40033746565625*^9}, {
   3.400337566640625*^9, 3.400337576515625*^9}, {3.40033769678125*^9, 
   3.40033772415625*^9}, {3.400337758359375*^9, 3.4003379035*^9}, {
   3.40033803975*^9, 3.400338077203125*^9}, 3.400343395875*^9, {
   3.40034343721875*^9, 3.4003434435*^9}, {3.4003435036875*^9, 
   3.400343547734375*^9}, {3.400343583015625*^9, 3.40034362546875*^9}, 
   3.40034449253125*^9, {3.400347748171875*^9, 3.400347773265625*^9}, {
   3.40035313440625*^9, 3.400353189484375*^9}, {3.400353231296875*^9, 
   3.400353231625*^9}, {3.400405903703125*^9, 3.40040598228125*^9}, {
   3.40040603121875*^9, 3.40040603784375*^9}, {3.400406154640625*^9, 
   3.400406236875*^9}, {3.400406321390625*^9, 3.40040639178125*^9}, {
   3.40040648534375*^9, 3.400406543296875*^9}, {3.400406731046875*^9, 
   3.40040675990625*^9}, {3.400407920375*^9, 3.400407925328125*^9}, 
   3.40041334040625*^9, {3.40050768490625*^9, 3.400507770109375*^9}, {
   3.400526407109375*^9, 3.400526451296875*^9}, {3.4601979792239885`*^9, 
   3.4601979856606236`*^9}, {3.4601980483240757`*^9, 3.460198060494314*^9}, 
   3.4601983601868863`*^9, {3.4601987358214893`*^9, 3.460198757568427*^9}, {
   3.4601988563670144`*^9, 3.46019885785118*^9}},
 CellLabel->"In[69]:="],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SetLSPlotRange", ",", "sdlim", ",", "LSPLOT", ",", "np"}], "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetLSPlotRange", "[", "sdlim_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"XLSPR", ",", "YLSPR"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"XLSPR", ",", "YLSPR"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"DPX", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"DPGET", "[", 
            RowBox[{
             RowBox[{"DesignPoint", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", "\"\<DPX\>\"", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"DPY", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"DPGET", "[", 
            RowBox[{
             RowBox[{"DesignPoint", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", "\"\<DPY\>\"", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"D2DPX", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DPX", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", 
                RowBox[{"RVPLOT", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"DPX", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", 
                RowBox[{"RVPLOT", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D2DPY", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DPY", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", 
                RowBox[{"RVPLOT", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"DPY", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", 
                RowBox[{"RVPLOT", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XLSPR", " ", "=", " ", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "D2DPX", "]"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "-", " ", 
                RowBox[{"sdlim", " ", 
                 RowBox[{"D2SDEV", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}]}], ",", 
               RowBox[{"XDPR", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "D2DPX", "]"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "+", " ", 
                RowBox[{"sdlim", " ", 
                 RowBox[{"D2SDEV", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}]}], ",", 
               RowBox[{"XDPR", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"YLSPR", " ", "=", " ", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "D2DPY", "]"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "-", " ", "sdlim"}], ",", 
               RowBox[{"YDPR", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "D2DPY", "]"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "+", " ", "sdlim"}], ",", 
               RowBox[{"YDPR", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"XLSPR", ",", "YLSPR"}], "}"}], "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LSPLOT", "[", "np_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lsxplot", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "NLS", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lsyplot", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "NLS", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"foyplot", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "NLS", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"TransformationPoint", " ", "=", " ", 
           RowBox[{"SetTransformationPoint", "[", 
            RowBox[{"RVX", ",", 
             RowBox[{"DPX", "[", 
              RowBox[{"[", "lsn", "]"}], "]"}]}], "]"}]}], ";", "\n", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GY", "[", "fy", "]"}], "=", 
           RowBox[{
            RowBox[{"GX", "[", 
             RowBox[{
              RowBox[{"Jxy", ".", "vy"}], "+", "Mneq"}], "]"}], "[", 
            RowBox[{"[", "lsn", "]"}], "]"}]}], ";", "\n", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GX1X2", "[", 
            RowBox[{"{", 
             RowBox[{"x1_", ",", "x2_"}], "}"}], "]"}], "=", 
           RowBox[{
            RowBox[{"GX", "[", 
             RowBox[{"VXN", "[", 
              RowBox[{"{", 
               RowBox[{"x1", ",", "x2"}], "}"}], "]"}], "]"}], "[", 
            RowBox[{"[", "lsn", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GY1Y2", "[", 
            RowBox[{"{", 
             RowBox[{"x1_", ",", "x2_"}], "}"}], "]"}], "=", 
           RowBox[{"GY", "[", 
            RowBox[{"VYN", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1", ",", "x2"}], "}"}], ",", "lsn"}], "]"}], "]"}]}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lsxplot", "[", 
            RowBox[{"[", "lsn", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"ContourPlot", "[", 
            RowBox[{
             RowBox[{"GX1X2", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"XLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"XLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"XLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"XLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotPoints", "\[Rule]", "np"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Contours", "\[Rule]", 
              RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lsyplot", "[", 
            RowBox[{"[", "lsn", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"ContourPlot", "[", 
            RowBox[{
             RowBox[{"GY1Y2", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"YLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"YLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"YLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"YLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotPoints", "\[Rule]", "np"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Contours", "\[Rule]", 
              RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"DisplayFunction", "\[Rule]", " ", "Identity"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ALFA", " ", "=", " ", 
           RowBox[{"DPGET", "[", 
            RowBox[{
             RowBox[{"DesignPoint", "[", 
              RowBox[{"[", "lsn", "]"}], "]"}], ",", 
             RowBox[{"{", "\"\<ALFA\>\"", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"BETA", " ", "=", " ", 
           RowBox[{"DPGET", "[", 
            RowBox[{
             RowBox[{"DesignPoint", "[", 
              RowBox[{"[", "lsn", "]"}], "]"}], ",", 
             RowBox[{"{", "\"\<BETA\>\"", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GYFO", "[", "fx", "]"}], "=", 
           RowBox[{"BETA", " ", "+", " ", 
            RowBox[{"ALFA", ".", "vx"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GYFO2D", "[", 
            RowBox[{"{", 
             RowBox[{"x1_", ",", "x2_"}], "}"}], "]"}], " ", "=", " ", 
           RowBox[{"GYFO", "[", 
            RowBox[{"VYN", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1", ",", "x2"}], "}"}], ",", "lsn"}], "]"}], "]"}]}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"foyplot", "[", 
            RowBox[{"[", "lsn", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"ContourPlot", "[", 
            RowBox[{
             RowBox[{"GYFO2D", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"YLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"YLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"YLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"YLSPR", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ContourStyle", "\[Rule]", 
              RowBox[{"{", " ", 
               RowBox[{"Dashing", "[", 
                RowBox[{"{", 
                 RowBox[{"0.02", ",", "0.02"}], "}"}], "]"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Contours", "\[Rule]", 
              RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ContourShading", "\[Rule]", "None"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"lsn", ",", "1", ",", "NLS"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.400507795625*^9, {3.400512972734375*^9, 3.400513028359375*^9}, {
   3.400602386796875*^9, 3.400602414546875*^9}, 3.400602544921875*^9, {
   3.400602749015625*^9, 3.400602751875*^9}, {3.402247719515625*^9, 
   3.4022477426875*^9}, {3.4601991110967684`*^9, 3.460199132234417*^9}},
 CellLabel->"In[71]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DESIGNPOINTPLOT", "[", "np_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dpxlegplot", " ", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"dpxleg", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
                 RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
               RowBox[{"D2DPX", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "NLS"}], "}"}]}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"dpylegplot", " ", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"dpyleg", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
                 RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
               RowBox[{"D2DPY", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "NLS"}], "}"}]}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"dpxdotplot", " ", "=", " ", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"D2DPX", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"AbsolutePointSize", "[", "5", "]"}], "}"}]}], ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"dpydotplot", " ", "=", " ", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"D2DPY", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"AbsolutePointSize", "[", "5", "]"}], "}"}]}], ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"LSXPLOT", " ", "=", " ", 
          RowBox[{"Show", "[", 
           RowBox[{
           "lsxplot", ",", "dpxlegplot", ",", "dpxdotplot", ",", 
            "fx1x2contplot1", ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "XLSPR"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", "D2NAME"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(X\)]\)\>\"", ",", " ", 
                    RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "]"}], 
                 ",", "D2MEAN", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"Graphics", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
                    RowBox[{"Point", "[", "D2MEAN", "]"}]}], "}"}], "]"}], 
                 ",", "D2MEAN"}], "]"}]}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"mylegplot", " ", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(Y\)]\)\>\"", ",", " ", 
               RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"mydotplot", " ", "=", " ", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"fy1y2contplot", "=", 
          RowBox[{"ContourPlot", "[", 
           RowBox[{
            RowBox[{"fi2D", "[", 
             RowBox[{"x", ",", "y", ",", "0"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"YDPR", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"YDPR", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"YDPR", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"YDPR", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotPoints", "\[Rule]", "np"}], ",", 
            RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Contours", "\[Rule]", 
             RowBox[{
              RowBox[{"fi2D", "[", 
               RowBox[{"0", ",", "0", ",", "0"}], "]"}], "*", 
              "levelcurves"}]}]}], "]"}]}], ";", "\n", "\t", 
         "\[IndentingNewLine]", 
         RowBox[{"LSYPLOT", " ", "=", " ", 
          RowBox[{"Show", "[", 
           RowBox[{
           "lsyplot", ",", "dpylegplot", ",", "dpydotplot", ",", "mylegplot", 
            ",", "fy1y2contplot", ",", "mydotplot", ",", "foyplot", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "YLSPR"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", "D2NAMEY"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Show", "[", 
           RowBox[{"GraphicsRow", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LSXPLOT", ",", "LSYPLOT"}], "}"}], ",", 
             RowBox[{"Spacings", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Scaled", "[", "0.1", "]"}], ",", "0.0"}], "}"}]}]}], 
            "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.397835870765625*^9, 3.397835908953125*^9}, {
   3.39783595975*^9, 3.3978359603125*^9}, {3.400344802578125*^9, 
   3.400344842578125*^9}, {3.400344900546875*^9, 3.400344907109375*^9}, {
   3.400344964671875*^9, 3.400344970953125*^9}, {3.40034500803125*^9, 
   3.400345045859375*^9}, 3.40035274053125*^9, {3.400413702546875*^9, 
   3.40041372421875*^9}, {3.400414139640625*^9, 3.40041414578125*^9}},
 CellLabel->"In[74]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. DESIGN POINT SEARCH MODULES", "Title"],

Cell[CellGroupData[{

Cell["DESIGN POINT OBJECT MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"DPCREATE", ",", "DPPUT", ",", "DPGET"}], "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DPCREATE", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"(", 
       RowBox[{"Return", "[", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "8", "}"}]}], "]"}], "]"}], ")"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DPPUT", "[", 
     RowBox[{"dp_", ",", "input_", ",", "put_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nput", ",", "rvt"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"nrvi", ",", "nput", ",", "rvt"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nput", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "put", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nput", "\[NotEqual]", " ", 
           RowBox[{
            RowBox[{"Dimensions", "[", "input", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Conflicting vector sizes, DPPUT!\>\"", "]"}], 
           ";", " ", 
           RowBox[{"Return", "[", "0", "]"}]}]}], "]"}], ";", "\n", "\t", 
        "\[IndentingNewLine]", 
        RowBox[{"dpt", " ", "=", " ", "dp"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<DPX\>\""}], 
             "      ", ",", 
             RowBox[{
              RowBox[{"dpt", "[", 
               RowBox[{"[", " ", "1", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<DPY\>\""}], 
             "      ", ",", 
             RowBox[{
              RowBox[{"dpt", "[", 
               RowBox[{"[", "  ", "2", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<ALFA\>\""}], 
             "    ", ",", 
             RowBox[{
              RowBox[{"dpt", "[", 
               RowBox[{"[", "  ", "3", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<GRADY\>\""}], 
             " ", ",", 
             RowBox[{
              RowBox[{"dpt", "[", 
               RowBox[{"[", "  ", "4", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<GOFX\>\""}], 
             "    ", ",", 
             RowBox[{
              RowBox[{"dpt", "[", 
               RowBox[{"[", "  ", "5", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<BETA\>\""}], 
             "    ", ",", 
             RowBox[{
              RowBox[{"dpt", "[", 
               RowBox[{"[", "  ", "6", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<FORMPF\>\""}],
              ",", 
             RowBox[{
              RowBox[{"dpt", "[", 
               RowBox[{"[", "  ", "7", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<SORMPF\>\""}],
              ",", 
             RowBox[{
              RowBox[{"dpt", "[", 
               RowBox[{"[", "  ", "8", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nput"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "dpt", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DPGET", "[", 
     RowBox[{"dp_", ",", "get_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ndpi", ",", "nget", ",", "dpt", ",", "out"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"nget", ",", "dpt", ",", "out"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nget", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "get", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"out", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nget", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<DPX\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"dp", "[", 
               RowBox[{"[", "  ", "1", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<DPY\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"dp", "[", 
               RowBox[{"[", "  ", "2", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<ALFA\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"dp", "[", 
               RowBox[{"[", "  ", "3", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<GRADY\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"dp", "[", 
               RowBox[{"[", "  ", "4", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<GOFX\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"dp", "[", 
               RowBox[{"[", "  ", "5", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<BETA\>\""}], 
             ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"dp", "[", 
               RowBox[{"[", "  ", "6", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<FORMPF\>\""}],
              ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"dp", "[", 
               RowBox[{"[", " ", "7", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"get", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<SORMPF\>\""}],
              ",", 
             RowBox[{
              RowBox[{"out", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"dp", "[", 
               RowBox[{"[", "  ", "8", "]"}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nget"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nget", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"out", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}], 
          "\[IndentingNewLine]", "\t", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Return", "[", "out", "]"}]}], "\[IndentingNewLine]", "]"}],
         ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DesignPointPrint", "[", "dp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sorm", ",", "borm"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sorm", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"borm", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sorm", " ", "=", " ", 
        RowBox[{"DPGET", "[", 
         RowBox[{"dp", ",", 
          RowBox[{"{", "\"\<SORMPF\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"sorm", "\[NotEqual]", "0"}], ",", 
         RowBox[{"borm", " ", "=", " ", 
          RowBox[{"-", 
           RowBox[{"INVFIE", "[", "sorm", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<        Design Point = \>\"", ",", 
         RowBox[{"DPGET", "[", 
          RowBox[{"dp", ",", 
           RowBox[{"{", "\"\<DPX\>\"", "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<   Sensitivity at DP = \>\"", ",", 
         RowBox[{"DPGET", "[", 
          RowBox[{"dp", ",", 
           RowBox[{"{", "\"\<ALFA\>\"", "}"}]}], "]"}]}], "]"}], ";", "\n", 
       "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<      FORM {Beta,Pf} = \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DPGET", "[", 
            RowBox[{"dp", ",", 
             RowBox[{"{", "\"\<BETA\>\"", "}"}]}], "]"}], ",", 
           RowBox[{"ScientificForm", "[", 
            RowBox[{"DPGET", "[", 
             RowBox[{"dp", ",", 
              RowBox[{"{", "\"\<FORMPF\>\"", "}"}]}], "]"}], "]"}]}], "}"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<      SORM {Beta,Pf} = \>\"", ",", 
         RowBox[{"{", 
          RowBox[{"borm", ",", 
           RowBox[{"ScientificForm", "[", "sorm", "]"}]}], "}"}]}], "]"}], 
       ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[75]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["FORM TRANSFORMATION MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "JacobYZ", ",", "JacobXZ", ",", "JacobXY", ",", "xi", ",", "Jyz", ",", 
     "Jzy", ",", "Jzx", ",", "Jxz", ",", "Jxy", ",", "Jyx", ",", "RV"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JacobYZ", "[", "cx_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L", ",", "correlated", ",", "Jyz", ",", "Jzy"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"L", ",", "correlated", ",", "Jyz", ",", "Jzy"}], "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Det", "[", "cx", "]"}], "\[Equal]", " ", "1"}], ",", 
          RowBox[{"correlated", " ", "=", "False"}], ",", 
          RowBox[{"correlated", " ", "=", " ", "True"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"correlated", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"L", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"CholeskyDecomposition", "[", "cx", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Jyz", "=", 
            RowBox[{"Inverse", "[", "L", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Jzy", "=", "L"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L", ".", 
                  RowBox[{"Transpose", "[", "L", "]"}]}], ")"}], "-", "cx"}], 
               "]"}], "\[NotEqual]", " ", "0"}], ",", 
             RowBox[{
             "Print", "[", "\"\<Attention, Cholesky decomposition failed\>\"",
               "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Jyz", "=", 
            RowBox[{"IdentityMatrix", "[", "NRV", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Jzy", "=", 
            RowBox[{"IdentityMatrix", "[", "NRV", "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"Jyz", ",", "Jzy"}], "}"}], "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JacobXZ", "[", 
     RowBox[{"RV_", ",", "xi_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "NRV", ",", "zi", ",", "GAUSSIAN", ",", "Jzx", ",", "Jxz", ",", "type",
         ",", "mean", ",", "sdev", ",", "par1", ",", "par2"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{
         "NRV", ",", "zi", ",", "GAUSSIAN", ",", "Jzx", ",", "Jxz", ",", 
          "type", ",", "mean", ",", "sdev", ",", "par1", ",", "par2"}], "]"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"NRV", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "RV", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"type", " ", "=", " ", 
         RowBox[{"RVGET", "[", 
          RowBox[{"RV", ",", 
           RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mean", "=", 
         RowBox[{"RVGET", "[", 
          RowBox[{"RV", ",", 
           RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sdev", "=", 
         RowBox[{"RVGET", "[", 
          RowBox[{"RV", ",", 
           RowBox[{"{", "\"\<SDEV\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"par1", "=", 
         RowBox[{"RVGET", "[", 
          RowBox[{"RV", ",", 
           RowBox[{"{", "\"\<PAR1\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"par2", "=", 
         RowBox[{"RVGET", "[", 
          RowBox[{"RV", ",", 
           RowBox[{"{", "\"\<PAR2\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"GAUSSIAN", " ", "=", " ", "True"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"type", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", " ", 
              "\"\<NORMAL\>\""}], "&&", 
             RowBox[{
              RowBox[{"type", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", " ", 
              "\"\<DETERM\>\""}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"GAUSSIAN", " ", "=", " ", "False"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Mneq", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "NRV", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Dneq", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "NRV", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"GAUSSIAN", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Mneq", " ", "=", " ", "mean"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Jzx", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{"1", "/", "sdev"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Jxz", "=", 
            RowBox[{"DiagonalMatrix", "[", "sdev", "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"type", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "==", "\"\<DETERM\>\""}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dneq", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", " ", 
                 RowBox[{
                  RowBox[{"Mneq", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=", 
                  RowBox[{"mean", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "==", "\"\<NORMAL\>\""}], 
                   ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Dneq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{"sdev", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
                    RowBox[{
                    RowBox[{"Mneq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{"mean", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"type", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "==", 
                    "\"\<LOGNORMAL\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Dneq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"par2", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"Mneq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Log", "[", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"par1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ";"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"zi", "=", 
                    RowBox[{"INVFIE", "[", 
                    RowBox[{"StCDF", "[", 
                    RowBox[{
                    RowBox[{"RV", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dneq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
                    FractionBox[
                    RowBox[{"fi", "[", "zi", "]"}], 
                    RowBox[{"StPDF", "[", 
                    RowBox[{
                    RowBox[{"RV", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Mneq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"xi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{"zi", "*", 
                    RowBox[{"Dneq", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Jzx", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{"1", "/", "Dneq"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Jxz", "=", 
            RowBox[{"DiagonalMatrix", "[", "Dneq", "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"Jxz", ",", "Jzx"}], "}"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JacobXY", "[", 
    RowBox[{"RV_", ",", "cx_", ",", "xi_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Jyz", ",", "Jzy", ",", "Jzx", ",", "Jxz", ",", "Jxy", ",", "Jyx"}], 
      "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "Jyz", ",", "Jzy", ",", "Jzx", ",", "Jxz", ",", "Jxy", ",", "Jyx"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Jyz", ",", "Jzy"}], "}"}], " ", "=", " ", 
        RowBox[{"JacobYZ", "[", "cx", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Jxz", ",", "Jzx"}], "}"}], " ", "=", " ", 
        RowBox[{"JacobXZ", "[", 
         RowBox[{"RV", ",", "xi"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Jyx", " ", "=", " ", 
        RowBox[{"Jyz", ".", "Jzx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Jxy", " ", "=", " ", 
        RowBox[{"Jxz", ".", "Jzy"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"Jxy", ",", "Jyx"}], "}"}], "]"}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.397836176828125*^9, 3.39783618984375*^9}},
 CellLabel->"In[80]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PENALIZEXHALF", "[", 
    RowBox[{"x1_", ",", "x2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xpen", "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", "xpen", "]"}], ";", " ", 
       RowBox[{"xpen", " ", "=", " ", "x2"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xpen", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"XMAX", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"xpen", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"x1", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "2"}]}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xpen", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", "  ", 
            RowBox[{"XMIN", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"xpen", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"x1", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "2"}]}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "xpen", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.40048761721875*^9, 3.400487695953125*^9},
 CellLabel->"In[84]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PENALIZEXLIMIT", "[", 
    RowBox[{"x1_", ",", "x2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xpen", "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", "xpen", "]"}], ";", " ", 
       RowBox[{"xpen", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "NRV", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xpen", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"x2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"XMIN", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", "0.001"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xpen", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"x2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"XMAX", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "0.001"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "xpen", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.4004876181875*^9, 3.4004876944375*^9},
 CellLabel->"In[85]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["CONVERGENCE CRITERIA", "Section"],

Cell[CellGroupData[{

Cell["Vector of convergence criteria:", "Subsection"],

Cell[CellGroupData[{

Cell["\<\
CONVCRIT = { Maximum number of iterations, Convergence criteria option, \
convergence tolerance, limit state tolerance,limit state near tolerance};

Convergence criteria options:

\tDELTA_BETA \t-  Variation in BETA
\tDELTA_Y\t- Variation in Y
\tORTOGONAL\t- Ortogonality of Y* with limit state function\
\>", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "CONVERGENCECHECK", ",", "crit", ",", "y1", ",", "y2", ",", "grady", ",", 
     "gx"}], "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CONVERGENCECHECK", "[", 
    RowBox[{"crit_", ",", "y1_", ",", "y2_", ",", "grady_", ",", "gx_"}], 
    "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "conv", "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"crit", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<DELTA_BETA\>\""}],
          ",", 
         RowBox[{"conv", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"y1", ".", "y1"}], "]"}], "-", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"y2", ".", "y2"}], "]"}]}], "]"}]}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"crit", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<DELTA_Y\>\""}], 
         "     ", ",", 
         RowBox[{"conv", " ", "=", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y2", "-", "y1"}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{"y2", "-", "y1"}], ")"}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"crit", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<ORTOGONAL\>\""}], 
         ",", 
         RowBox[{"conv", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gy", ".", "gy"}], " ", ")"}], 
            RowBox[{"(", 
             RowBox[{"y2", ".", "y2"}], ")"}]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"gy", ".", "y2"}], ")"}], "2"]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"conv", "\[LessEqual]", " ", 
           RowBox[{"crit", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "gx", "]"}], "\[LessEqual]", " ", 
           RowBox[{"crit", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Return", "[", "True", "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{"Return", "[", "False", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.513332894129737*^9, 3.513332897936283*^9}},
 CellLabel->"In[86]:="]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FIND DESIGN POINT  MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"FindDesignPoint", ",", "lsn"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindDesignPoint", "[", "lsn_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", "y", ",", "g", ",", "gradx", ",", "grady", ",", "vbeta", ",", 
       "k", ",", "CONVERGENCE", ",", "NmaxIT", ",", "alfa", ",", "fopf", ",", 
       "NegativeBeta"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "x", ",", "y", ",", "g", ",", "gradx", ",", "grady", ",", "vbeta", 
         ",", "k", ",", "CONVERGENCE", ",", "NmaxIT", ",", "alfa", ",", 
         "fopf", ",", "NegativeBeta"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"NmaxIT", " ", "=", " ", 
        RowBox[{"ConvergenceCrit", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", " ", 
           RowBox[{"NmaxIT", "+", "1"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"y", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", " ", 
           RowBox[{"NmaxIT", "+", "1"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"g", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", " ", 
           RowBox[{"NmaxIT", "+", "1"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"gradx", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", " ", "NmaxIT", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"grady", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", " ", "NmaxIT", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"vbeta", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", " ", 
           RowBox[{"NmaxIT", "+", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "MEAN"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"GAUSSIAN", "\[Equal]", "False"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Jxz", ",", "Jzx"}], "}"}], " ", "=", " ", 
           RowBox[{"JacobXZ", "[", 
            RowBox[{"RVX", ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Jyx", " ", "=", " ", 
           RowBox[{"Jyz", ".", "Jzx"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Jxy", " ", "=", " ", 
           RowBox[{"Jxz", ".", "Jzy"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"Jyx", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "Mneq"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"GX", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "lsn", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{"NegativeBeta", " ", "=", " ", "True"}], ",", 
         RowBox[{"NegativeBeta", " ", "=", " ", "False"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ConvergenceCrit", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"ConvergenceCrit", "[", 
           RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", 
           RowBox[{"ConvergenceCrit", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CONVERGENCE", " ", "=", " ", "False"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"CONVERGENCE", "\[Equal]", "False"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"k", "<", " ", "NmaxIT"}], ")"}]}], ")"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gradx", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"GRADX", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "lsn", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"grady", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Transpose", "[", "Jxy", "]"}], ".", 
            RowBox[{"gradx", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TYPE", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", " ", 
               "\"\<DETERM\>\""}], ",", 
              RowBox[{
               RowBox[{"grady", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "0"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            FractionBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"grady", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ".", 
                RowBox[{"y", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "-", 
               RowBox[{"g", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ")"}], 
             RowBox[{
              RowBox[{"grady", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ".", 
              RowBox[{"grady", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}]], 
            RowBox[{"grady", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Jxy", ".", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}]}], "+", "Mneq"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"GAUSSIAN", "\[Equal]", "False"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"k", "+", "1"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"PENALIZEXHALF", "[", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", 
                RowBox[{"x", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Jxz", ",", "Jzx"}], "}"}], " ", "=", " ", 
              RowBox[{"JacobXZ", "[", 
               RowBox[{"RVX", ",", 
                RowBox[{"x", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Jyx", " ", "=", " ", 
              RowBox[{"Jyz", ".", "Jzx"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Jxy", " ", "=", " ", 
              RowBox[{"Jxz", ".", "Jzy"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", 
                RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
              RowBox[{"Jyx", ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", "+", "1"}], "]"}], "]"}], "-", "Mneq"}], 
                ")"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"GX", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "lsn", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"vbeta", "[", 
            RowBox[{"[", 
             RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
           SqrtBox[
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], ".", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}]}]]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"CONVERGENCE", "=", 
           RowBox[{"CONVERGENCECHECK", "[", 
            RowBox[{"ConvergenceCrit", ",", 
             RowBox[{"y", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{"grady", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"g", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"k", " ", "=", " ", 
           RowBox[{"k", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"alfa", " ", "=", 
        RowBox[{
         RowBox[{"(", " ", 
          FractionBox[
           RowBox[{"grady", "[", 
            RowBox[{"[", 
             RowBox[{"k", "-", "1"}], "]"}], "]"}], 
           SqrtBox[
            RowBox[{
             RowBox[{"grady", "[", 
              RowBox[{"[", 
               RowBox[{"k", "-", "1"}], "]"}], "]"}], ".", 
             RowBox[{"grady", "[", 
              RowBox[{"[", 
               RowBox[{"k", "-", "1"}], "]"}], "]"}]}]]], ")"}], "^", "2"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"beta", " ", "=", " ", 
        RowBox[{"vbeta", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fopf", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"NegativeBeta", ",", 
          RowBox[{"FIE", "[", "beta", "]"}], ",", 
          RowBox[{"FIE", "[", 
           RowBox[{"-", "beta"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xh", "[", 
         RowBox[{"[", "lsn", "]"}], "]"}], " ", "=", " ", 
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "k"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"yh", "[", 
         RowBox[{"[", "lsn", "]"}], "]"}], " ", "=", " ", 
        RowBox[{"y", "[", 
         RowBox[{"[", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "k"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DesignPoint", "[", 
         RowBox[{"[", "lsn", "]"}], "]"}], " ", "=", " ", 
        RowBox[{"DPPUT", "[", 
         RowBox[{
          RowBox[{"DesignPoint", "[", 
           RowBox[{"[", "lsn", "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"y", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", "alfa", ",", 
            RowBox[{"grady", "[", 
             RowBox[{"[", 
              RowBox[{"k", "-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"g", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", "beta", ",", "fopf"}], 
           "}"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{
           "\"\<DPX\>\"", ",", "\"\<DPY\>\"", ",", "\"\<ALFA\>\"", ",", 
            "\"\<GRADY\>\"", ",", "\"\<GOFX\>\"", ",", "\"\<BETA\>\"", ",", 
            "\"\<FORMPF\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"PRINT", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Limit state number = \>\"", ",", "lsn"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"aleg", " ", "=", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Append", "[", 
             RowBox[{"yleg", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<G(X)\>\"", ",", "\"\<BETA\>\""}], "}"}]}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vall", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"g", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"vbeta", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"vall", " ", "=", " ", 
           RowBox[{"Prepend", "[", 
            RowBox[{"vall", ",", "aleg"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"TableForm", "[", "vall", "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DesignPointPrint", "[", 
           RowBox[{"DesignPoint", "[", 
            RowBox[{"[", "lsn", "]"}], "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.402763736640625*^9, 3.402763866828125*^9}, {
  3.403533579375*^9, 3.403533587375*^9}},
 CellLabel->"In[88]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convergence plot  MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "ConvergencePlot", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvergencePlot", "[", "yhist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"convplot", ",", "np", ",", "yconvleg"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"convplot", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "NRV", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"np", " ", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "yhist", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"yconvleg", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"ToString", "[", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<Y``\>\"", ",", "i"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"convplot", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"yhist", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "np"}], "]"}], ",", "i"}], "]"}], "]"}], 
             ",", 
             RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ptleg", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"StyleForm", "[", 
              RowBox[{
               RowBox[{"yconvleg", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
               RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"np", ",", 
               RowBox[{"0.85", " ", 
                RowBox[{"yhist", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "k"}], "]"}], "]"}]}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1.0", ",", "0"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "NRV"}], "}"}]}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Show", "[", 
         RowBox[{"ptleg", ",", "convplot", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Iteration number\>\"", ",", "\"\<Y\>\""}], "}"}]}]}],
          "]"}], "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.397837999046875*^9, 3.39783800053125*^9}, {
  3.400343863796875*^9, 3.4003438689375*^9}, {3.400343909953125*^9, 
  3.40034393446875*^9}, {3.623576757194394*^9, 3.6235767585044203`*^9}, {
  3.623576798505549*^9, 3.6235768047657366`*^9}},
 CellLabel->"In[90]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"TRAJPLOT", ",", "lsn", ",", "delta", ",", "np"}], "]"}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FindPlotInterval", "[", 
      RowBox[{"allx_", ",", "delta_"}], "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xa", ",", "xb", ",", "de"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xa", " ", "=", " ", 
          RowBox[{"Min", "[", "allx", "]"}]}], ";", " ", 
         RowBox[{"xb", " ", "=", " ", 
          RowBox[{"Max", "[", "allx", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"de", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xb", "-", "xa"}], ")"}], "/", "delta"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"xa", "+", "de"}], ",", 
              RowBox[{"xa", "-", "de"}]}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"xb", "+", "de"}], ",", 
              RowBox[{"xb", "-", "de"}]}], "]"}]}], "}"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TRAJPLOT", "[", 
      RowBox[{"lsn_", ",", "np_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ndots", ",", "convleg", ",", "xdotplot", ",", "ydotplot", ",", 
         "xdotleg", ",", "ydotleg"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ndots", " ", "=", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{"xh", "[", 
             RowBox[{"[", "lsn", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"x2dh", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xh", "[", 
               RowBox[{"[", 
                RowBox[{"lsn", ",", "k", ",", 
                 RowBox[{"RVPLOT", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"xh", "[", 
               RowBox[{"[", 
                RowBox[{"lsn", ",", "k", ",", 
                 RowBox[{"RVPLOT", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "ndots"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"y2dh", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"yh", "[", 
               RowBox[{"[", 
                RowBox[{"lsn", ",", "k", ",", 
                 RowBox[{"RVPLOT", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"yh", "[", 
               RowBox[{"[", 
                RowBox[{"lsn", ",", "k", ",", 
                 RowBox[{"RVPLOT", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "ndots"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"convleg", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<``\>\"", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "ndots"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"xdotplot", " ", "=", " ", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"x2dh", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"AbsolutePointSize", "[", "4", "]"}], "}"}]}], ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], 
         ";", 
         RowBox[{"ydotplot", " ", "=", " ", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"y2dh", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"AbsolutePointSize", "[", "4", "]"}], "}"}]}], ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"xdotleg", " ", "=", " ", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"convleg", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
                 RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
               RowBox[{"x2dh", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "ndots"}], "}"}]}], "]"}], "]"}]}], 
         ";", 
         RowBox[{"ydotleg", " ", "=", " ", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"convleg", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
                 RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
               RowBox[{"y2dh", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "ndots"}], "}"}]}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"fy1y2contplot", "=", 
          RowBox[{"ContourPlot", "[", 
           RowBox[{
            RowBox[{"fi2D", "[", 
             RowBox[{"x", ",", "y", ",", "0"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"YDPR", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"YDPR", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"YDPR", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"YDPR", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotPoints", "\[Rule]", "np"}], ",", 
            RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
            RowBox[{"Contours", "\[Rule]", 
             RowBox[{
              RowBox[{"fi2D", "[", 
               RowBox[{"0", ",", "0", ",", "0"}], "]"}], "*", 
              "levelcurves"}]}]}], "]"}]}], ";", "\n", "\[IndentingNewLine]", 
         RowBox[{"XTRAJPLOT", " ", "=", " ", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"lsxplot", "[", 
             RowBox[{"[", "lsn", "]"}], "]"}], ",", "xdotplot", ",", 
            "xdotleg", ",", "fx1x2contplot1", ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "XLSPR"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", "D2NAME"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"YTRAJPLOT", " ", "=", " ", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"lsyplot", "[", 
             RowBox[{"[", "lsn", "]"}], "]"}], ",", "ydotplot", ",", 
            "ydotleg", ",", "fy1y2contplot", ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "YLSPR"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", "D2NAMEY"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Limit state convergence for design point \>\"", ",", "lsn", 
           ",", "\"\<:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Show", "[", 
           RowBox[{"GraphicsRow", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"XTRAJPLOT", ",", "YTRAJPLOT"}], "}"}], ",", 
             RowBox[{"Spacings", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Scaled", "[", "0.1", "]"}], ",", "0"}], "}"}]}]}], 
            "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.397836118265625*^9, 3.39783614909375*^9}, {
  3.397837467953125*^9, 3.39783746965625*^9}, {3.400344333640625*^9, 
  3.400344339484375*^9}, {3.40034468284375*^9, 3.4003446863125*^9}, {
  3.40041403446875*^9, 3.40041408015625*^9}, {3.40050784078125*^9, 
  3.40050786053125*^9}, {3.4005079288125*^9, 3.40050793209375*^9}},
 CellLabel->"In[92]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. BI-MODAL BOUNDS", "Title"],

Cell[CellGroupData[{

Cell["SUPORT FUNCTIONS", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"SORTDECREASE", ",", "SORTINCREASE", ",", "vxi"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SORTDECREASE", "[", "vxi_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pass", ",", "vx", ",", "order", ",", "n"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"pass", ",", "vx", ",", "order", ",", "n"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vx", " ", "=", " ", "vxi"}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "vxi", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"order", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pass", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"pass", "\[NotEqual]", " ", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pass", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vx", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ">", 
                 RowBox[{"vx", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"pass", " ", "=", " ", 
                  RowBox[{"pass", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"order", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"order", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"order", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"order", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vx", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"vx", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}], " ", "=", 
                  " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vx", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"vx", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], " ", ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "order", "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SORTINCREASE", "[", "vxi_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pass", ",", "vx", ",", "order", ",", "n"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"pass", ",", "vx", ",", "order", ",", "n"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vx", " ", "=", " ", "vxi"}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "vxi", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"order", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pass", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"pass", "\[NotEqual]", " ", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pass", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vx", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "<", 
                RowBox[{"vx", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pass", " ", "=", " ", 
                 RowBox[{"pass", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"order", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"order", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}], "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"order", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"order", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vx", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"vx", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}], " ", "=", 
                 " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vx", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"vx", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], " ", ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "order", "]"}], ";"}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellLabel->"In[95]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["BI-MODAL FAILURE PROBABILITY BOUNDS", "Section"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"BIMODALBOUNDS", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vbeta", ",", "dporder", ",", "SortedDesignPoint", ",", "vpf", ",", 
         "vgrad", ",", "unimodal", ",", "ro", ",", "Pab", ",", "PAB", ",", 
         "PF1F2", ",", "liminf", ",", "limsup", ",", "bimodal"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{
          "vbeta", ",", "dporder", ",", "SortedDesignPoint", ",", "vpf", ",", 
           "vgrad", ",", "unimodal", ",", "ro", ",", "Pab", ",", "PAB", ",", 
           "PF1F2", ",", "liminf", ",", "limsup", ",", "bimodal"}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vbeta", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"DPGET", "[", 
             RowBox[{
              RowBox[{"DesignPoint", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", "\"\<BETA\>\"", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"dporder", " ", "=", " ", 
          RowBox[{"SORTINCREASE", "[", "vbeta", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"SortedDesignPoint", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "NLS", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"SortedDesignPoint", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"DesignPoint", "[", 
              RowBox[{"[", 
               RowBox[{"dporder", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vpf", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"DPGET", "[", 
             RowBox[{
              RowBox[{"SortedDesignPoint", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", "\"\<FORMPF\>\"", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vbeta", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"DPGET", "[", 
             RowBox[{
              RowBox[{"SortedDesignPoint", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", "\"\<BETA\>\"", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vgrad", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"DPGET", "[", 
             RowBox[{
              RowBox[{"SortedDesignPoint", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", "\"\<GRADY\>\"", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"alfa", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             FractionBox[
              RowBox[{"vgrad", "[", 
               RowBox[{"[", "i", "]"}], "]"}], 
              SqrtBox[
               RowBox[{
                RowBox[{"vgrad", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ".", 
                RowBox[{"vgrad", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]]], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"LSPARALLEL", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"unimodal", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                UnderoverscriptBox["\[Product]", 
                 RowBox[{"i", "=", "1"}], "NLS"], 
                RowBox[{"(", 
                 RowBox[{"vpf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ",", 
               RowBox[{"Min", "[", "vpf", "]"}]}], "}"}]}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"unimodal", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", "vpf", "]"}], ",", 
               RowBox[{"1", "-", 
                RowBox[{
                 UnderoverscriptBox["\[Product]", 
                  RowBox[{"i", "=", "1"}], "NLS"], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"vpf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], "}"}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ro", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"alfa", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", 
             RowBox[{"alfa", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NLS"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Pab", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "==", "j"}], ",", "0", ",", 
              RowBox[{"N", "[", 
               FractionBox[
                RowBox[{
                 RowBox[{"vbeta", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"ro", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
                  RowBox[{"vbeta", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], 
                SqrtBox[
                 RowBox[{"1", "-", 
                  SuperscriptBox[
                   RowBox[{"ro", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "2"]}]]], "]"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NLS"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PAB", " ", "=", " ", 
          RowBox[{"IdentityMatrix", "[", "NLS", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"PAB", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"FI", "[", 
                   RowBox[{"-", 
                    RowBox[{"vbeta", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", 
                  RowBox[{"FI", "[", 
                   RowBox[{"-", 
                    RowBox[{"Pab", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"PAB", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"FI", "[", 
                   RowBox[{"-", 
                    RowBox[{"vbeta", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], " ", 
                  RowBox[{"FI", "[", 
                   RowBox[{"-", 
                    RowBox[{"Pab", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}]}],
                ";"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "+", "1"}], ",", "NLS"}], "}"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"PF1F2", " ", "=", " ", 
          RowBox[{"IdentityMatrix", "[", "NLS", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ro", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[GreaterEqual]", 
                  " ", "0.0"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PF1F2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                   RowBox[{"N", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"PAB", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"PAB", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"PF1F2", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
                   RowBox[{"N", "[", "          ", 
                    RowBox[{
                    RowBox[{"PAB", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
                    RowBox[{"PAB", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}]}], " ", 
                  ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PF1F2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                   RowBox[{"N", "[", "0.0", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"PF1F2", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
                   RowBox[{"N", "[", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"PAB", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"PAB", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                  " ", ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "+", "1"}], ",", "NLS"}], "}"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}], ";", "\t", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"LSPARALLEL", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"limsup", " ", "=", " ", 
             RowBox[{"PF1F2", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"limsup", " ", "=", " ", 
                   RowBox[{"Min", "[", 
                    RowBox[{"limsup", ",", 
                    RowBox[{"PF1F2", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"i", "+", "1"}], ",", "NLS"}], "}"}]}], "]"}], 
               ";"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}], ";", "\t",
             "\[IndentingNewLine]", 
            RowBox[{"limsup", " ", "=", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"limsup", ",", "vpf"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"bimodal", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PF1F2", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "limsup"}], 
              "}"}]}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"liminf", " ", "=", " ", 
             RowBox[{
              RowBox[{"vpf", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"i", "=", "2"}], "NLS"], 
               RowBox[{"(", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"vpf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"j", "=", "1"}], 
                    RowBox[{"i", "-", "1"}]], 
                    RowBox[{"(", 
                    RowBox[{"PF1F2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ")"}]}]}], ",", 
                  "0"}], "]"}], ")"}]}]}]}], ";", 
            RowBox[{"limsup", " ", "=", " ", 
             RowBox[{
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"i", "=", "1"}], "NLS"], 
               RowBox[{"vpf", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "-", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"j", "=", "2"}], "NLS"], 
               RowBox[{"Max", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"PF1F2", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"bimodal", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"liminf", ",", "limsup"}], "}"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\n", "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", "\"\<LINEAR FAILURE PROBABILITY BOUNDS:\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<       Sorted vbeta = \>\"", ",", "vbeta"}], "]"}], 
         ";", "\n", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<                vpf = \>\"", ",", 
           RowBox[{"ScientificForm", "[", "vpf", 
            StyleBox["]", "Text"]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Limit state correl. = \>\"", ",", 
           RowBox[{"TableForm", "[", "ro", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<    Probability A,B = \>\"", ",", 
           RowBox[{"TableForm", "[", "PAB", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Probability E1 \[Intersection] E2 = \>\"", ",", 
           RowBox[{"TableForm", "[", "PF1F2", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\< Unimodal PF bounds = \>\"", ",", 
           RowBox[{"ScientificForm", "[", "unimodal", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<  Bimodal PF bounds = \>\"", ",", 
           RowBox[{"ScientificForm", "[", "bimodal", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "bimodal", "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}],
    "\n"}]}]], "Input",
 CellLabel->"In[98]:="]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["5. MONTE CARLO SIMULATION MODULES", "Title"],

Cell[CellGroupData[{

Cell["SIMULATION OBJECTS", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "MCPFCREATE", ",", "MCPFPUT", ",", "MCPFGET", ",", "mcresult", ",", "dp", 
     ",", "input", ",", "put", ",", "get"}], "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MCPFCREATE", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"(", 
       RowBox[{"Return", "[", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "5", "}"}]}], "]"}], "]"}], ")"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MCPFPUT", "[", 
     RowBox[{"dp_", ",", "input_", ",", "put_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nput", ",", "rvt"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"nrvi", ",", "nput", ",", "rvt"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nput", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "put", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nput", "\[NotEqual]", " ", 
           RowBox[{
            RowBox[{"Dimensions", "[", "input", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Conflicting vector sizes, DPPUT!\>\"", "]"}], 
           ";", " ", 
           RowBox[{"Return", "[", "0", "]"}]}]}], "]"}], ";", "\n", "\t", 
        "\[IndentingNewLine]", 
        RowBox[{"mcresult", " ", "=", " ", "dp"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<MEAN\>\""}], 
             "      ", ",", 
             RowBox[{
              RowBox[{"mcresult", "[", 
               RowBox[{"[", " ", "1", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<SDEV\>\""}], 
             "      ", ",", 
             RowBox[{
              RowBox[{"mcresult", "[", 
               RowBox[{"[", "  ", "2", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<LBOUND\>\""}],
              " ", ",", 
             RowBox[{
              RowBox[{"mcresult", "[", 
               RowBox[{"[", "  ", "3", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<UBOUND\>\""}],
              " ", ",", 
             RowBox[{
              RowBox[{"mcresult", "[", 
               RowBox[{"[", "  ", "4", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"put", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
              "\"\<NSAMPLES\>\""}], " ", ",", 
             RowBox[{
              RowBox[{"mcresult", "[", 
               RowBox[{"[", "  ", "5", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"input", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nput"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mcresult", "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MCPFGET", "[", 
    RowBox[{"mcresult_", ",", "get_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ndpi", ",", "nget", ",", "out"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"nget", ",", "out"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"nget", " ", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "get", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"out", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nget", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", " ", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"get", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<MEAN\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"mcresult", "[", 
              RowBox[{"[", "  ", "1", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"get", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<SDEV\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"mcresult", "[", 
              RowBox[{"[", "  ", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"get", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<LBOUND\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"mcresult", "[", 
              RowBox[{"[", "  ", "3", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"get", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<UBOUND\>\""}], 
            ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"mcresult", "[", 
              RowBox[{"[", "  ", "4", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"get", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
             "\"\<NSAMPLES\>\""}], ",", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"mcresult", "[", 
              RowBox[{"[", "  ", "5", "]"}], "]"}]}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nget"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nget", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"out", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}], 
         "\[IndentingNewLine]", "\t", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Return", "[", "out", "]"}]}], "\[IndentingNewLine]", "]"}], 
       ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[99]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convergence plot MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"EstNsamples", ",", "pf", ",", "mcresult"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EstNsamples", "[", "pf_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"est", ",", "x", ",", "expo", ",", "coef"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"est", ",", "x", ",", "expo", ",", "coef"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"est", "[", "x_", "]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{"Log", "[", 
             RowBox[{"1", "-", "x"}], "]"}], "pf"], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"expo", "[", "x_", "]"}], "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", 
            RowBox[{"est", "[", "x", "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coef", "[", "x_", "]"}], "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"est", "[", "x", "]"}], " ", 
           RowBox[{"10", "^", 
            RowBox[{"-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", 
                RowBox[{"est", "[", "x", "]"}]}], "]"}], "]"}]}]}]}], "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Number of MC samples required: \>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<70% Confidence: \>\"", ",", 
          RowBox[{"coef", "[", "0.7", "  ", "]"}], ",", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<\!\(\*SuperscriptBox[\(x10\), \(``\)]\)\>\"", ",", 
            RowBox[{"expo", "[", "0.7", "  ", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<95% Confidence: \>\"", ",", 
          RowBox[{"coef", "[", "0.95", "]"}], ",", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<\!\(\*SuperscriptBox[\(x10\), \(``\)]\)\>\"", ",", 
            RowBox[{"expo", "[", "0.95", "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"est", "[", "x", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.7", ",", "0.9999"}], "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"Axes", "\[Rule]", "None"}]}], "]"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MonteCarloPfPrint", "[", "mcresult_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pf", ",", "bounds"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pf", "=", 
         RowBox[{
          RowBox[{"MCPFGET", "[", 
           RowBox[{"mcresult", ",", 
            RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bounds", " ", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"MCPFGET", "[", 
             RowBox[{"mcresult", ",", 
              RowBox[{"{", "\"\<LBOUND\>\"", "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"MCPFGET", "[", 
             RowBox[{"mcresult", ",", 
              RowBox[{"{", "\"\<UBOUND\>\"", "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"pf", "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "30"}]]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<MonteCarlo {Beta,Pf} = \>\"", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<\[Infinity]\>\"", ",", "0"}], "}"}], "//", 
              "N"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<MonteCarlo {Beta,Pf} = \>\"", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"INVFIE", "[", "pf", "]"}]}], ",", 
                RowBox[{"ScientificForm", "[", "pf", "]"}]}], "}"}], "//", 
              "N"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<95% Bounds = \>\"", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ScientificForm", "[", 
                 RowBox[{"bounds", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                "\"\< < Pf < \>\"", ",", 
                RowBox[{"ScientificForm", "[", 
                 RowBox[{"bounds", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "//", 
              "N"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"MonteCarloConvergencePlot", ",", "dpi"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MonteCarloConvergencePlot", "[", 
     RowBox[{"mcresult_", ",", "confidence_", ",", "beta_", ",", "color_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"samp", ",", "mean", ",", "ub", ",", "lb"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"samp", ",", "mean", ",", "ub", ",", "lb"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MonteCarloPfPrint", "[", "mcresult", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"sdfactor", " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"INVFIE", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "confidence"}], ")"}], "/", "2"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"samp", " ", "=", " ", 
         RowBox[{"MCPFGET", "[", 
          RowBox[{"mcresult", ",", 
           RowBox[{"{", "\"\<NSAMPLES\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mean", " ", "=", " ", 
         RowBox[{"MCPFGET", "[", 
          RowBox[{"mcresult", ",", 
           RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sdev", " ", "=", " ", 
         RowBox[{"MCPFGET", "[", 
          RowBox[{"mcresult", ",", 
           RowBox[{"{", "\"\<SDEV\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ub", " ", "=", " ", 
         RowBox[{"mean", " ", "+", " ", 
          RowBox[{"sdfactor", " ", "sdev"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lb", " ", "=", " ", 
         RowBox[{"mean", " ", "-", " ", 
          RowBox[{"sdfactor", " ", "sdev"}]}]}], ";", "\n", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"beta", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mean", " ", "=", " ", 
            RowBox[{"-", 
             RowBox[{"INVFIE", "[", "mean", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ub", "=", 
            RowBox[{"-", 
             RowBox[{"INVFIE", "[", "ub", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lb", "=", 
            RowBox[{"-", 
             RowBox[{"INVFIE", "[", "lb", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Ylabel", " ", "=", " ", "\"\<\[Beta]\>\""}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ub", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"ub", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "NSP"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lb", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"lb", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ">", "UUF"}], ",", 
                RowBox[{"Log", "[", 
                 RowBox[{"10", ",", 
                  RowBox[{"lb", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "0"}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "NSP"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", " ", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"mean", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ">", "UUF"}], ",", 
               RowBox[{
                RowBox[{"mean", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
                RowBox[{"Log", "[", 
                 RowBox[{"10", ",", 
                  RowBox[{"mean", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "NSP"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Ylabel", " ", "=", " ", 
            "\"\<\!\(\*SubscriptBox[\(Log\), \(10\)]\)(\!\(\*SubscriptBox[\(P\
\), \(f\)]\))\>\""}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"mean", "[", 
             RowBox[{"[", "NSP", "]"}], "]"}], "]"}], "<", "UUF"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<No samples in failure domain!\>\"", "]"}], 
           ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"samp", ",", "lb"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"samp", ",", "mean"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"samp", ",", "ub"}], "}"}], "]"}]}], "}"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"color", ",", 
                  RowBox[{"Dashing", "[", 
                   RowBox[{"{", 
                    RowBox[{"0.01", ",", "0.01"}], "}"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", "color", "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["N", "SAMPLES"], ",", "Ylabel"}], "}"}]}], ",", 
             RowBox[{"Axes", "\[Rule]", "None"}]}], "]"}], "]"}]}], "]"}], 
        ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.39783638784375*^9, 3.39783638803125*^9}, {
   3.39783644028125*^9, 3.397836451703125*^9}, 3.400345683671875*^9, {
   3.40034578884375*^9, 3.400345792984375*^9}, {3.40034717103125*^9, 
   3.400347177015625*^9}, 3.400347260875*^9, 3.400347354765625*^9, {
   3.400347610796875*^9, 3.400347619546875*^9}, 3.400608386390625*^9, {
   3.400608437203125*^9, 3.40060846909375*^9}, {3.400608508625*^9, 
   3.400608585859375*^9}, {3.400608859*^9, 3.400608903203125*^9}, 
   3.40060896746875*^9, {3.400609143328125*^9, 3.40060914525*^9}, {
   3.400610239734375*^9, 3.400610392203125*^9}, {3.400610549453125*^9, 
   3.400610589234375*^9}},
 CellLabel->"In[103]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["GENERAL SIMULATION MODULES", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"PFSTATISTICS", ",", "ind", ",", "nsp"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PFSTATISTICS", "[", 
    RowBox[{"ind_", ",", "nsp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nsv", ",", "nsamples", ",", "mean", ",", "sdev", ",", "i", ",", "k", 
       ",", "sum", ",", "ub", ",", "lb"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "nsv", ",", "nsamples", ",", "mean", ",", "sdev", ",", "i", ",", "k", 
         ",", "sum"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"nsamples", " ", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "ind", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"nsv", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"IntegerPart", "[", 
           RowBox[{"i", " ", 
            RowBox[{"nsamples", "/", "nsp"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nsp"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nsv", "[", 
         RowBox[{"[", "nsp", "]"}], "]"}], " ", "=", " ", "nsamples"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mean", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nsp", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sdev", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", 
          RowBox[{"{", "nsp", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "   ", 
       RowBox[{"ub", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nsp", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "   ", 
       RowBox[{"lb", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nsp", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sum1", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sum2", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"k", "\[LessEqual]", " ", 
             RowBox[{"nsv", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"sum1", " ", "=", " ", 
              RowBox[{"sum1", " ", "+", " ", 
               RowBox[{"ind", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"sum2", " ", "=", " ", 
              RowBox[{"sum2", " ", "+", " ", 
               RowBox[{
                RowBox[{"ind", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "^", "2"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"k", "=", 
              RowBox[{"k", "+", "1"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "sum1", "]"}], "\[GreaterEqual]", "UUF"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"mean", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"sum1", "/", 
               RowBox[{"nsv", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sdev", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{"sum2", "-", 
                  RowBox[{
                   RowBox[{"nsv", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"mean", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}]}], "]"}], 
                "]"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"nsv", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ub", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"mean", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", 
                 RowBox[{"2", "*", 
                  RowBox[{"sdev", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "1"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"lb", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"mean", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", 
                  RowBox[{"2", "*", 
                   RowBox[{"sdev", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{"mean", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"2", "*", 
                  RowBox[{"sdev", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "0"}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsp"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"MCPFPUT", "[", 
         RowBox[{"MCPFCREATE", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"mean", ",", "sdev", ",", "lb", ",", "ub", ",", "nsv"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<MEAN\>\"", ",", "\"\<SDEV\>\"", ",", "\"\<LBOUND\>\"", ",", 
            "\"\<UBOUND\>\"", ",", "\"\<NSAMPLES\>\""}], "}"}]}], "]"}], 
        "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[108]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"INDICATOR", ",", "xsample"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"INDICATOR", "[", "xsample_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indicator", ",", "gsamples", ",", "nsamples"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{
          "indicator", ",", "gsamples", ",", "nsamples", ",", "failsamples", 
           ",", "survsamples"}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"nsamples", " ", "=", " ", 
          RowBox[{
           RowBox[{"Dimensions", "[", "xsample", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"indicator", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"NLS", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\n", "\t", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"gsamples", " ", "=", " ", 
             RowBox[{"GX", "[", 
              RowBox[{"xsample", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"gsamples", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "\[LessEqual]", " ", "0"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"indicator", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "  ", "j"}], "]"}], "]"}], "=", "1"}], 
                  ";"}]}], "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"indicator", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"NLS", "+", "1"}]}], "]"}], "]"}], "=", "1"}], 
                  ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"NLS", "+", "1"}]}], "}"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"failsamples", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"survsamples", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"indicator", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"NLS", "+", "1"}]}], "]"}], "]"}], "\[NotEqual]", 
              " ", "0"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"failsamples", " ", "=", " ", 
               RowBox[{"Append", "[", 
                RowBox[{"failsamples", ",", 
                 RowBox[{"xsample", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"survsamples", " ", "=", " ", 
               RowBox[{"Append", "[", 
                RowBox[{"survsamples", ",", 
                 RowBox[{"xsample", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "failsamples", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "1"}], ",", 
           RowBox[{"failsamples", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"failsamples", ",", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", "NRV", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "survsamples", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "1"}], ",", 
           RowBox[{"survsamples", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"survsamples", ",", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", "NRV", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "indicator", "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}],
    "\n"}]}]], "Input",
 CellLabel->"In[110]:="],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "MAKEHISTOGRAM", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MAKEHISTOGRAM", "[", 
    RowBox[{
    "nsi_", ",", "ndiv_", ",", "mina_", ",", "maxa_", ",", "ptlist_"}], "]"}],
    " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vNi", ",", "pdf", ",", "cdf", ",", "divlist", ",", "middiv", ",", 
       "enddiv", ",", "i", ",", "j", ",", "sum", ",", "npt", ",", "min", ",", 
       "max", ",", "xi", ",", "xf"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "vNi", ",", "pdf", ",", "cdf", ",", "divlist", ",", "middiv", ",", 
         "enddiv", ",", "i", ",", "j", ",", "sum", ",", "npt", ",", "min", 
         ",", "max", ",", "xi", ",", "xf"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mina", "\[Equal]", "0"}], ",", 
         RowBox[{"min", " ", "=", " ", 
          RowBox[{"ptlist", "[", 
           RowBox[{"[", "   ", "1", "]"}], "]"}]}], ",", 
         RowBox[{"min", "=", "mina"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"maxa", "\[Equal]", "0"}], ",", 
         RowBox[{"max", " ", "=", " ", 
          RowBox[{"ptlist", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"max", "=", "maxa"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"divlist", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"min", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"max", "-", "min"}], ")"}], "*", 
            RowBox[{"i", "/", "ndiv"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "ndiv"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"npt", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "ptlist", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vNi", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "ndiv", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cdf", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ndiv", "+", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ptlist", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "<", " ", "min"}], ",", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"j", "+", "1"}]}], ";", " ", 
          RowBox[{
           RowBox[{"cdf", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"cdf", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"i", "\[LessEqual]", "ndiv"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "<=", "npt"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"divlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", " ", 
               RowBox[{"ptlist", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "<", 
               RowBox[{"divlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"vNi", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{
               RowBox[{"vNi", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "+", "1"}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t ", 
             RowBox[{"j", "=", 
              RowBox[{"j", "+", "1"}]}]}]}], "\[IndentingNewLine]", "\t", 
           "]"}], ";", "\[IndentingNewLine]", "\t ", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"i", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cdf", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"cdf", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "  ", "+", " ", 
            RowBox[{"vNi", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ndiv"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"sum", " ", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"vNi", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "ndiv"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pdf", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vNi", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"max", "-", "min"}], ")"}], "/", "ndiv"}], ")"}]}], "/",
           "nsi"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cdf", " ", "=", " ", 
        RowBox[{"cdf", "/", "nsi"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"cdf", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "\[LessEqual]", "0"}], ",", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"cdf", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"cdf", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", 
               RowBox[{"j", ",", 
                RowBox[{"ndiv", "+", "1"}]}], "]"}], "]"}], "]"}], " ", "/", 
            " ", "nsi"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xcdf", " ", "=", " ", 
          RowBox[{"divlist", "[", 
           RowBox[{"[", 
            RowBox[{"Range", "[", 
             RowBox[{"j", ",", 
              RowBox[{"ndiv", "+", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vNi", " ", "=", " ", 
          RowBox[{"vNi", "[", 
           RowBox[{"[", 
            RowBox[{"Range", "[", 
             RowBox[{"j", ",", "ndiv"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pdf", " ", "=", " ", 
          RowBox[{"pdf", "[", 
           RowBox[{"[", 
            RowBox[{"Range", "[", 
             RowBox[{"j", ",", "ndiv"}], "]"}], "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"enddiv", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"divlist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "ndiv"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middiv", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"divlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "+", 
             RowBox[{"divlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "ndiv"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "divlist", ",", "middiv", ",", " ", "enddiv", ",", "vNi", ",", 
           "pdf", ",", "cdf"}], "}"}], "//", "N"}], "]"}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{3.400346086203125*^9},
 CellLabel->"In[112]:="],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "RVHISTOGRAMPLOT", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RVHISTOGRAMPLOT", "[", 
    RowBox[{"rv_", ",", "rvsample_", ",", 
     RowBox[{"{", 
      RowBox[{"xmini_", ",", "xmaxi_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "histplot", ",", "pdfplot", ",", "xmin", ",", "xmax", ",", "name", ",", 
       "type"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "histplot", ",", "pdfplot", ",", "xmin", ",", "xmax", ",", "name", 
         ",", "type"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"name", " ", "=", "  ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rv", "}"}], ",", 
           RowBox[{"{", "\"\<NAME\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"type", " ", "=", "  ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rv", "}"}], ",", 
           RowBox[{"{", "\"\<TYPE\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"xmin", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rv", "}"}], ",", 
           RowBox[{"{", "\"\<VMIN\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xmax", " ", "=", " ", 
        RowBox[{
         RowBox[{"RVGET", "[", 
          RowBox[{
           RowBox[{"{", "rv", "}"}], ",", 
           RowBox[{"{", "\"\<VMAX\>\"", "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"type", "\[NotEqual]", " ", "\"\<DETERM\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"xmini", "\[Equal]", "0"}], ",", 
            RowBox[{"xmin", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"xmin", ",", 
               RowBox[{"Min", "[", "rvsample", "]"}]}], "]"}]}], ",", 
            RowBox[{"xmin", "=", "xmini"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"xmaxi", "\[Equal]", "0"}], ",", 
            RowBox[{"xmax", "=", 
             RowBox[{"Min", "[", 
              RowBox[{"xmax", ",", 
               RowBox[{"Max", "[", "rvsample", "]"}]}], "]"}]}], ",", 
            RowBox[{"xmax", "=", "xmaxi"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"histplot", "=", 
        RowBox[{"Histogram", "[", 
         RowBox[{"rvsample", ",", 
          RowBox[{"BarStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"GrayLevel", "[", "1.0", "]"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"HistogramRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"xmin", ",", "xmax"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Axes", "\[Rule]", "None"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"HistogramScale", "\[Rule]", "1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pdfplot", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"StPDF", "[", 
           RowBox[{"rv", ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{"Axes", "\[Rule]", "None"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Show", "[", 
         RowBox[{"histplot", ",", "pdfplot", ",", 
          RowBox[{"FrameLabel", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
            "name", ",", "\"\<\!\(\*SubscriptBox[\(f\), \(X\)]\)(x)\>\""}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Axes", "\[Rule]", "None"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic", ",", "None", ",", "None"}],
             "}"}]}]}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.39783626203125*^9, 3.400345296640625*^9, {3.400345922984375*^9, 
   3.40034594265625*^9}, {3.400348297171875*^9, 3.400348297421875*^9}, 
   3.400348443546875*^9, {3.400432751265625*^9, 3.40043275259375*^9}, {
   3.400513300140625*^9, 3.40051330671875*^9}},
 CellLabel->"In[114]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["GENERATION OF RANDOM VARIABLE SET  SAMPLES", "Section",
 CellChangeTimes->{{3.400347142609375*^9, 3.40034714553125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RVSETSAMPLES", "[", 
     RowBox[{"nrv_", ",", "nsamples_", ",", "rvset_", ",", "chol_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z", ",", "u1", ",", "u2"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "u1", ",", "u2"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{"STANDARDGAUSSIANSAMPLES", "[", 
          RowBox[{"nsamples", ",", "nrv"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"z", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"chol", ".", 
            RowBox[{"y", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RVSETINVCDF", "[", 
            RowBox[{"nrv", ",", "rvset", ",", 
             RowBox[{"z", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nsamples"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"RVSETINVCDF", ",", "rvset", ",", "z"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RVSETINVCDF", "[", 
    RowBox[{"nrv_", ",", "rvset_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"type", ",", "p1", ",", "p2", ",", "u", ",", "x", ",", "j"}], 
      "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"type", ",", "p1", ",", "p2", ",", "u", ",", "x", ",", "j"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"type", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"rvset", ",", 
          RowBox[{"{", " ", "\"\<TYPE\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p1", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"rvset", ",", 
          RowBox[{"{", " ", "\"\<PAR1\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", " ", "=", " ", 
        RowBox[{"RVGET", "[", 
         RowBox[{"rvset", ",", 
          RowBox[{"{", " ", "\"\<PAR2\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"u", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"FI", "[", 
           RowBox[{"z", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "nrv"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nrv", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"type", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "         ", 
             "\"\<NORMAL\>\""}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "*", 
                RowBox[{"p2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "+", 
               RowBox[{"p1", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"type", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", " ", 
               "\"\<LOGNORMAL\>\""}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "=", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"z", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "*", 
                   RowBox[{"p2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "+", 
                  RowBox[{"p1", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";"}], 
              "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "=", 
                RowBox[{"INVCDF", "[", 
                 RowBox[{
                  RowBox[{"rvset", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "nrv"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.40034700065625*^9, 3.400347023578125*^9}, {
  3.40043135740625*^9, 3.40043137678125*^9}, {3.40043228565625*^9, 
  3.40043230159375*^9}, {3.40051129096875*^9, 3.400511299015625*^9}},
 CellLabel->"In[116]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["IMPORTANCE SAMPLING", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"MCIMPORTANCESAMPLING", ",", "nmcsi", ",", "NSF", ",", "CH"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MCIMPORTANCESAMPLING", "[", 
    RowBox[{"nmcsi_", ",", "nsfi_", ",", "CH_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "y", ",", "nsf", ",", "vbeta", ",", "dporder", ",", "pfsum", ",", 
       "ISnmcs", ",", "SFmeans", ",", "SFsdevs", ",", "sfi", ",", "sff", ",", 
       "sfn"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "y", ",", "nsf", ",", "vbeta", ",", "dporder", ",", 
         "SortedDesignPoint", ",", "vpf", ",", "pfsum", ",", "ISweight", ",", 
         "ISnmcs", ",", "SFmeans", ",", "SFsdevs", ",", "sfi", ",", "sff", 
         ",", "sfn"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"nmcs", " ", "=", " ", "nmcsi"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nsf", " ", "=", " ", "nsfi"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vpf", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"DPGET", "[", 
           RowBox[{
            RowBox[{"DesignPoint", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<FORMPF\>\"", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"LSPARALLEL", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dporder", " ", "=", " ", 
           RowBox[{"SORTINCREASE", "[", "vpf", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vpf", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"DPGET", "[", 
              RowBox[{
               RowBox[{"DesignPoint", "[", 
                RowBox[{"[", 
                 RowBox[{"dporder", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", "\"\<FORMPF\>\"", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pfsum", " ", "=", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"1", "-", 
              RowBox[{"vpf", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ISweight", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"vpf", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "pfsum"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dporder", " ", "=", " ", 
           RowBox[{"SORTDECREASE", "[", "vpf", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vpf", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"DPGET", "[", 
              RowBox[{
               RowBox[{"DesignPoint", "[", 
                RowBox[{"[", 
                 RowBox[{"dporder", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", "\"\<FORMPF\>\"", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "NLS"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pfsum", " ", "=", " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"vpf", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ISweight", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vpf", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", "pfsum"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ISweight", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", " ", "0.05"}], 
           ",", 
           RowBox[{"nsf", " ", "=", " ", 
            RowBox[{"nsf", "-", "1"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsfi"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nsf", "<", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<ERROR IN IMPORTANCE SAMPLING!\>\"", "]"}], ";", 
          RowBox[{"Return", "[", "0", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nsf", "<", "nsfi"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NSF", " ", "=", " ", "nsf"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"LSPARALLEL", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pfsum", " ", "=", " ", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"1", "-", 
                 RowBox[{"vpf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ISweight", " ", "=", " ", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"vpf", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", "pfsum"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";"}],
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pfsum", " ", "=", " ", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"vpf", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ISweight", " ", "=", " ", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vpf", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", "pfsum"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ISnmcs", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{
             RowBox[{"ISweight", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nmcs", "+", "1"}], ")"}], "/", "2"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SFORDER", " ", "=", " ", 
        RowBox[{"dporder", "[", 
         RowBox[{"[", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "nsf"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nmcs", " ", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"ISnmcs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"PRINT", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Importance Sampling!\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<        Number of samples: \>\"", ",", "nmcs"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<    Sampled failure modes: \>\"", ",", "SFORDER"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\< Weight per failure mode : \>\"", ",", "ISweight"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Samples per failure mode : \>\"", ",", "ISnmcs"}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SampleWeight", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nmcs", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"rvsetIsample", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "nmcs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SFmeans", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"DPGET", "[", 
           RowBox[{
            RowBox[{"DesignPoint", "[", 
             RowBox[{"[", 
              RowBox[{"dporder", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<DPX\>\"", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SFsdevs", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RVGET", "[", 
           RowBox[{"RVX", ",", 
            RowBox[{"{", "\"\<SDEV\>\"", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SFRV", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RVPUT", "[", 
           RowBox[{"RVX", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SFmeans", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"SFsdevs", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<MEAN\>\"", ",", "\"\<SDEV\>\""}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"SFRV", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RVPUT", "[", 
             RowBox[{"RVX", ",", 
              RowBox[{"{", 
               RowBox[{"SFmeans", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
              RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SFRV", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{"CALCPAR", "[", 
            RowBox[{"SFRV", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nsf"}], "}"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "hxi", ",", "hx1", ",", "hx2", ",", "fx1", ",", "fx2", ",", "z", ",", 
         "x"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"CORRELATED", ",", "\[IndentingNewLine]", 
         RowBox[{"hxi", "=", 
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Det", "[", "CH", "]"}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"hxi", " ", "=", " ", "0"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"LOOP", " ", "OVER", " ", "SAMPLING", " ", "FUNCTIONS"}], " ",
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"y", " ", "=", " ", 
        RowBox[{"STANDARDGAUSSIANSAMPLES", "[", 
         RowBox[{"nmcs", ",", "NRV"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sfi", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sff", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"sff", " ", "=", " ", 
           RowBox[{"sff", " ", "+", " ", 
            RowBox[{"ISnmcs", "[", 
             RowBox[{"[", "sfn", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ClearAll", "[", 
              RowBox[{
              "z", ",", "y2", ",", "x", ",", "hx1", ",", "hx2", ",", "fx1", 
               ",", "fx2"}], "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"SN", " ", "=", " ", 
               RowBox[{"MC", " ", "SAMPLE", " ", "NUMBER", " ", "COUNTER"}]}],
               "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"CORRELATED", ",", 
               RowBox[{"hx1", " ", "=", " ", "hxi"}], ",", 
               RowBox[{"hx1", " ", "=", " ", "0"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"hx1", " ", "=", " ", 
                RowBox[{"hx1", " ", "+", " ", 
                 RowBox[{"Log", "[", 
                  RowBox[{"Max", "[", 
                   RowBox[{"UUF", ",", 
                    RowBox[{"fi", "[", 
                    RowBox[{"y", "[", 
                    RowBox[{"[", 
                    RowBox[{"SN", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], 
                  "]"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"CORRELATED", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"z", " ", "=", " ", 
                 RowBox[{"Jzy", ".", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "SN", "]"}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"hx2", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Do", "[", 
                 RowBox[{
                  RowBox[{"hx2", " ", "=", " ", 
                   RowBox[{"hx2", " ", "+", " ", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{"UUF", ",", 
                    RowBox[{"fi", "[", 
                    RowBox[{"z", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], "]"}]}]}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";"}],
                "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"z", " ", "=", " ", 
                 RowBox[{"y", "[", 
                  RowBox[{"[", "SN", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"hx2", "=", "hx1"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"x", " ", "=", " ", 
              RowBox[{"RVSETINVCDF", "[", 
               RowBox[{"NRV", ",", 
                RowBox[{"SFRV", "[", 
                 RowBox[{"[", "sfn", "]"}], "]"}], ",", "z"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"JPDFX", " ", "=", " ", 
              RowBox[{"LOGJOINTPDF", "[", 
               RowBox[{"RVX", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"JPDFH", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"LOGJOINTPDF", "[", 
                 RowBox[{
                  RowBox[{"SFRV", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", "x"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "nsf"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"fx2", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"y2", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", "NRV", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"y2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], " ", "=", " ", 
                 RowBox[{"INVFI", "[", 
                  RowBox[{"StCDF", "[", 
                   RowBox[{
                    RowBox[{"RVX", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"fx2", " ", "=", " ", 
                 RowBox[{"fx2", " ", "+", " ", 
                  RowBox[{"Log", "[", 
                   RowBox[{"Max", "[", 
                    RowBox[{"UUF", ",", 
                    RowBox[{"fi", "[", 
                    RowBox[{"y2", "[", 
                    RowBox[{"[", "      ", "j", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "NRV"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"CORRELATED", ",", 
               RowBox[{"fx1", "=", 
                RowBox[{"Log", "[", 
                 RowBox[{"fiND", "[", 
                  RowBox[{"y2", ",", "CH", ",", "NRV"}], "]"}], " ", "]"}]}], 
               ",", 
               RowBox[{"fx1", "=", "fx2"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SampleWeight", "[", 
                  RowBox[{"[", "SN", "]"}], "]"}], " ", "=", " ", 
                 RowBox[{
                  RowBox[{"SampleWeight", "[", 
                   RowBox[{"[", "SN", "]"}], "]"}], " ", "+", " ", 
                  RowBox[{
                   RowBox[{"ISweight", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "*", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"JPDFH", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "+", "hx1", "-", "hx2"}], 
                    "]"}]}]}]}], ";"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", "nsf"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rvsetIsample", "[", 
               RowBox[{"[", "SN", "]"}], "]"}], " ", "=", " ", "x"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SampleWeight", "[", 
               RowBox[{"[", "SN", "]"}], "]"}], " ", "=", " ", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"JPDFX", "+", "fx1", "-", "fx2"}], "]"}], "/", 
               RowBox[{"SampleWeight", "[", 
                RowBox[{"[", "SN", "]"}], "]"}]}]}], ";"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"SN", ",", "sfi", ",", "sff"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"sfi", " ", "=", " ", 
           RowBox[{"sfi", "+", 
            RowBox[{"ISnmcs", "[", 
             RowBox[{"[", "sfn", "]"}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"sfn", ",", "1", ",", "nsf"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.397836302765625*^9, {3.40043096284375*^9, 3.400431019984375*^9}, {
   3.40043236746875*^9, 3.400432388171875*^9}, {3.400511272765625*^9, 
   3.400511282890625*^9}, {3.400606735125*^9, 3.400606755234375*^9}, 
   3.40276006265625*^9},
 CellLabel->"In[119]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D PLOTS", "Section"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MC2DPLOTS", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tfailsamples", ",", "tsurvsamples", ",", "failpoints", ",", 
        "failplot", ",", "survpoints", ",", "survplot"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MCPLOT", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "\[Equal]", " ", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tfailsamples", " ", "=", " ", 
               RowBox[{"Transpose", "[", "MCfailsamples", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tsurvsamples", " ", "=", " ", 
               RowBox[{"Transpose", "[", "MCsurvsamples", "]"}]}]}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "\[Equal]", " ", "2"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tfailsamples", " ", "=", " ", 
               RowBox[{"Transpose", "[", "ISfailsamples", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tsurvsamples", " ", "=", " ", 
               RowBox[{"Transpose", "[", "ISsurvsamples", "]"}]}]}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\n", 
           RowBox[{"failpoints", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"tfailsamples", "[", 
                RowBox[{"[", 
                 RowBox[{"RVPLOT", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"tfailsamples", "[", 
                RowBox[{"[", 
                 RowBox[{"RVPLOT", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
             "]"}]}], ";", "\n", 
           RowBox[{"failplot", " ", "=", " ", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"failpoints", ",", "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"XLSPR", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\n", 
           RowBox[{"survpoints", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"tsurvsamples", "[", 
                RowBox[{"[", 
                 RowBox[{"RVPLOT", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"tsurvsamples", "[", 
                RowBox[{"[", 
                 RowBox[{"RVPLOT", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
             "]"}]}], ";", "\n", 
           RowBox[{"survplot", " ", "=", " ", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"survpoints", ",", "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"AbsolutePointSize", "[", "3", "]"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"XLSPR", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\n", 
           RowBox[{
            RowBox[{"MCPLOT", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "=", 
            RowBox[{"Show", "[", 
             RowBox[{
             "lsxplot", ",", "dpxlegplot", ",", "dpxdotplot", ",", 
              "mxlegplot", ",", "mxdotplot", ",", "failplot", ",", "survplot",
               ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", "XLSPR"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"D2NAME", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"D2NAME", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "]"}]}], ";"}],
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Show", "[", 
          RowBox[{"GraphicsRow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MCPLOT", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"MCPLOT", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Scaled", "[", "0.1", "]"}], ",", "0"}], "}"}]}]}], 
           "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.397836629390625*^9, 3.397836635640625*^9}, {
  3.40034546421875*^9, 3.40034551903125*^9}, {3.400347879375*^9, 
  3.400347882828125*^9}, {3.40034797240625*^9, 3.4003479813125*^9}, {
  3.40034804265625*^9, 3.400348043359375*^9}, {3.40051166109375*^9, 
  3.400511692890625*^9}},
 CellLabel->"In[121]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"hx1x2", ",", "hjx1x2", ",", "x1", ",", "x2", ",", "hx"}], "]"}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hjx1x2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "j_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "hx", ",", "z1", ",", "z2", ",", "f1", ",", "f2", ",", "factor"}], 
        "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{
          "hx", ",", "z1", ",", "z2", ",", "f1", ",", "f2", ",", "factor"}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
          "GAUSSIAN", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"hx", " ", "=", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ISweight", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"fi2D", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"x1", "-", 
                 RowBox[{"HXMEAN", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}], 
                RowBox[{"HXSDEV", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]], ",", 
               FractionBox[
                RowBox[{"x2", "-", 
                 RowBox[{"HXMEAN", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}], 
                RowBox[{"HXSDEV", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}]], ",", 
               RowBox[{"RX", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"RVPLOT", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"RVPLOT", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"z1", " ", "=", " ", 
             RowBox[{"INVFIE", "[", 
              RowBox[{"StCDF", "[", 
               RowBox[{
                RowBox[{"SFRV", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", 
                   RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
                "x1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"z2", " ", "=", " ", 
             RowBox[{"INVFIE", "[", 
              RowBox[{"StCDF", "[", 
               RowBox[{
                RowBox[{"SFRV", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", 
                   RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
                "x2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"factor", " ", "=", " ", 
             FractionBox[
              RowBox[{"fi2D", "[", 
               RowBox[{"z1", ",", "z2", ",", 
                RowBox[{"RX", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"RVPLOT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"fi", "[", "z1", "]"}], "*", 
                 RowBox[{"fi", "[", "z2", "]"}]}], ",", "UUF"}], "]"}]]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"f1", " ", "=", " ", 
             RowBox[{"StPDF", "[", 
              RowBox[{
               RowBox[{"SFRV", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", 
                  RowBox[{"RVPLOT", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
               "x1"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"f2", " ", "=", " ", 
             RowBox[{"StPDF", "[", 
              RowBox[{
               RowBox[{"SFRV", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", 
                  RowBox[{"RVPLOT", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
               "x2"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"hx", " ", "=", " ", 
             RowBox[{
              RowBox[{"ISweight", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "*", "f1", "*", "f2", "*", 
              "factor"}]}], ";"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "hx", "]"}], ";"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hx1x2", "[", 
      RowBox[{"{", 
       RowBox[{"x1_", ",", "x2_"}], "}"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"hx", ",", "j"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ClearAll", "[", 
          RowBox[{"hx", ",", "j"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"hx", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"hx", " ", "=", " ", 
             RowBox[{"hx", "+", 
              RowBox[{"hjx1x2", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "x2"}], "}"}], ",", "j"}], "]"}]}]}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "NSF"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "hx", "]"}], ";"}], "\[IndentingNewLine]", 
        ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.3978362795*^9, {3.400487984796875*^9, 3.400488001796875*^9}, 
   3.400488033828125*^9, {3.400488985625*^9, 3.400489072328125*^9}, {
   3.40048916*^9, 3.40048917903125*^9}, {3.400489228703125*^9, 
   3.400489293453125*^9}, {3.400489335078125*^9, 3.4004894260625*^9}, {
   3.400489571359375*^9, 3.40048959384375*^9}, {3.40049018490625*^9, 
   3.400490195296875*^9}, {3.400490245578125*^9, 3.400490249078125*^9}, {
   3.400490283515625*^9, 3.400490308625*^9}, {3.400491212953125*^9, 
   3.40049124484375*^9}, {3.40049135928125*^9, 3.40049155496875*^9}, {
   3.400492105703125*^9, 3.400492110859375*^9}, {3.400492147125*^9, 
   3.4004921934375*^9}, 3.400495914015625*^9, {3.400495945140625*^9, 
   3.400495945578125*^9}, {3.40049605078125*^9, 3.400496141359375*^9}, {
   3.400496281734375*^9, 3.400496337359375*^9}, {3.400496375171875*^9, 
   3.400496422703125*^9}, {3.400496519546875*^9, 3.400496610875*^9}, {
   3.400524784578125*^9, 3.400524843875*^9}, {3.400524893234375*^9, 
   3.400524948765625*^9}, {3.4005252401875*^9, 3.400525278046875*^9}, {
   3.4005255081875*^9, 3.400525558296875*^9}, 3.40060045278125*^9, {
   3.4006081163125*^9, 3.4006081165*^9}},
 CellLabel->"In[122]:="],

Cell[BoxData[""], "Input",
 CellLabel->"In[125]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JPDFHXCONTPLOT", "[", 
    RowBox[{"np_", ",", "jointdp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "hx1x2contplot", ",", "hx1x2contplot2"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "j", ",", "hjx1x2contplot", ",", "hx1x2contplot", ",", 
         "hx1x2contplot2"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"mxlegplot", " ", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(X\)]\)\>\"", ",", " ", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", "D2MEAN", 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mxdotplot", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
           RowBox[{"Point", "[", "D2MEAN", "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"jointdp", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"hx1x2contplot", "=", 
           RowBox[{"ContourPlot", "[", 
            RowBox[{
             RowBox[{"hx1x2", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"HXPR", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"HXPR", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"HXPR", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"HXPR", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotPoints", "\[Rule]", "np"}], ",", 
             RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
             RowBox[{"Contours", "\[Rule]", 
              RowBox[{"FX1X2MODE", "*", "levelcurves"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"hx1x2contplot2", " ", "=", " ", 
           RowBox[{"Show", "[", 
            RowBox[{
            "hx1x2contplot", ",", "lsxplot", ",", "dpxlegplot", ",", 
             "dpxdotplot", ",", "mxlegplot", ",", "fx1x2contplot1", ",", 
             "mxdotplot", ",", "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", " ", "JPR"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "\[Rule]", " ", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", "D2NAME"}]}], " ", "]"}]}], 
          ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"hjx1x2contplot", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "NSF", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"hjx1x2contplot", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{"ContourPlot", "[", 
               RowBox[{
                RowBox[{"hjx1x2", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], ",", "j"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"HXPMIN", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"HXPMAX", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{"HXPMIN", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"HXPMAX", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotPoints", "\[Rule]", "np"}], ",", 
                RowBox[{"ContourShading", "\[Rule]", "None"}], ",", 
                RowBox[{"Contours", "\[Rule]", 
                 RowBox[{"FX1X2MODE", "*", "levelcurves"}]}]}], "]"}]}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NSF"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"hx1x2contplot2", " ", "=", " ", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"hjx1x2contplot", "[", 
              RowBox[{"[", 
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "NSF"}], "]"}], "]"}], "]"}], ",", 
             "lsxplot", ",", "dpxlegplot", ",", "dpxdotplot", ",", 
             "mxlegplot", ",", "fx1x2contplot1", ",", "mxdotplot", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", " ", "JPR"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "\[Rule]", " ", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", "D2NAME"}]}], " ", "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "hx1x2contplot2", "]"}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.39783664778125*^9, {3.40049036440625*^9, 3.40049037640625*^9}, {
   3.400496445703125*^9, 3.400496446921875*^9}, 3.400496643796875*^9, {
   3.4005257030625*^9, 3.40052574259375*^9}, 3.40052578171875*^9, {
   3.400525952515625*^9, 3.400526097625*^9}, {3.400526250984375*^9, 
   3.40052632084375*^9}, {3.400526518875*^9, 3.400526592125*^9}, {
   3.4005268619375*^9, 3.4005269085*^9}, {3.400526978375*^9, 
   3.40052702875*^9}, {3.400605446375*^9, 3.400605447390625*^9}, {
   3.4006055601875*^9, 3.400605654734375*^9}, {3.40060570359375*^9, 
   3.400605789296875*^9}, {3.400605823421875*^9, 3.400605877296875*^9}, {
   3.400607049625*^9, 3.4006070605*^9}, 3.40060716209375*^9},
 CellLabel->"In[126]:="],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetSamplingFunctionPlotRange", "[", "sdlim_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "HXPR", "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", "HXPR", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"HXMEAN", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RVGET", "[", 
            RowBox[{
             RowBox[{"SFRV", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"{", "\"\<MEAN\>\"", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "NSF"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"HXSDEV", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RVGET", "[", 
            RowBox[{
             RowBox[{"SFRV", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"{", "\"\<SDEV\>\"", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "NSF"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sdlim", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HXPMIN", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RVGET", "[", 
                RowBox[{
                 RowBox[{"SFRV", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", "\"\<PMIN\>\"", "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "NSF"}], "}"}]}], "]"}], "]"}]}], 
           ";", 
           RowBox[{"HXPMAX", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"RVGET", "[", 
                RowBox[{
                 RowBox[{"SFRV", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", "\"\<PMAX\>\"", "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "NSF"}], "}"}]}], "]"}], "]"}]}], 
           ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HXPMIN", "=", 
            RowBox[{
             RowBox[{"Transpose", "[", "HXMEAN", "]"}], "-", 
             RowBox[{"sdlim", " ", 
              RowBox[{"Transpose", "[", "HXSDEV", "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"HXPMAX", "=", 
            RowBox[{
             RowBox[{"Transpose", "[", "HXMEAN", "]"}], "+", 
             RowBox[{"sdlim", " ", 
              RowBox[{"Transpose", "[", "HXSDEV", "]"}]}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"HXPR", " ", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"HXPMIN", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{"HXPMAX", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"JPR", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"HXPR", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"XDPR", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"HXPR", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"XDPR", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "HXPR", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.400523579046875*^9, 3.4005235940625*^9}, {
  3.400604468625*^9, 3.40060447*^9}, {3.400605898046875*^9, 
  3.4006059255625*^9}, {3.400605987953125*^9, 3.400605988421875*^9}, {
  3.400607372171875*^9, 3.40060737440625*^9}, {3.40060741278125*^9, 
  3.400607431828125*^9}, {3.40060766065625*^9, 3.400607664375*^9}, {
  3.400607710640625*^9, 3.400607718078125*^9}, {3.40060791878125*^9, 
  3.400607941109375*^9}},
 CellLabel->"In[127]:="],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NstressTH", " ", "=", " ", "Ncycles"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nblocks", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockSize", " ", "=", " ", 
   RowBox[{"Ncycles", "/", "NBlocks"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NstressTH", " ", "=", " ", "Ncycles"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nblocks", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockSize", " ", "=", " ", 
   RowBox[{"Ncycles", "/", "NBlocks"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{3.4470761943595753`*^9},
 CellLabel->"In[128]:="]
}, Open  ]]
}, Open  ]]
},
WindowSize->{925, 682},
WindowMargins->{{56, Automatic}, {Automatic, 53}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (December 10, 2015)",
StyleDefinitions->"TutorialBook.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 43, 0, 59, "Title"],
Cell[CellGroupData[{
Cell[635, 26, 38, 0, 90, "Section"],
Cell[CellGroupData[{
Cell[698, 30, 576, 13, 99, "Input"],
Cell[1277, 45, 815, 14, 42, "Message"],
Cell[2095, 61, 820, 14, 42, "Message"],
Cell[2918, 77, 816, 14, 42, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3771, 96, 178, 4, 29, "Input"],
Cell[3952, 102, 677, 12, 42, "Message"]
}, Open  ]],
Cell[4644, 117, 1042, 30, 168, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5723, 152, 104, 1, 90, "Section"],
Cell[CellGroupData[{
Cell[5852, 157, 255, 5, 38, "Subsection"],
Cell[CellGroupData[{
Cell[6132, 166, 2362, 42, 291, "Subsubsection"],
Cell[8497, 210, 9672, 248, 1065, "Input"],
Cell[18172, 460, 8363, 207, 835, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26596, 674, 47, 0, 90, "Section"],
Cell[26646, 676, 6508, 161, 881, "Input"]
}, {2}]],
Cell[CellGroupData[{
Cell[33188, 842, 32, 0, 90, "Section"],
Cell[33223, 844, 3947, 99, 582, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37219, 949, 106, 1, 59, "Title"],
Cell[CellGroupData[{
Cell[37350, 954, 113, 1, 90, "Section"],
Cell[CellGroupData[{
Cell[37488, 959, 135, 1, 38, "Subsection"],
Cell[CellGroupData[{
Cell[37648, 964, 660, 18, 259, "Subsubsection"],
Cell[38311, 984, 962, 29, 217, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39322, 1019, 116, 1, 38, "Subsection"],
Cell[39441, 1022, 2839, 94, 434, "Input"],
Cell[CellGroupData[{
Cell[42305, 1120, 139, 1, 35, "Subsubsection"],
Cell[42447, 1123, 4155, 97, 873, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46639, 1225, 159, 3, 35, "Subsubsection"],
Cell[46801, 1230, 5605, 139, 901, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52455, 1375, 216, 6, 38, "Subsection"],
Cell[CellGroupData[{
Cell[52696, 1385, 284, 8, 115, "Subsubsection"],
Cell[52983, 1395, 14029, 361, 1837, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67061, 1762, 232, 6, 38, "Subsection"],
Cell[CellGroupData[{
Cell[67318, 1772, 213, 5, 67, "Subsubsection"],
Cell[67534, 1779, 11036, 285, 1516, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78619, 2070, 291, 8, 40, "Subsection"],
Cell[CellGroupData[{
Cell[78935, 2082, 202, 5, 67, "Subsubsection"],
Cell[79140, 2089, 9876, 252, 1420, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[89065, 2347, 160, 2, 52, "Subsection"],
Cell[CellGroupData[{
Cell[89250, 2353, 226, 4, 51, "Subsubsection"],
Cell[89479, 2359, 13915, 345, 2157, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103443, 2710, 158, 2, 52, "Subsection"],
Cell[CellGroupData[{
Cell[103626, 2716, 210, 4, 51, "Subsubsection"],
Cell[103839, 2722, 12103, 292, 2094, "Input"],
Cell[115945, 3016, 5672, 130, 927, "Input"],
Cell[121620, 3148, 6851, 160, 1134, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128520, 3314, 180, 4, 52, "Subsection"],
Cell[CellGroupData[{
Cell[128725, 3322, 224, 4, 51, "Subsubsection"],
Cell[128952, 3328, 15142, 359, 2356, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[144143, 3693, 145, 2, 52, "Subsection"],
Cell[144291, 3697, 1994, 50, 306, "Input"],
Cell[146288, 3749, 7707, 173, 812, "Input"],
Cell[153998, 3924, 4912, 113, 789, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158971, 4044, 48, 0, 59, "Title"],
Cell[CellGroupData[{
Cell[159044, 4048, 41, 0, 90, "Section"],
Cell[159088, 4050, 15848, 381, 2583, "Input"],
Cell[174939, 4433, 5916, 143, 809, "Input"],
Cell[180858, 4578, 8332, 180, 927, "Input"],
Cell[189193, 4760, 14259, 342, 1571, "Input"],
Cell[203455, 5104, 8069, 184, 927, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[211573, 5294, 47, 0, 59, "Title"],
Cell[CellGroupData[{
Cell[211645, 5298, 46, 0, 90, "Section"],
Cell[211694, 5300, 13801, 347, 1663, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225532, 5652, 46, 0, 90, "Section"],
Cell[225581, 5654, 13056, 307, 2086, "Input"],
Cell[238640, 5963, 2352, 62, 237, "Input"],
Cell[240995, 6027, 1856, 49, 237, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242888, 6081, 39, 0, 90, "Section"],
Cell[CellGroupData[{
Cell[242952, 6085, 53, 0, 38, "Subsection"],
Cell[CellGroupData[{
Cell[243030, 6089, 336, 9, 131, "Subsubsection"],
Cell[243369, 6100, 2916, 79, 338, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[246346, 6186, 45, 0, 90, "Section"],
Cell[246394, 6188, 15718, 388, 2171, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262149, 6581, 44, 0, 90, "Section"],
Cell[262196, 6583, 3630, 89, 467, "Input"],
Cell[265829, 6674, 9642, 228, 1180, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[275520, 6908, 35, 0, 59, "Title"],
Cell[CellGroupData[{
Cell[275580, 6912, 35, 0, 90, "Section"],
Cell[275618, 6914, 7398, 175, 973, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283053, 7094, 54, 0, 90, "Section"],
Cell[283110, 7096, 17780, 412, 2329, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[300939, 7514, 50, 0, 59, "Title"],
Cell[CellGroupData[{
Cell[301014, 7518, 37, 0, 90, "Section"],
Cell[301054, 7520, 8779, 222, 1203, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309870, 7747, 43, 0, 90, "Section"],
Cell[309916, 7749, 13470, 320, 1882, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323423, 8074, 45, 0, 90, "Section"],
Cell[323471, 8076, 6705, 165, 812, "Input"],
Cell[330179, 8243, 5780, 134, 950, "Input"],
Cell[335962, 8379, 8889, 224, 1180, "Input"],
Cell[344854, 8605, 5002, 121, 651, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[349893, 8731, 126, 1, 90, "Section"],
Cell[350022, 8734, 6261, 151, 927, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[356320, 8890, 38, 0, 90, "Section"],
Cell[356361, 8892, 22210, 512, 2905, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[378608, 9409, 27, 0, 90, "Section"],
Cell[378638, 9411, 5899, 132, 904, "Input"],
Cell[384540, 9545, 7687, 174, 1065, "Input"],
Cell[392230, 9721, 51, 1, 29, "Input"],
Cell[392284, 9724, 7260, 157, 950, "Input"],
Cell[399547, 9883, 5143, 123, 582, "Input"],
Cell[404693, 10008, 702, 19, 168, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
